* CONSULTAR COMO SE FAZ O CALCULO DE CUSTO DOS PRODUTOS
*******************************************************
FUNCTION saccalc
****************
LOCAL m_calc:={},mtraco,mtraco1,point:=0

mtraco := REPLI(CHR(223),80)
mtraco1 := REPLI(CHR(223),30)
op_tela(2,10,50,90,' FORMULA DO CALCULO DE CUSTO DA MERCADORIA ',,1)
AADD(m_calc,mtraco1+' L E G E N D A '+mtraco1)
AADD(m_calc,'  * ICM da firma           = ICM     ³    * Desconto1              = DC1 ')
AADD(m_calc,'  * ICM de origem          = ICMO    ³    * Desconto1              = DC2 ')
AADD(m_calc,'  * Percentual de lucro    = PL      ³    * Desconto1              = DC3 ')
AADD(m_calc,'  * Quantidade             = QTD     ³    * Despesa Acessoria      = DA  ')
AADD(m_calc,'  * Saldo atual mercadoria = SLD     ³    * Encargo Financeiro     = EF  ')
AADD(m_calc,'  * Preco unitario         = PU      ³    * Frete                  = FR  ')
AADD(m_calc,'  * Preco medio anterior   = PMA     ³    * Imposto adicionais     = IM  ')
AADD(m_calc,mtraco)
AADD(m_calc,'                      >>>> Valores a ser CALCULADOS <<<                   ')
AADD(m_calc,'                                                                          ')
AADD(m_calc,'  * Valor da mercadoria    = VM      ³    * Custo Medio mercadoria = CMM  ')
AADD(m_calc,'  * Custo da mercadoria    = CM      ³    * Preco de venda         = PV   ')
AADD(m_calc,'  * Custo Real mercadoria  = CR      ³                                    ')
AADD(m_calc,mtraco)
AADD(m_calc,mtraco1+' O B S E R V A C A O '+mtraco1)
AADD(m_calc,'  OBS.: * Se a mercadoria for ISENTA:                                     ')
AADD(m_calc,'             ICM    = 0                                                   ')
AADD(m_calc,'             ICMO   = 0                                                   ')
AADD(m_calc,'             PIS    = 0                                                   ')
AADD(m_calc,'             CONFIS = 0                                                   ')
AADD(m_calc,'                                                                          ')
AADD(m_calc,"        * Se a mercadoria tiver ICM'S DIFERENCIADO:                       ")
AADD(m_calc,'             ICM = ICM DIFERENCIADO                                       ')
AADD(m_calc,mtraco)
AADD(m_calc,' ->  Calculo do VALOR DA MERCADORIA (VM)                                  ')
AADD(m_calc,mtraco)
AADD(m_calc,'        VM = PU - (PU x (DC1/100))                                        ')
AADD(m_calc,'        VM = VM + ((VM x EF) + (VM x FR))                                 ')
AADD(m_calc,mtraco)
AADD(m_calc,'  -> Calculo do CUSTO DA MERCADORIA (CM)                                  ')
AADD(m_calc,mtraco)
AADD(m_calc,'                                                                          ')
AADD(m_calc,'  Se IPI > 0                                                              ')
AADD(m_calc,'         CM = VM + (VM x (IPI/100)) - (VM x (ICMO/100))                   ')
AADD(m_calc,'  Se nao                                                                  ')
AADD(m_calc,'         CM = VM x (100 - ICMO)                                           ')
AADD(m_calc,'         CM = CM / 100                                                    ')
AADD(m_calc,'                                                                          ')
AADD(m_calc,'  Se DA > 0                                                               ')
AADD(m_calc,'         CM = CM + (VM x DA)                                              ')
AADD(m_calc,mtraco)
AADD(m_calc,'  -> Calculo do CUSTO DA REAL (CR)                                        ')
AADD(m_calc,mtraco)
AADD(m_calc,'        CR = (CM / (100 - (ICM + PIS + CONFIS + IM))) x 100               ')
AADD(m_calc,mtraco)
AADD(m_calc,' -> Calculo do CUSTO MEDIO DA MERCADORIA (CMM)                            ')
AADD(m_calc,mtraco)
AADD(m_calc,'                                                                          ')
AADD(m_calc,'  Se saldo atual da mercadoria > 0                                        ')
AADD(m_calc,'        CMM = ((QTD x CR) + (SLD x PMA)) / (QTD + SLD)                    ')
AADD(m_calc,'  Se nao                                                                  ')
AADD(m_calc,'        CMM = CR                                                          ')
AADD(m_calc,mtraco)
AADD(m_calc,' -> Calculo do PRECO VENDA (PV)                                           ')
AADD(m_calc,mtraco)
AADD(m_calc,'                                                                          ')
AADD(m_calc,'  >>> Pelo CUSTO REAL <<<                                                 ')
AADD(m_calc,'  -----------------------                                                 ')
AADD(m_calc,'  Se o tipo de calculo for em PERCENTUAL                                  ')
AADD(m_calc,'          PV = CR * ((PL / 100) + 1)                                      ')
AADD(m_calc,'  Se o tipo de calculo for em FATOR                                       ')
AADD(m_calc,'          PV = (CR / (100 - PL)) x 100                                    ')
AADD(m_calc,'                                                                          ')
AADD(m_calc,'  >>> Pelo CUSTO MEDIO <<<                                                ')
AADD(m_calc,'  -----------------------                                                 ')
AADD(m_calc,'  Se o tipo de calculo for em PERCENTUAL                                  ')
AADD(m_calc,'          PV = CMM * ((PL / 100) + 1)                                     ')
AADD(m_calc,'  Se o tipo de calculo for em FATOR                                       ')
AADD(m_calc,'          PV = (CMM / (100 - PL)) x 100                                   ')
AADD(m_calc,'                                                                          ')
AADD(m_calc,'  >>> OUTRO TIPO DE CALCULO <<<                                           ')
AADD(m_calc,'  ------------------------------                                          ')
AADD(m_calc,'          PV = (CM / (100 - (ICM + PIS + CONFIS + IMP + PL))) x 100       ')
AADD(m_calc,mtraco)

mensagem("<ESC> Retorna  -  <ENTER> p/Resumo" )
setcor(10);point := ACHOICE(0,0,48,80,m_calc,,,point);setcor(1)
fecha_tela()
RETURN NIL