* INCLUSAO DE CLIENTE
*********************
FUNCTION sac130()
*****************
LOCAL MPRG:='SAC130',;
      opcao,lba,cba,mrazao,mnome,mdata_cad,mendereco,;
      mbairro,mtel1,mtel2,mfax,mcontato,mspc,maniver,;
      mcomprado,mvendedor,mprazo_pag,marea,mlimite,mobs,mcodoper,;
      mop_hist,mhistorico,li,ci,lb,cb,tela1,mdata_nas,mcomercio,mtipo,memail,memail1,memail2,memail3,;
      mcpf,mcgc,minsc,mrg,morgao,mdat_emi,mbloqueio,matac_vare,;
      mempre_c,mcargo_c,msalario_c,mend_c,mbairro_c,mcidade_c,muf_c,mcep_c,;
      mfone_c1,mfone_c2,mloja1,mtel_loja1,mdesde1,mloja2,mtel_loja2,mdesde2,;
      mnome_r1,mfone_r1,mnome_r2,mfone_r2,mbanco1,mag1,mconta1,mbanco2,mag2,;
      mconta2,mcartao1,mno1,mvenc1,mcartao2,mno2,mvenc2,mpai,mmae,mdesconto,;
      mend_cob,mbairro_cob,mcidade_cob,muf_cob,mcep_cob,mfone_cob,mop_tab,;
      mdia1_ini,mdia1_fim,mvenc1_dup,mdia2_ini,mdia2_fim,mvenc2_dup,mregiao,mp,;
      ml_obs1,ml_obs2,ml_obs3,mnome1,mdata_nas1,mnome2,mdata_nas2,mnome3,;
      mdata_nas3,mnome4,mdata_nas4,mnome5,mdata_nas5,aiepict:={},mcod_forn:=0,;
      mrota:=SPACE(70),mrota1:=SPACE(70),nulo:='NULL',mpocket:=' ',m_hist:={},m_ponto:={},moutros:='N',;
      mdata_bloq,mobs_bloq,mdepen:='N',mcomplemento,mnumero,mnaturalidade,mcons_cam:={},mboleto:='',mnum_os:=0,;
      mop_forn:='',mpromotor:='   ',mretorno,macbr:='S',msituacao:=''
MEMVAR nivel_acess,mdata_sis,getlist
PRIVATE mnome_vend,mcom_ven,mcidade,muf,mcep,mcod_cond:=0,mcod_profi:=0,mcod_cli,mcod_vend

IF ! AbriArq('sacgrupo','grup');RETURN NIL;ENDIF
IF ! ver_nivel(mprg,'INCLUSAO DE CLIENTE *** CADASTRO ***','125',nivel_acess,,'AMBIE')
        RETURN NIL
ENDIF
IF ! AbriArq('regiao','reg');RETURN NIL;ENDIF
IF ! AbriArq('sacosno','osno');RETURN NIL;ENDIF

lba := 22
cba := 99

li := ci := 00
lb := 22
cb := 79

CLEAR GETS
SET KEY 281 TO cliprod()
SET KEY 286 TO alt_codcli() 	//ALT+A
SET KEY -9 TO ctrl_w()
SET KEY -7 TO f8_cep()
mcomercio := 'N'
op_tela(00,00,44,120,' Inclusao de CLIENTES ',,'*')
***INICIA O ACBRMONITOR***
IF ! inicia_acbr()
        macbr := 'N'
ENDIF
MYRUN('MD '+m_indiv[1,3]+'temp')
WHILE .T.
        exibi_prg(mprg)
        opcao := 'S'
        IF mcomercio = 'N'
                mcod_cli := 0
                mrazao := mnome := mpai := mmae := SPACE(40)
                mtipo := 'C'
                mdata_nas := CTOD('  /  /  ')
                mdata_bloq:= mdata_sis
                mdata_cad := mdata_sis
                mendereco := SPACE(35)
                mbairro := SPACE(20)
                mcidade := mnaturalidade := SPACE(25)
                muf := SPACE(2)
                mcep := SPACE(9)
                mrota := mrota1 := SPACE(70)
                mtel1 := mtel2 := mfax := mcgc := minsc := mrg := SPACE(14)
                mcpf := SPACE(11)
                morgao := SPACE(10)
                mdat_emi := CTOD('  /  /  ')
                mcomprado := mcontato := marea := SPACE(15)
                mprazo_pag := SPACE(6)
                mlimite := mcod_vend := mcodoper := mdesconto := msalario_c := ;
                mcod_cond := mcod_forn := mcod_profi := 0
                matac_vare:= 'V'
                mobs := SPACE(60)
                mobs_bloq := 'INCLUSAO DO CLIENTE'+SPACE(40)
                mcomercio := moutros := mboleto := 'N'
                IF mcpf = NIL
                        mcpf := SPACE(11)
                ENDIF
                IF mcgc = NIL
                        mcgc := SPACE(14)
                ENDIF
                mspc := mpocket := 'S'
                mempre_c := SPACE(20)
                mcargo_c := SPACE(15)
                mend_c := SPACE(35)
                mbairro_c := mcidade_c := SPACE(20)
                muf_c := SPACE(2)
                mcep_c := SPACE(9)
                mfone_c1 := mfone_c2 := mtel_loja1 := mtel_loja2 := ;
                mfone_r1 := mfone_r2 := SPACE(13)
                mbanco1 := SPACE(10)
                mag1 := mconta1 := mbanco2 := mag2 := mconta2 := SPACE(10)
                mcartao1 := mcartao2 := SPACE(15)
                mno1 := mno2 := SPACE(17)
                mloja1 := mloja2 := mnome_r1 := mnome_r2 := SPACE(25)
                mend_cob := SPACE(35)
                mbairro_cob := mcidade_cob := SPACE(20)
                muf_cob := SPACE(2)
                mcep_cob := SPACE(9)
                mfone_cob := SPACE(13)
                memail := SPACE(150)
                memail1 := memail2 := memail3 := SPACE(70)
                mop_tab := mdepen := 'N'
                mdia1_ini := mdia1_fim := mvenc1_dup:= mdia2_ini:=mdia2_fim := ;
                mvenc2_dup:= SPACE(2)
                ml_obs1 := ml_obs2 := ml_obs3 := SPACE(77)
                mregiao   := SPACE(2)
                IF ver_serie() = '141473'
                        mbloqueio := 'N'
                ELSE
                        mbloqueio := 'S'
                ENDIF
                maniver   := SPACE(1)
                mnome1    := mnome2 := mnome3 := mnome4 := mnome5 := SPACE(35)
                mdata_nas1:= mdata_nas2:= mdata_nas3:= mdata_nas4:=;
                mdata_nas5:= mdesde1 := mdesde2 := mvenc1 := mvenc2 := CTOD('  /  /  ')
                mcomplemento := SPACE(10)
                mnumero := SPACE(6)
                mpromotor:='   '
        ENDIF
        mensagem('Digite o Nome do Cliente a ser Incluido - <ESC> p/Retornar')
        DEVPOS(0,1);DEVOUT('Codigo....:')
        DEVPOS(0,21);DEVOUT('Data Cadastro:')
        DEVPOS(1,1);DEVOUT('R.Social..:')
        DEVPOS(1,55);DEVOUT('Data Nasc.:')
        DEVPOS(2,1);DEVOUT('Fantasia..:')
        DEVPOS(2,55);DEVOUT('Tipo Cliente.:')

        DEVPOS(3,1);DEVOUT('Endereco..:')
        DEVPOS(3,50);DEVOUT('Numero:')
        DEVPOS(3,66);DEVOUT('Compl.:')
        DEVPOS(4,1);DEVOUT('Bairro....:')
        DEVPOS(4,35);DEVOUT('Cidade:')
        DEVPOS(4,70);DEVOUT('UF:')
        DEVPOS(4,78);DEVOUT('CEP:')
        DEVPOS(5,1);DEVOUT('Naturalidade:')
        DEVPOS(5,42);DEVOUT('e-mail:')
        DEVPOS(5,91);DEVOUT('->')
        DEVPOS(6,1);DEVOUT('Rota......:')

        DEVPOS(8,1);DEVOUT('CNPJ......:')
        DEVPOS(8,32);DEVOUT('Insc.:')
        DEVPOS(8,55);DEVOUT('Profissao:')
        DEVPOS(9,1);DEVOUT('CPF.......:')
        DEVPOS(9,30);DEVOUT('RG:')
        DEVPOS(9,50);DEVOUT('Orgao:')
        DEVPOS(9,70);DEVOUT('Emissao:')

        DEVPOS(10,1);DEVOUT('Fone......:')
        DEVPOS(10,29);DEVOUT('Fone:')
        DEVPOS(10,51);DEVOUT('Fax:')

        DEVPOS(11,01);DEVOUT('Filiacao....:')
        DEVPOS(11,56);DEVOUT('e')

        //@ 13,1 TO 13,cba-1
        //DEVPOS(10,1);DEVOUT('FATURAMENTOS: Dia Inic.:   final:   Venc.1:   - Dia Inic.:   final:   Venc.2:')
        DEVPOS(12,1);DEVOUT('Comprador.:')
        DEVPOS(12,29);DEVOUT('Prazo Pag.:')
        DEVPOS(12,50);DEVOUT('Emissao Boleto [S/N]:')
        DEVPOS(12,75);DEVOUT('Contato:')
        DEVPOS(13,1);DEVOUT('Area......:')
        DEVPOS(13,28);DEVOUT('Limite:')
        DEVPOS(13,47);DEVOUT('Desc.Especial:      %')
        DEVPOS(13,70);DEVOUT('Cons.SPC:')
        DEVPOS(14,1);DEVOUT('[V]arejista - [A]tacadista:')
        DEVPOS(14,32);DEVOUT('Cond.Pagamento:')
        DEVPOS(15,1);DEVOUT('Bloq.Credito:')
        DEVPOS(15,16);DEVOUT('Data:')
        DEVPOS(15,30);DEVOUT('Motivo:')
        DEVPOS(16,01);DEVOUT('Observacao..:')

        DEVPOS(19,01);DEVOUT('Vend.Respon.:')
        DEVPOS(19,51);DEVOUT('Operador Resp.:')
        DEVPOS(19,72);DEVOUT('Promotor:')
        DEVPOS(19,87);DEVOUT('Regiao/Vend.:')

        DEVPOS(20,01);DEVOUT('End.Cobranca:')
        DEVPOS(20,55);DEVOUT('Bairro:')
        DEVPOS(21,01);DEVOUT('Cidade......:')
        DEVPOS(21,37);DEVOUT('UF:')
        DEVPOS(21,44);DEVOUT('CEP:')
        DEVPOS(21,59);DEVOUT('Fone:')

        DEVPOS(22,01);DEVOUT('Empresa.....:')
        DEVPOS(22,41);DEVOUT('Cargo:')
        DEVPOS(22,64);DEVOUT('Salario:')
        DEVPOS(23,01);DEVOUT('Endereco....:')
        DEVPOS(23,51);DEVOUT('Bairro:')
        DEVPOS(24,01);DEVOUT('Cidade......:')
        DEVPOS(24,37);DEVOUT('UF:')
        DEVPOS(24,44);DEVOUT('CEP:')
        DEVPOS(24,59);DEVOUT('Fone:')
        DEVPOS(24,80);DEVOUT('Fax:')


        DEVPOS(25,01);DEVOUT('Ref.Pessoal.:')
        DEVPOS(25,44);DEVOUT('Fone:')
        DEVPOS(26,01);DEVOUT('Ref.Pessoal.:')
        DEVPOS(26,44);DEVOUT('Fone:')
        DEVPOS(27,01);DEVOUT('Loja........:')
        DEVPOS(27,44);DEVOUT('Desde:')
        DEVPOS(28,01);DEVOUT('Loja........:')
        DEVPOS(28,44);DEVOUT('Desde:')
        DEVPOS(29,01);DEVOUT('Banco.......:')
        DEVPOS(29,28);DEVOUT('Agencia:')
        DEVPOS(29,49);DEVOUT('C/C:')
        DEVPOS(30,01);DEVOUT('Banco.......:')
        DEVPOS(30,28);DEVOUT('Agencia:')
        DEVPOS(30,49);DEVOUT('C/C:')
        DEVPOS(31,01);DEVOUT('Cartao......:')
        DEVPOS(31,33);DEVOUT('No.:')
        DEVPOS(31,58);DEVOUT('Venc.:')
        DEVPOS(32,01);DEVOUT('Cartao......:')
        DEVPOS(32,33);DEVOUT('No.:')
        DEVPOS(32,58);DEVOUT('Venc.:')

        DEVPOS(33,1);DEVOUT('Envia p/APP... [s/N]:')
        DEVPOS(33,24);DEVOUT('Historico[s/N]:')
        DEVPOS(33,41);DEVOUT('Tab.Prod.[s/N]:')
        DEVPOS(33,59);DEVOUT('Data Anivers.[s/N]:')
        DEVPOS(34,1);DEVOUT('Conjuge/Avalista:')
        DEVPOS(34,21);DEVOUT('Dependentes [s/N]:')
        mdata_cad := mdata_sis
        mop_hist := maniver  := 'N'
        @ 8,13 GET mcgc PICT '@@R 99.999.999/9999-99' VALID pesq_cgc(mcgc,'cli','*','cli')
	READ
	IF ! EMPTY(mcod_cli)
                setcor(3)
                DEVPOS(0,13);DEVOUT(STR(mcod_cli))
                setcor(1)
	ENDIF
	IF ! EMPTY(mcgc) .AND. macbr = 'S'
                mcaminho := ALLTRIM(m_indiv[1,2])
                RUN('MD '+mcaminho+'temp')
                RUN('DEL '+mcaminho+'temp\*.PNG')
                RUN('DEL '+mcaminho+'temp\*.JPG')
                IBR_comando('CNPJ.ConsultarCaptcha('+mcaminho+'temp\)',,3)
                mCaptcha := SPACE(10)
                //ATENCAO('OM')
                RUN('magick '+mcaminho+'temp\CaptchaCNPJ.PNG '+mcaminho+'temp\CaptchaCNPJ.JPG')
                op_tela(10,10,20,37,' Imagem Captcha ',,'*')
                limpa(0,0,10,90)
                IF WVW_DrawImage( ,1,1,7,25,''+mcaminho+'temp\CaptchaCNPJ.jpg',.T.,.F.)
                        DEVPOS(9,1);DEVOUT('Digite Captcha:')
                        @ 9,COL()+1 GET mCaptcha
                        READ
                	IF ! EMPTY(mCaptcha)
                                mretorno := IBR_comando('CNPJ.Consultar('+mcgc+','+mCaptcha+')',,3)
                                atencao(mretorno)
                                lin := MEMOLINE(mretorno,110,1,,)
                                linhas := linha := 0
                                linhas := MLCOUNT(mretorno,110)
                                FOR linha = 1 TO  linhas
                                        lin := MEMOLINE(mretorno,110,linha,,)
                                        //atencao(lin)
                                        IF 'Abertura=' $ ALLTRIM(lin)
                                                mdata_nas := CTOD(ALLTRIM(SUBSTR(lin,10)))
                                                LOOP
                                        ELSEIF 'Bairro=' $ ALLTRIM(lin)
                                                mbairro := SUBSTR(lin,8,20)
                                                LOOP
                                        ELSEIF  'CEP=' $ ALLTRIM(lin)
                                                mcep := ALLTRIM(SUBSTR(lin,5))
                                                LOOP
                                        ELSEIF  'Cidade=' $ ALLTRIM(lin)
                                                mcidade := SUBSTR(lin,8,25)
                                                LOOP
                                        ELSEIF  'Complemento=' $ ALLTRIM(lin)
                                                mcomplemento := SUBSTR(lin,13,10)
                                                LOOP
                                        ELSEIF  'Endereco=' $ ALLTRIM(lin)
                                                mendereco := SUBSTR(lin,10,35)
                                                LOOP
                                        ELSEIF  'Fantasia=' $ ALLTRIM(lin)
                                                mnome := SUBSTR(lin,10,40)
                                                LOOP
                                        ELSEIF  'Numero=' $ ALLTRIM(lin)
                                                mnumero := SUBSTR(lin,8,6)
                                                LOOP
                                        ELSEIF  'RazaoSocial=' $ ALLTRIM(lin)
                                                mrazao := SUBSTR(lin,13,40)
                                                LOOP
                                        ELSEIF  'Situacao=' $ ALLTRIM(lin)
                                                msituacao := ALLTRIM(SUBSTR(lin,10))
                                                LOOP
                                        ELSEIF  'UF=' $ ALLTRIM(lin)
                                                muf := ALLTRIM(SUBSTR(lin,4))
                                                LOOP
                                        ENDIF
                                NEXT

                                /*
                                //atencao(ALLTRIM(SUBSTR(mretorno,AT("Cidade=", mretorno)+7,25)))
                                mdata_nas := CTOD(SUBSTR(MEMOLINE(mretorno, 50, 3),10))
                                mbairro := SUBSTR(ALLTRIM(SUBSTR(MEMOLINE(mretorno, 50, 4),8)),1,20)
                                mcep := SUBSTR(ALLTRIM(SUBSTR(MEMOLINE(mretorno, 50, 5),5)),1,9)
                                mcomplemento := SUBSTR(ALLTRIM(SUBSTR(MEMOLINE(mretorno, 50, 9),13)),1,10)
                                mendereco := SUBSTR(ALLTRIM(SUBSTR(MEMOLINE(mretorno, 50,11),10)),1,35)
                                mnome := SUBSTR(ALLTRIM(SUBSTR(MEMOLINE(mretorno, 50,12),10)),1,40)
                                mnumero := SUBSTR(ALLTRIM(SUBSTR(MEMOLINE(mretorno, 50,14),8)),1,6)
                                mrazao := SUBSTR(ALLTRIM(SUBSTR(MEMOLINE(mretorno, 50,15),13)),1,40)
                                muf := SUBSTR(ALLTRIM(SUBSTR(MEMOLINE(mretorno, 50,17),4)),1,2)
                                */
                                atencao('Situacao do Cliente:'+m_qp+m_qp+'      '+msituacao)
                        ENDIF
                ENDIF
                wvw_lclosewindow()
        ENDIF
*/
        @ 0,36 GET mdata_cad PICT '99/99/99' VALID lim_get() WHEN men_get(4,70,'Caso deseja Incluir o codigo do cliente Tecle: <ALT> + A')
        @ 1,13 GET mrazao PICT '@!' VALID IF(EMPTY(mrazao),.F.,.T.)
        READ
        IF LASTKEY() = 27
                wvw_lclosewindow()
		SET KEY 281 TO 
		SET KEY 286 TO 
		SET KEY -9  TO 
		SET KEY -7  TO 
                RETURN NIL
        ENDIF
        aret:={}
	sr_getconnection():exec("SELECT razao FROM saccli WHERE razao = "+sr_cdbvalue(mrazao),,.t.,@aret)
        sr_getconnection():exec('COMMIT',,.f.)
        IF LEN(aret) > 0
                IF 'N' = op_simnao('N','Ja existe este NOME em nossos arquivos deseja incluir mesmo assim:')
                        LOOP
                ENDIF
        ENDIF
        ****************
        SELE('cli');ORDSETFOCUS(1)
        GO TOP
        ****************
        @ 1,67 GET mdata_nas
        @ 2,13 GET mnome PICT '@!'
        @ 2,70 GET mtipo PICT '@!' VALID mtipo $ 'A,B,C,D,E,F,O,P,R,S,U' .AND. lim_get() WHEN men_get(4,70,'Tipos: <C>Cliente <R>Revenda <P>otencial <F>ilial <U>Funcionarios <A>ssociado <O>Outros <E>xcluido <S>upermercado')
        @ 3,13 GET mendereco PICT '@!'
        @ 3,58 GET mnumero PICT '@!'
        @ 3,74 GET mcomplemento PICT '@!'
        @ 4,13 GET mbairro PICT '@!'
        READ
        IF EMPTY(mcidade)
                mcidade := SUBSTR(UPPER(m_set[1,134]),1,20)
                mcidade := saccid(,mcidade,,m_set[1,19],@mcep)
        ELSE
                mcidade := saccid(,UPPER(mcidade),,UPPER(muf),@mcep)
        ENDIF
        setcor(3)
        @ 4,43 SAY mcidade PICT '@!'
        setcor(1)
        @ 4,74 GET muf PICT '@!' VALID IF(EMPTY(muf),.F.,v_uf(muf))
        @ 4,82 GET mcep PICT '99999999'
        @ 5,14 GET mnaturalidade PICT '@!'
        @ 5,50 GET memail PICT '@S40' VALID lim_get() WHEN men_get(0,0,'Exemplo: sac@HTIsistemas.com.br;teste@hotmail.com (Separa os email por ponto e virgual ";" )')
        @ 6,13 GET mrota
        @ 7,13 GET mrota1

        //@ 8,13 GET mcgc PICT '@@R 99.999.999/9999-99' VALID pesq_cgc(mcgc,'cli','*','cli')
        @ 8,13 GET mcgc PICT '@@R 99.999.999/9999-99' VALID pesq_cgc(mcgc,'cli','*','cli')
        @ 8,39 GET minsc PICT '@!'      //VALID IF( TestaIe( minsc, muf ),.T.,.F.)             //WHEN ! EMPTY(mcgc)
        @ 8,65 GET mcod_profi PICT '99999' VALID ver_profi(mcod_profi,8,71)
        @ 9,13 GET mcpf PICT '@@R 999.999.999-99' VALID pesq_cpf(mcpf,'cli','*')
        @ 9,34 GET mrg PICT '@!'       //WHEN EMPTY(mcgc)
        @ 9,57 GET morgao PICT '@!'    //WHEN EMPTY(mcgc)
        @ 9,79 GET mdat_emi            //WHEN EMPTY(mcgc)
        @ 10,13 GET mtel1
        @ 10,35 GET mtel2
        @ 10,56 GET mfax

        @ 11,15 GET mpai PICT '@!'
        @ 11,58 GET mmae PICT '@!'
        @ 12,13 GET mcomprado PICT '@!'
        @ 12,41 GET mprazo_pag PICT '@R 99-99-99'
        @ 12,72 GET mboleto PICT '@!' VALID mboleto $ 'S,N'
        @ 12,84 GET mcontato PICT '@!'
        @ 13,13 GET marea PICT '@!' VALID IF(ver_serie() = '141416' .AND. EMPTY(marea),.F.,.T.)
        @ 13,35 GET mlimite PICT '999,999.99'
        @ 13,61 GET mdesconto PICT '999.99'
        @ 13,79 GET mspc PICT '@!' WHEN ver_nivel(mprg+'SPC','INCLUSAO DE CLIENTE *** VERIFICAR O SPC INTERNO ***','15',nivel_acess,'*')  VALID mspc $ 'S,N'
        @ 14,29 GET matac_vare PICT '@!' VALID matac_vare $ 'A,V'
        @ 14,48 GET mcod_cond PICT '999' VALID ver_cond(mcod_cond,14,52)
        READ
        IF LASTKEY() = 27
                wvw_lclosewindow()
                RETURN NIL
        ENDIF
        ver_cond(mcod_cond,14,52)
        @ 15,14 GET mbloqueio PICT '@!' WHEN ver_nivel(mprg+'BLOQ','INCLUSAO DE CLIENTE *** BLOQUEIO DE CREDITO DO CLIENTE ***','15',nivel_acess,'*') VALID mbloqueio $ 'S,N'
        @ 15,21 GET mdata_bloq WHEN mbloqueio = 'S' VALID IF(EMPTY(mdata_bloq),.F.,.T.)
        @ 15,38 GET mobs_bloq WHEN mbloqueio = 'S' VALID IF(EMPTY(mobs_bloq),.F.,.T.)
        READ
        IF mbloqueio = 'N'
                mdata_bloq := CTOD('  /  /  ')
                mobs_bloq  := SPACE(60)
                setcor(3)
                DEVPOS(15,21);DEVOUT(mdata_bloq)
                DEVPOS(15,38);DEVOUT(mobs_bloq)
                setcor(1)
        ENDIF

        @ 16,15 GET mobs
        @ 17,15 GET ml_obs1
        @ 18,15 GET ml_obs2

        @ 19,15 GET mcod_vend PICT '999' VALID IF(EMPTY(mcod_vend),.F.,ven(mcod_vend,19,19))
        READ        
        ven(mcod_vend,19,19)
        @ 19,67 GET mcodoper PICT '999' VALID ven(mcodoper)
        @ 19,82 GET mpromotor PICT '999' VALID ven(mpromotor)
        @ 19,101 GET mregiao PICT '99' VALID ver_regi(mregiao,19,104,,2)
        //@ 21,22 GET mcomercio PICT '@!' VALID mcomercio $ 'S,N'

        @ 20,15 GET mend_cob PICT '@!'
        @ 20,63 GET mbairro_cob PICT '@!'
        @ 21,15 GET mcidade_cob PICT '@!'
        @ 21,41 GET muf_cob PICT '@!'
        @ 21,49 GET mcep_cob PICT '99999999'
        @ 21,65 GET mfone_cob PICT '@!'

        @ 22,15 GET mempre_c PICT '@!'
        @ 22,48 GET mcargo_c PICT '@!'
        @ 22,73 GET msalario_c PICT '999,999.99'
        @ 23,15 GET mend_c PICT '@!'
        @ 23,59 GET mbairro_c PICT '@!'
        @ 24,15 GET mcidade_c PICT '@!'
        @ 24,41 GET muf_c PICT '@!'
        @ 24,49 GET mcep_c PICT '99999999'
        @ 24,65 GET mfone_c1 PICT '@!'
        @ 24,85 GET mfone_c2 PICT '@!'

        @ 25,15 GET mnome_r1 PICT '@!'
        @ 25,50 GET mfone_r1 PICT '@!'
        @ 26,15 GET mnome_r2 PICT '@!'
        @ 26,50 GET mfone_r2 PICT '@!'
        @ 27,15 GET mloja1 PICT '@!'
        @ 27,50 GET mdesde1 PICT '@!'
        @ 28,15 GET mloja2 PICT '@!'
        @ 28,50 GET mdesde2 PICT '@!'
        @ 29,15 GET mbanco1 PICT '@!'
        @ 29,36 GET mag1 PICT '@!'
        @ 29,54 GET mconta1 PICT '@!'
        @ 30,15 GET mbanco2 PICT '@!'
        @ 30,36 GET mag2 PICT '@!'
        @ 30,54 GET mconta2 PICT '@!'
        @ 31,15 GET mcartao1 PICT '@!'
        @ 31,37 GET mno1 PICT '@!'
        @ 31,64 GET mvenc1 PICT '@!'
        @ 32,15 GET mcartao2 PICT '@!'
        @ 32,37 GET mno2 PICT '@!'
        @ 32,64 GET mvenc2 PICT '@!'

        @ 33,22 GET mpocket PICT '@!' VALID mpocket $ 'S,N'
        //@ 31,39 GET mop_hist PICT '@!' VALID mop_hist $ 'S,N' WHEN ver_nivel(mprg+'HIST','INCLUSAO DE CLIENTE *** HISTORICO DO CLIENTE ***','1235',nivel_acess,'*')
        @ 33,57 GET mop_tab PICT '@!' VALID mop_tab $ 'S,N'
        @ 33,79 GET maniver PICT '@!' VALID maniver $ 'S,N'
        @ 34,18 GET moutros PICT '@!' VALID moutros $ 'S,N'
        READ
        IF LASTKEY() = 27
                wvw_lclosewindow()
                RETURN NIL
        ENDIF
        IF mbloqueio = 'N'
                mdata_bloq := CTOD('  /  /  ')
                mobs_bloq  := SPACE(60)
        ENDIF
        IF mnome == SPACE(30)
                mnome := mrazao
                setcor(3)
                DEVPOS(3,13);DEVOUT(mnome)
                setcor(1)
        ENDIF
        IF mtipo = 'U'
                op_tela(15,05,18,75,'Cod.Correspondente o CONTAS A PAGAR')
                mensagem('Digite o Codigo do FORNECEDOR/DESPESAS')
                setcor(1)
                opcao := 'S'
                DEVPOS(01,01);DEVOUT('Codigo:')
                DEVPOS(02,01);DEVOUT('Confirma [S/n]:')
                @ 16,09 GET mcod_forn PICT '9999' VALID v_fornece(mcod_forn,16,14)
                @ 17,17 GET opcao PICT '@!' VALID opcao $ 'S,N'
                READ
                IF LASTKEY() = 27 .OR. opcao = 'N'
                        mcod_forn := 0
                ENDIF
                wvw_lclosewindow()
        ENDIF
        IF mop_hist = 'S'
                op_tela(3,01,lba-5,78,' HISTORICO DO CLIENTE ')
                WHILE .T.
                        m_hist  :={}
                        m_ponto :={}
                        ******************
                        SELE('hist');ORDSETFOCUS(1)
                        GO TOP
                        IF hist->(DBSEEK(cli->cod_cli))
                                AADD(m_hist,'Data:'+DTOC(hist->data)+' - '+hist->descricao)
                                AADD(m_ponto,RECNO())
                                mdata_con := hist->data
                                SKIP
                                WHILE ! EOF() .AND. cli->cod_cli = hist->codcli
                                        IF mdata_con = hist->data
                                                AADD(m_hist,'                '+hist->descricao)
                                                AADD(m_ponto,RECNO())
                                        ELSEIF ! EOF()
                                                AADD(m_hist,REPLI('-',76-03))
                                                AADD(m_ponto,0)
                                                AADD(m_hist,'Data:'+DTOC(hist->data)+' - '+hist->descricao)
                                                AADD(m_ponto,RECNO())
                                                mdata_con := hist->data
                                        ENDIF
                                        SKIP
                                ENDDO
                                AADD(m_hist,PADC('****************************  F  I  M  ****************************',76-03))
                                AADD(m_ponto,0)
                        ENDIF
                        setcor(3)
                        IF ! EMPTY(m_hist)
                                mponto := LEN(m_hist)
                                Mensagem('<ENTER> p/alterar ou <ESC>p/Inclusao')
                                mponto := ACHOICE(4,02,lba-6,77,m_hist,,,mponto)
                                IF LASTKEY() = 13
                                        IF m_ponto[mponto] = 0
                                                LOOP
                                        ENDIF
                                        GO m_ponto[mponto]
                                        mlin1 := hist->descricao
                                        mdata_con := hist->data
                                        botao(lba-4,01,lba-2,78,,' Alteracao Historico ')
                                        setcor(1)
                                        DEVPOS(lba-3,2);DEVOUT('Data:')
                                        DEVPOS(lba-3,16);DEVOUT('-')
                                        @ lba-3,7 GET mdata_con
                                        @ lba-3,18 GET mlin1
                                        READ
                                        IF LASTKEY() = 27
                                                EXIT
                                        ENDIF
                                        IF EMPTY(mlin1)
                                                opcao := op_simnao('N','Confirma a Exclusao:')
                                                IF LASTKEY() = 27 .OR. opcao = 'N'
                                                        LOOP
                                                ENDIF
                                                BLOQREG()
                                                DELE
                                                DBCOMMIT()
                                                DBUNLOCK()
                                                sr_getconnection():exec("DELETE FROM sachist WHERE SR_DELETED = 'T'",,.f.)
                                                sr_getconnection():exec("COMMIT",,.f.)
                                        ELSE
                                                opcao := op_simnao('S','Confirma a Alteracao:')
                                                IF opcao = 'N'
                                                        LOOP
                                                ENDIF
                                                BLOQREG()
                                                hist->descricao := mlin1
                                                hist->operador  := cod_operado
                                                DBCOMMIT()
                                                DBUNLOCK()

                                        ENDIF
                                        LOOP
                                ELSE
                                        mlin1 := mlin2 := mlin3 := mlin4 := mlin5 :=;
                                        mlin6 := SPACE(60)
                                        mdata_con := mdata_sis
                                        botao(lba-7,01,lba,78,,' INCLUSAO Historico ')
                                        setcor(1)
                                        DEVPOS(lba-6,2);DEVOUT('Data:')
                                        DEVPOS(lba-6,16);DEVOUT('-')
                                        mensagem('Preencha a Data ou <ESC> p/Abandonar')
                                        @ lba-6,7 GET mdata_con
                                        READ
                                        IF LASTKEY() = 27
                                                EXIT
                                        ENDIF
                                        Mensagem('Descrevar e tecle <F10>p/Gravar ou <ESC>p/abandonar')
                                        setcor(3)
                                        mlin1 := MEMOEDIT(mlin2,lba-6,18,lba-1,cba-1,,,,,,)
                                        setcor(1)
                                        IF LASTKEY() = 27
                                                LOOP
                                        ENDIF
                                        i := 0
                                        linhas := MLCOUNT(mlin1,60)

                                        FOR i = 1 TO  linhas
                                                mlin3 := MEMOLINE(mlin1,60,i,,)
                                                ADIREG()
                                                hist->codcli    := cli->cod_cli
                                                hist->data      := mdata_con
                                                hist->hora      := TIME()
                                                hist->descricao := mlin3
                                                hist->operador  := cod_operado
                                        NEXT
                                        DBCOMMITALL()
                                        DBUNLOCKALL()
                                ENDIF
                        ELSE
                                mlin1 := mlin2 := mlin3 := mlin4 := mlin5 := ;
                                mlin6 := SPACE(60)
                                mdata_con := mdata_sis
                                botao(lba-7,01,lba,78,,' INCLUSAO Historico ')
                                setcor(1)
                                DEVPOS(lba-6,2);DEVOUT('Data:')
                                DEVPOS(lba-6,16);DEVOUT('-')
                                mensagem('Preencha a Data ou <ESC> p/Abandonar')
                                @ lba-6,7 GET mdata_con
                                READ
                                IF LASTKEY() = 27
                                        EXIT
                                ENDIF
                                Mensagem('Descrevar e tecle <F10>p/Gravar ou <ESC>p/abandonar')
                                setcor(3)
                                mlin1 := MEMOEDIT(mlin2,lba-6,18,lba-1,cba-1,,,,,,)
                                setcor(1)
                                IF LASTKEY() = 27
                                        LOOP
                                ENDIF
                                i := 0
                                linhas := MLCOUNT(mlin1,60)

                                FOR i = 1 TO  linhas
                                        mlin3 := MEMOLINE(mlin1,60,i,,)
                                        ADIREG()
                                        hist->codcli    := cli->cod_cli
                                        hist->data      := mdata_con
                                        hist->hora      := TIME()
                                        hist->descricao := mlin3
                                        hist->operador  := cod_operado
                                NEXT
                                DBCOMMITALL()
                                DBUNLOCKALL()
                        ENDIF
                ENDDO
                wvw_lclosewindow()
                SET KEY -9 TO
        ENDIF
        IF maniver = 'S'
                tela1 := SAVESCREEN(01,00,24,79)
                op_tela(10,10,17,90,' DATAS DE ANIVERSARIOS ')
                setcor(1)
                DEVPOS(li+1,ci+01);DEVOUT('Nome:')
                DEVPOS(li+1,ci+49);DEVOUT('Data Nascimento:')
                DEVPOS(li+2,ci+01);DEVOUT('Nome:')
                DEVPOS(li+2,ci+49);DEVOUT('Data Nascimento:')
                DEVPOS(li+3,ci+01);DEVOUT('Nome:')
                DEVPOS(li+3,ci+49);DEVOUT('Data Nascimento:')
                DEVPOS(li+4,ci+01);DEVOUT('Nome:')
                DEVPOS(li+4,ci+49);DEVOUT('Data Nascimento:')
                DEVPOS(li+5,ci+01);DEVOUT('Nome:')
                DEVPOS(li+5,ci+49);DEVOUT('Data Nascimento:')
                WVW_DrawBoxGet(,li+1,ci+7,LEN(mnome1))
                WVW_DrawBoxGet(,li+1,ci+66,8)
                WVW_DrawBoxGet(,li+2,ci+7,LEN(mnome2))
                WVW_DrawBoxGet(,li+2,ci+66,8)
                WVW_DrawBoxGet(,li+3,ci+7,LEN(mnome3))
                WVW_DrawBoxGet(,li+3,ci+66,8)
                WVW_DrawBoxGet(,li+4,ci+7,LEN(mnome4))
                WVW_DrawBoxGet(,li+4,ci+66,8)
                WVW_DrawBoxGet(,li+5,ci+7,LEN(mnome5))
                WVW_DrawBoxGet(,li+5,ci+66,8)
                @ li+1,ci+7 GET mnome1 PICT '@!'
                @ li+1,ci+66 GET mdata_nas1
                @ li+2,ci+7 GET mnome2 PICT '@!'
                @ li+2,ci+66 GET mdata_nas2
                @ li+3,ci+7 GET mnome3 PICT '@!'
                @ li+3,ci+66 GET mdata_nas3
                @ li+4,ci+7 GET mnome4 PICT '@!'
                @ li+4,ci+66 GET mdata_nas4
                @ li+5,ci+7 GET mnome5 PICT '@!'
                @ li+5,ci+66 GET mdata_nas5
                READ
                wvw_lclosewindow()
                IF LASTKEY() = 27
                        LOOP
                ENDIF
        ENDIF
        IF moutros = 'S'
                op_tela(03,05,22,95,'Dados CONJUGE e AVALISTA')
                WHILE .T.
                        mconjuge        := SPACE(40)
                        mconj_nasc      := CTOD('  /  /  ')
                        mconj_cpf       := SPACE(11)
                        mconj_rg        := SPACE(11)
                        mconj_empre     := SPACE(20)
                        mconj_cargo     := SPACE(15)
                        mconj_salario   := 0
                        mconj_end       := SPACE(35)
                        mconj_bairro    := SPACE(20)
                        mconj_cidade    := SPACE(20)
                        mconj_uf        := SPACE(2)
                        mconj_cep       := SPACE(9)
                        mconj_fone      := SPACE(14)
                        mconj_obs       := SPACE(50)
                        mavalista       := SPACE(40)
                        maval_sexo      := SPACE(1)
                        maval_civil     := SPACE(1)
                        maval_nasc      := CTOD('  /  /  ')
                        maval_cpf       := SPACE(11)
                        maval_rg        := SPACE(11)
                        maval_empre     := SPACE(20)
                        maval_cargo     := SPACE(15)
                        maval_salario   := 0
                        maval_end       := SPACE(35)
                        maval_bairro    := SPACE(20)
                        maval_cidade    := SPACE(20)
                        maval_uf        := SPACE(2)
                        maval_cep       := SPACE(9)
                        maval_fone      := SPACE(14)
                        maval_obs       := SPACE(50)
                        DEVPOS(00,01);DEVOUT('Nome CONJUGE......:')
                        DEVPOS(01,01);DEVOUT('Data de Nascimento:')
                        DEVPOS(02,01);DEVOUT('CPF...............:')
                        DEVPOS(02,34);DEVOUT('RG No.:')
                        DEVPOS(03,01);DEVOUT('Onde Trabalha.....:')
                        DEVPOS(04,01);DEVOUT('Cargo.............:')
                        DEVPOS(04,38);DEVOUT('Salario:')
                        DEVPOS(05,01);DEVOUT('Endereco..........:')
                        DEVPOS(06,01);DEVOUT('Bairro............:')
                        DEVPOS(06,58);DEVOUT('Cidade:')
                        DEVPOS(07,01);DEVOUT('UF................:')
                        DEVPOS(07,24);DEVOUT('CEP:')
                        DEVPOS(07,40);DEVOUT('Telefone:')
                        DEVPOS(08,01);DEVOUT('Obs...............:')
                        @ 09,00 TO 09,100
                        DEVPOS(10,01);DEVOUT('Nome AVALISTA.....:')
                        DEVPOS(11,01);DEVOUT('Data de Nascimento:')
                        DEVPOS(11,33);DEVOUT('Sexo:')
                        DEVPOS(11,40);DEVOUT('Est.Civil:')
                        DEVPOS(12,01);DEVOUT('CPF...............:')
                        DEVPOS(12,34);DEVOUT('RG No.:')
                        DEVPOS(13,01);DEVOUT('Onde Trabalha.....:')
                        DEVPOS(14,01);DEVOUT('Cargo.............:')
                        DEVPOS(14,38);DEVOUT('Salario:')
                        DEVPOS(15,01);DEVOUT('Endereco..........:')
                        DEVPOS(16,01);DEVOUT('Bairro............:')
                        DEVPOS(16,58);DEVOUT('Cidade:')
                        DEVPOS(17,01);DEVOUT('UF................:')
                        DEVPOS(17,24);DEVOUT('CEP:')
                        DEVPOS(17,40);DEVOUT('Telefone:')
                        DEVPOS(18,01);DEVOUT('Obs...............:')
                        @ 00,21 GET mconjuge PICT '@!'
                        @ 01,21 GET mconj_nasc
                        @ 02,21 GET mconj_cpf
                        @ 02,42 GET mconj_rg
                        @ 03,21 GET mconj_empre PICT '@!'
                        @ 04,21 GET mconj_cargo PICT '@!'
                        @ 04,48 GET mconj_salario PICT '9,999,999.99'
                        @ 05,21 GET mconj_end PICT '@!'
                        @ 06,21 GET mconj_bairro PICT '@!'
                        @ 06,66 GET mconj_cidade PICT '@!'
                        @ 07,21 GET mconj_uf PICT '@!'
                        @ 07,28 GET mconj_cep PICT '@!'
                        @ 07,49 GET mconj_fone
                        @ 08,21 GET mconj_obs PICT '@!'

                        @ 10,21 GET mavalista PICT '@!'
                        @ 11,21 GET maval_nasc
                        @ 11,39 GET maval_sexo PICT '@!' VALID maval_sexo $ 'M,F, '
                        @ 11,51 GET maval_civil PICT '@!' VALID maval_civil $ 'C,S,D,O, '
                        @ 12,21 GET maval_cpf
                        @ 12,42 GET maval_rg
                        @ 13,21 GET maval_empre PICT '@!'
                        @ 14,21 GET maval_cargo PICT '@!'
                        @ 14,48 GET maval_salario PICT '9,999,999.99'
                        @ 15,21 GET maval_end PICT '@!'
                        @ 16,21 GET maval_bairro PICT '@!'
                        @ 16,66 GET maval_cidade PICT '@!'
                        @ 17,21 GET maval_uf PICT '@!'
                        @ 17,28 GET maval_cep PICT '@!'
                        @ 17,49 GET maval_fone
                        @ 18,21 GET maval_obs PICT '@!'
                        READ
                        opcao := op_simnao('S','Confirma os dados Preenchido [S/n]:')
                        IF opcao = 'N'
                                LOOP
                        ELSE
                                wvw_lclosewindow()
                                EXIT
                        ENDIF
                ENDDO
        ENDIF
        opcao := op_simnao('S','Confirma a Inclusao do Cliente [S/n]:')
        IF opcao = 'N'
                LOOP
        ELSE
                IF EMPTY(muf)
                        mensagem('Nao foi preenchido a campo do Estado, Campo Obrigatorio !!!')
                        @ 9,42 GET muf PICT '@!' VALID IF(EMPTY(muf),.F.,v_uf(muf))
                        READ
                        IF LASTKEY() = 27
                                LOOP
                        ENDIF
                ENDIF
                IF EMPTY(mcod_cli)
        		aret:={}
	              	sr_getconnection():exec("SELECT MAX(cod_cli)+1 FROM saccli",,.t.,@aret)
                        sr_getconnection():exec('COMMIT',,.f.)
                        mcod_cli := aret[1,1]
        	ENDIF
	        nulo := 'NULL'
                sr_getconnection():exec('INSERT INTO saccli ('+;
                'cod_cli   ,'+; //1
                'razao     ,'+; //2
                'nome      ,'+; //3
                'data_cad  ,'+; //4
                'data_atu  ,'+; //5
                'tipo      ,'+; //6
                'nascimento,'+; //7
                'endereco  ,'+; //8
                'bairro    ,'+; //9
                'cidade    ,'+; //10
                'uf        ,'+; //11
                'cep       ,'+; //12
                'rota      ,'+; //13
                'email     ,'+; //14
                'tel1      ,'+; //15
                'tel2      ,'+; //16
                'fax       ,'+; //17
                'cgc       ,'+; //18
                'insc      ,'+; //19
                'cpf       ,'+; //20
                'rg        ,'+; //21
                'orgao     ,'+; //22
                'dat_emi   ,'+; //23
                'comprado  ,'+; //24
                'contato   ,'+; //25
                'area      ,'+; //26
                'limite    ,'+; //27 
                'atac_vare ,'+; //28
                'cod_cond  ,'+; //114
                'spc       ,'+; //29
                'obs       ,'+; //30
                'prazo_pag ,'+; //31
                'bloqueio  ,'+; //32
                'desconto  ,'+; //33
                'codvend   ,'+; //34
                'codoper   ,'+; //35
                'dia1_ini  ,'+; //36
                'dia1_fim  ,'+; //37
                'venc1_dup ,'+; //38
                'dia2_ini  ,'+; //39
                'dia2_fim  ,'+; //40
                'venc2_dup ,'+; //41
                'nome1     ,'+; //42
                'data_nas1 ,'+; //43
                'nome2     ,'+; //44
                'data_nas2 ,'+; //45
                'nome3     ,'+; //46
                'data_nas3 ,'+; //47
                'nome4     ,'+; //48
                'data_nas4 ,'+; //49
                'nome5     ,'+; //50
                'data_nas5 ,'+; //51
                'empre_c   ,'+; //52
                'cargo_c   ,'+; //53
                'salario_c ,'+; //54 
                'end_c     ,'+; //55
                'bairro_c  ,'+; //56
                'cidade_c  ,'+; //57
                'uf_c      ,'+; //58
                'cep_c     ,'+; //59
                'fone_c1   ,'+; //60
                'fone_c2   ,'+; //61
                'loja1     ,'+; //62
                'tel_loja1 ,'+; //63
                'desde1    ,'+; //64
                'loja2     ,'+; //65
                'tel_loja2 ,'+; //66
                'desde2    ,'+; //67
                'nome_r1   ,'+; //68
                'fone_r1   ,'+; //69
                'nome_r2   ,'+; //70
                'fone_r2   ,'+; //71
                'banco1    ,'+; //72
                'ag1       ,'+; //73
                'conta1    ,'+; //74
                'banco2    ,'+; //75
                'ag2       ,'+; //76
                'conta2    ,'+; //77
                'cartao1   ,'+; //78
                'no1       ,'+; //79
                'venc1     ,'+; //80
                'cartao2   ,'+; //81
                'no2       ,'+; //82
                'venc2     ,'+; //83
                'pai       ,'+; //84
                'mae       ,'+; //85
                'end_cob   ,'+; //86
                'bairro_cob,'+; //87
                'cidade_cob,'+; //88
                'uf_cob    ,'+; //89
                'cep_cob   ,'+; //90
                'fone_cob  ,'+; //91
                'regiao    ,'+; //92
                'codforn   ,'+; //93
                'l_obs1    ,'+; //94
                'l_obs2    ,'+; //95
                'l_obs3    ,'+; //96
                'pocket    ,'+; //111
                'cod_profi ,'+; //112  
                'data_bloq ,'+; //113
                'obs_bloq   ,'+; //114
                'numero     ,'+; //115
                'complemento,'+; //116
                'naturalidade,'+; //117
                'rota1       ,'+; //118
                'promotor    ,'+; //118
                'SR_DELETED )'+;
                ' VALUES ('+;
                sr_cdbvalue(mcod_cli                                    )+','+; //1
                sr_cdbvalue(mrazao                                      )+','+; //2
                sr_cdbvalue(mnome                                       )+','+; //3
                sr_cdbvalue(mdata_cad                                   )+','+; //4
                sr_cdbvalue(mdata_cad                                   )+','+; //5
                sr_cdbvalue(mtipo                                       )+','+; //6
                IF(! EMPTY(mdata_nas),sr_cdbvalue(mdata_nas),nulo)+','+; //7
                sr_cdbvalue(mendereco                                   )+','+; //8
                sr_cdbvalue(mbairro                                     )+','+; //9
                sr_cdbvalue(mcidade                                     )+','+; //10
                sr_cdbvalue(muf                                         )+','+; //11
                sr_cdbvalue(mcep                                        )+','+; //12
                sr_cdbvalue(mrota                                       )+','+; //13
                sr_cdbvalue(memail                                      )+','+; //14
                sr_cdbvalue(mtel1                                       )+','+; //15
                sr_cdbvalue(mtel2                                       )+','+; //16
                sr_cdbvalue(mfax                                        )+','+; //17
                sr_cdbvalue(mcgc                                        )+','+; //18
                sr_cdbvalue(minsc                                       )+','+; //19
                sr_cdbvalue(mcpf                                        )+','+; //20
                sr_cdbvalue(mrg                                         )+','+; //21
                sr_cdbvalue(morgao                                      )+','+; //22
                IF(! EMPTY(mdat_emi),sr_cdbvalue(mdat_emi),nulo)+','+; //23
                sr_cdbvalue(mcomprado                                   )+','+; //24
                sr_cdbvalue(mcontato                                    )+','+; //25
                sr_cdbvalue(marea                                       )+','+; //26
                sr_cdbvalue(mlimite                                     )+','+; //27
                sr_cdbvalue(matac_vare                                  )+','+; //28
                sr_cdbvalue(STRZERO(mcod_cond,3)                        )+','+; //114
                sr_cdbvalue(mspc                                        )+','+; //29
                sr_cdbvalue(mobs                                        )+','+; //30
                sr_cdbvalue(mprazo_pag+mboleto                          )+','+; //31
                sr_cdbvalue(mbloqueio                                   )+','+; //32
                sr_cdbvalue(mdesconto                                   )+','+; //33
                sr_cdbvalue(STRZERO(mcod_vend,3)                         )+','+; //34
                sr_cdbvalue(STRZERO(mcodoper,3)                         )+','+; //35
                sr_cdbvalue(STRZERO(VAL(mdia1_ini),2)                   )+','+; //36
                sr_cdbvalue(STRZERO(VAL(mdia1_fim),2)                   )+','+; //37
                sr_cdbvalue(STRZERO(VAL(mvenc1_dup),2)                  )+','+; //38
                sr_cdbvalue(STRZERO(VAL(mdia2_ini),2)                   )+','+; //39
                sr_cdbvalue(STRZERO(VAL(mdia2_fim),2)                   )+','+; //49
                sr_cdbvalue(STRZERO(VAL(mvenc2_dup),2)                  )+','+; //40
                sr_cdbvalue(mnome1                                      )+','+; //42
                IF(! EMPTY(mdata_nas1),sr_cdbvalue(mdata_nas1),nulo)+','+; //43
                sr_cdbvalue(mnome2                                      )+','+; //44
                IF(! EMPTY(mdata_nas2),sr_cdbvalue(mdata_nas2),nulo)+','+; //45
                sr_cdbvalue(mnome3                                      )+','+; //46
                IF(! EMPTY(mdata_nas3),sr_cdbvalue(mdata_nas3),nulo)+','+; //47
                sr_cdbvalue(mnome4                                      )+','+; //48
                IF(! EMPTY(mdata_nas4),sr_cdbvalue(mdata_nas4),nulo)+','+; //49
                sr_cdbvalue(mnome5                                      )+','+; //50
                IF(! EMPTY(mdata_nas5),sr_cdbvalue(mdata_nas5),nulo)+','+; //51
                sr_cdbvalue(mempre_c                                    )+','+; //52
                sr_cdbvalue(mcargo_c                                    )+','+; //53
                sr_cdbvalue(msalario_c                                  )+','+; //54 
                sr_cdbvalue(mend_c                                      )+','+; //55
                sr_cdbvalue(mbairro_c                                   )+','+; //56
                sr_cdbvalue(mcidade_c                                   )+','+; //57
                sr_cdbvalue(muf_c                                       )+','+; //58
                sr_cdbvalue(mcep_c                                      )+','+; //59
                sr_cdbvalue(mfone_c1                                    )+','+; //60
                sr_cdbvalue(mfone_c2                                    )+','+; //61
                sr_cdbvalue(mloja1                                      )+','+; //62
                sr_cdbvalue(mtel_loja1                                  )+','+; //63
                IF(! EMPTY(mdesde1),sr_cdbvalue(mdesde1),nulo)+','+; //64
                sr_cdbvalue(mloja2                                      )+','+; //65
                sr_cdbvalue(mtel_loja2                                  )+','+; //66
                IF(! EMPTY(mdesde2),sr_cdbvalue(mdesde2),nulo)+','+; //67
                sr_cdbvalue(mnome_r1                                    )+','+; //68
                sr_cdbvalue(mfone_r1                                    )+','+; //69
                sr_cdbvalue(mnome_r2                                    )+','+; //70
                sr_cdbvalue(mfone_r2                                    )+','+; //71
                sr_cdbvalue(mbanco1                                     )+','+; //72
                sr_cdbvalue(mag1                                        )+','+; //73
                sr_cdbvalue(mconta1                                     )+','+; //74
                sr_cdbvalue(mbanco2                                     )+','+; //75
                sr_cdbvalue(mag2                                        )+','+; //76
                sr_cdbvalue(mconta2                                     )+','+; //77
                sr_cdbvalue(mcartao1                                    )+','+; //78
                sr_cdbvalue(mno1                                        )+','+; //79
                IF(! EMPTY(mvenc1),sr_cdbvalue(mvenc1),nulo)+','+; //80
                sr_cdbvalue(mcartao2                                    )+','+; //81
                sr_cdbvalue(mno2                                        )+','+; //82
                IF(! EMPTY(mvenc2),sr_cdbvalue(mvenc2),nulo)+','+; //83
                sr_cdbvalue(mpai                                        )+','+; //84
                sr_cdbvalue(mmae                                        )+','+; //85
                sr_cdbvalue(IF(! EMPTY(mend_cob),mend_cob,mendereco)    )+','+; //86
                sr_cdbvalue(IF(! EMPTY(mbairro_cob),mbairro_cob,mbairro))+','+; //87
                sr_cdbvalue(IF(! EMPTY(mcidade_cob),mcidade_cob,mcidade))+','+; //88
                sr_cdbvalue(IF(! EMPTY(muf_cob),muf_cob,muf)            )+','+; //89
                sr_cdbvalue(IF(! EMPTY(mcep_cob),mcep_cob,mcep)         )+','+; //90
                sr_cdbvalue(IF(! EMPTY(mfone_cob),mfone_cob,mtel1)      )+','+; //91
                sr_cdbvalue(mregiao                                     )+','+; //92
                sr_cdbvalue(STRZERO(mcod_forn,4)                        )+','+; //93
                sr_cdbvalue(ml_obs1                                     )+','+; //94
                sr_cdbvalue(ml_obs2                                     )+','+; //95
                sr_cdbvalue(ml_obs3                                     )+','+; //96
                sr_cdbvalue(mpocket                                     )+','+; //111
                sr_cdbvalue(STRZERO(mcod_profi,5)                       )+','+; //112
                IF(! EMPTY(mdata_bloq),sr_cdbvalue(mdata_bloq),nulo)     +','+; //113
                sr_cdbvalue(mobs_bloq                                   )+','+; //114
                sr_cdbvalue(mnumero                                     )+','+; //115
                sr_cdbvalue(mcomplemento                                )+','+; //116
                sr_cdbvalue(mnaturalidade                               )+','+; //117
                sr_cdbvalue(mrota1                                      )+','+; //13
                sr_cdbvalue(mpromotor                                   )+','+; //13
                sr_cdbvalue(' ')+')',,.f.)
/*
                'l_obs4    ,'+; //97
                'l_obs5    ,'+; //98
                'l_obs6    ,'+; //99
                'l_obs7    ,'+; //100
                'l_obs8    ,'+; //101
                'l_obs9    ,'+; //102
                'l_obs10   ,'+; //103
                'l_obs11   ,'+; //104
                'l_obs12   ,'+; //105
                'l_obs13   ,'+; //106
                'l_obs14   ,'+; //107
                'l_obs15   ,'+; //108
                'l_obs16   ,'+; //109
                'l_obs17   ,'+; //110
                'l_obs18   ,'+; //111
                'l_obs19   ,'+; //112
                'l_obs20   ,'+; //113

                sr_cdbvalue(ml_obs4                                     )+','+; //97
                sr_cdbvalue(ml_obs5                                     )+','+; //98
                sr_cdbvalue(ml_obs6                                     )+','+; //99
                sr_cdbvalue(ml_obs7                                     )+','+; //100
                sr_cdbvalue(ml_obs8                                     )+','+; //101
                sr_cdbvalue(ml_obs9                                     )+','+; //102
                sr_cdbvalue(ml_obs10                                    )+','+; //103
                sr_cdbvalue(ml_obs11                                    )+','+; //104
                sr_cdbvalue(ml_obs12                                    )+','+; //105
                sr_cdbvalue(ml_obs13                                    )+','+; //106
                sr_cdbvalue(ml_obs14                                    )+','+; //107
                sr_cdbvalue(ml_obs15                                    )+','+; //108
                sr_cdbvalue(ml_obs16                                    )+','+; //109
                sr_cdbvalue(ml_obs17                                    )+','+; //110
                sr_cdbvalue(ml_obs18                                    )+','+; //111                                sr_cdbvalue(ml_obs19                                    )+','+; //112                                sr_cdbvalue(ml_obs20                                    )+','+; //113
*/
                IF moutros = 'S'
                        sr_getconnection():exec('INSERT INTO saccliaux ('+;
                        'cod_cli   ,'+; //1
                        'conjuge        ,'+; //2
                        'conj_nasc      ,'+; //3
                        'conj_cpf       ,'+; //4
                        'conj_rg        ,'+; //5
                        'conj_empre     ,'+; //6
                        'conj_cargo     ,'+; //7
                        'conj_salario   ,'+; //8
                        'conj_end       ,'+; //9
                        'conj_bairro    ,'+; //10
                        'conj_cidade    ,'+; //11
                        'conj_uf        ,'+; //12
                        'conj_cep       ,'+; //13
                        'conj_fone      ,'+; //14
                        'conj_obs       ,'+; //15
                        'avalista       ,'+; //16
                        'aval_sexo      ,'+; //17
                        'aval_civil     ,'+; //18
                        'aval_nasc      ,'+; //19
                        'aval_cpf       ,'+; //20
                        'aval_rg        ,'+; //21
                        'aval_empre     ,'+; //22
                        'aval_cargo     ,'+; //23
                        'aval_salario   ,'+; //24
                        'aval_end       ,'+; //25
                        'aval_bairro    ,'+; //26
                        'aval_cidade    ,'+; //27
                        'aval_uf        ,'+; //28
                        'aval_cep       ,'+; //29
                        'aval_fone      ,'+; //30
                        'aval_obs       ,'+; //31
                        'SR_DELETED )'+;
                        ' VALUES ('+;
                        sr_cdbvalue(mcod_cli        )+','+; //1
                        sr_cdbvalue(mconjuge        )+','+; //2
                        IF(! EMPTY(mconj_nasc),sr_cdbvalue(mconj_nasc),nulo)+','+; //3
                        sr_cdbvalue(mconj_cpf       )+','+; //4
                        sr_cdbvalue(mconj_rg        )+','+; //5
                        sr_cdbvalue(mconj_empre     )+','+; //6
                        sr_cdbvalue(mconj_cargo     )+','+; //7
                        sr_cdbvalue(mconj_salario   )+','+; //8
                        sr_cdbvalue(mconj_end       )+','+; //9
                        sr_cdbvalue(mconj_bairro    )+','+; //10
                        sr_cdbvalue(mconj_cidade    )+','+; //11
                        sr_cdbvalue(mconj_uf        )+','+; //12
                        sr_cdbvalue(mconj_cep       )+','+; //13
                        sr_cdbvalue(mconj_fone      )+','+; //14
                        sr_cdbvalue(mconj_obs       )+','+; //15
                        sr_cdbvalue(mavalista       )+','+; //16
                        sr_cdbvalue(maval_sexo      )+','+; //17
                        sr_cdbvalue(maval_civil     )+','+; //18
                        IF(! EMPTY(maval_nasc),sr_cdbvalue(maval_nasc),nulo)+','+; //19
                        sr_cdbvalue(maval_cpf       )+','+; //20
                        sr_cdbvalue(maval_rg        )+','+; //21
                        sr_cdbvalue(maval_empre     )+','+; //22
                        sr_cdbvalue(maval_cargo     )+','+; //23
                        sr_cdbvalue(maval_salario   )+','+; //24
                        sr_cdbvalue(maval_end       )+','+; //25
                        sr_cdbvalue(maval_bairro    )+','+; //26
                        sr_cdbvalue(maval_cidade    )+','+; //27
                        sr_cdbvalue(maval_uf        )+','+; //28
                        sr_cdbvalue(maval_cep       )+','+; //29
                        sr_cdbvalue(maval_fone      )+','+; //30
                        sr_cdbvalue(maval_obs       )+','+; //31
                        sr_cdbvalue(' ')+')',,.f.)
                ENDIF
                sr_getconnection():exec("COMMIT",,.f.)
                mcons_cam := {}
                sr_getconnection():exec("SELECT atu_cli FROM cam_dba",,.t.,@mcons_cam)
                sr_getconnection():exec('COMMIT',,.f.)
                IF LEN(mcons_cam) > 0
                        IF SR_SetActiveConnection(nCnn1) > 0 .AND. mcons_cam[1,1] = 'S'
                                nulo := 'NULL'
                                sr_getconnection():exec('INSERT INTO saccli ('+;
                                'cod_cli   ,'+; //1
                                'razao     ,'+; //2
                                'nome      ,'+; //3
                                'data_cad  ,'+; //4
                                'data_atu  ,'+; //5
                                'tipo      ,'+; //6
                                'nascimento,'+; //7
                                'endereco  ,'+; //8
                                'bairro    ,'+; //9
                                'cidade    ,'+; //10
                                'uf        ,'+; //11
                                'cep       ,'+; //12
                                'rota      ,'+; //13
                                'email     ,'+; //14
                                'tel1      ,'+; //15
                                'tel2      ,'+; //16
                                'fax       ,'+; //17
                                'cgc       ,'+; //18
                                'insc      ,'+; //19
                                'cpf       ,'+; //20
                                'rg        ,'+; //21
                                'orgao     ,'+; //22
                                'dat_emi   ,'+; //23
                                'comprado  ,'+; //24
                                'contato   ,'+; //25
                                'area      ,'+; //26
                                'limite    ,'+; //27
                                'atac_vare ,'+; //28
                                'cod_cond  ,'+; //114
                                'spc       ,'+; //29
                                'obs       ,'+; //30
                                'prazo_pag ,'+; //31
                                'bloqueio  ,'+; //32
                                'desconto  ,'+; //33
                                'codvend   ,'+; //34
                                'codoper   ,'+; //35
                                'dia1_ini  ,'+; //36
                                'dia1_fim  ,'+; //37
                                'venc1_dup ,'+; //38
                                'dia2_ini  ,'+; //39
                                'dia2_fim  ,'+; //40
                                'venc2_dup ,'+; //41
                                'nome1     ,'+; //42
                                'data_nas1 ,'+; //43
                                'nome2     ,'+; //44
                                'data_nas2 ,'+; //45
                                'nome3     ,'+; //46
                                'data_nas3 ,'+; //47
                                'nome4     ,'+; //48
                                'data_nas4 ,'+; //49
                                'nome5     ,'+; //50
                                'data_nas5 ,'+; //51
                                'empre_c   ,'+; //52
                                'cargo_c   ,'+; //53
                                'salario_c ,'+; //54
                                'end_c     ,'+; //55
                                'bairro_c  ,'+; //56
                                'cidade_c  ,'+; //57
                                'uf_c      ,'+; //58
                                'cep_c     ,'+; //59
                                'fone_c1   ,'+; //60
                                'fone_c2   ,'+; //61
                                'loja1     ,'+; //62
                                'tel_loja1 ,'+; //63
                                'desde1    ,'+; //64
                                'loja2     ,'+; //65
                                'tel_loja2 ,'+; //66
                                'desde2    ,'+; //67
                                'nome_r1   ,'+; //68
                                'fone_r1   ,'+; //69
                                'nome_r2   ,'+; //70
                                'fone_r2   ,'+; //71
                                'banco1    ,'+; //72
                                'ag1       ,'+; //73
                                'conta1    ,'+; //74
                                'banco2    ,'+; //75
                                'ag2       ,'+; //76
                                'conta2    ,'+; //77
                                'cartao1   ,'+; //78
                                'no1       ,'+; //79
                                'venc1     ,'+; //80
                                'cartao2   ,'+; //81
                                'no2       ,'+; //82
                                'venc2     ,'+; //83
                                'pai       ,'+; //84
                                'mae       ,'+; //85
                                'end_cob   ,'+; //86
                                'bairro_cob,'+; //87
                                'cidade_cob,'+; //88
                                'uf_cob    ,'+; //89
                                'cep_cob   ,'+; //90
                                'fone_cob  ,'+; //91
                                'regiao    ,'+; //92
                                'codforn   ,'+; //93
                                'l_obs1    ,'+; //94
                                'l_obs2    ,'+; //95
                                'l_obs3    ,'+; //96
                                'pocket    ,'+; //111
                                'cod_profi ,'+; //112
                                'data_bloq ,'+; //113
                                'obs_bloq  ,'+; //114
                                'numero     ,'+; //115
                                'complemento,'+; //116
                                'naturalidade,'+; //117
                                'rota1       ,'+; //13
                                'SR_DELETED )'+;
                                ' VALUES ('+;
                                sr_cdbvalue(mcod_cli                                    )+','+; //1
                                sr_cdbvalue(mrazao                                      )+','+; //2
                                sr_cdbvalue(mnome                                       )+','+; //3
                                sr_cdbvalue(mdata_cad                                   )+','+; //4
                                sr_cdbvalue(mdata_cad                                   )+','+; //5
                                sr_cdbvalue(mtipo                                       )+','+; //6
                                IF(! EMPTY(mdata_nas),sr_cdbvalue(mdata_nas),nulo)+','+; //7
                                sr_cdbvalue(mendereco                                   )+','+; //8
                                sr_cdbvalue(mbairro                                     )+','+; //9
                                sr_cdbvalue(mcidade                                     )+','+; //10
                                sr_cdbvalue(muf                                         )+','+; //11
                                sr_cdbvalue(mcep                                        )+','+; //12
                                sr_cdbvalue(mrota                                       )+','+; //13
                                sr_cdbvalue(memail                                      )+','+; //14
                                sr_cdbvalue(mtel1                                       )+','+; //15
                                sr_cdbvalue(mtel2                                       )+','+; //16
                                sr_cdbvalue(mfax                                        )+','+; //17
                                sr_cdbvalue(mcgc                                        )+','+; //18
                                sr_cdbvalue(minsc                                       )+','+; //19
                                sr_cdbvalue(mcpf                                        )+','+; //20
                                sr_cdbvalue(mrg                                         )+','+; //21
                                sr_cdbvalue(morgao                                      )+','+; //22
                                IF(! EMPTY(mdat_emi),sr_cdbvalue(mdat_emi),nulo)+','+; //23
                                sr_cdbvalue(mcomprado                                   )+','+; //24
                                sr_cdbvalue(mcontato                                    )+','+; //25
                                sr_cdbvalue(marea                                       )+','+; //26
                                sr_cdbvalue(mlimite                                     )+','+; //27
                                sr_cdbvalue(matac_vare                                  )+','+; //28
                                sr_cdbvalue(STRZERO(mcod_cond,3)                        )+','+; //114
                                sr_cdbvalue(mspc                                        )+','+; //29
                                sr_cdbvalue(mobs                                        )+','+; //30
                                sr_cdbvalue(mprazo_pag+mboleto                          )+','+; //31
                                sr_cdbvalue(mbloqueio                                   )+','+; //32
                                sr_cdbvalue(mdesconto                                   )+','+; //33
                                sr_cdbvalue(STRZERO(mcod_vend,3)                         )+','+; //34
                                sr_cdbvalue(STRZERO(mcodoper,3)                         )+','+; //35
                                sr_cdbvalue(STRZERO(VAL(mdia1_ini),2)                   )+','+; //36
                                sr_cdbvalue(STRZERO(VAL(mdia1_fim),2)                   )+','+; //37
                                sr_cdbvalue(STRZERO(VAL(mvenc1_dup),2)                  )+','+; //38
                                sr_cdbvalue(STRZERO(VAL(mdia2_ini),2)                   )+','+; //39
                                sr_cdbvalue(STRZERO(VAL(mdia2_fim),2)                   )+','+; //49
                                sr_cdbvalue(STRZERO(VAL(mvenc2_dup),2)                  )+','+; //40
                                sr_cdbvalue(mnome1                                      )+','+; //42
                                IF(! EMPTY(mdata_nas1),sr_cdbvalue(mdata_nas1),nulo)+','+; //43
                                sr_cdbvalue(mnome2                                      )+','+; //44
                                IF(! EMPTY(mdata_nas2),sr_cdbvalue(mdata_nas2),nulo)+','+; //45
                                sr_cdbvalue(mnome3                                      )+','+; //46
                                IF(! EMPTY(mdata_nas3),sr_cdbvalue(mdata_nas3),nulo)+','+; //47
                                sr_cdbvalue(mnome4                                      )+','+; //48
                                IF(! EMPTY(mdata_nas4),sr_cdbvalue(mdata_nas4),nulo)+','+; //49
                                sr_cdbvalue(mnome5                                      )+','+; //50
                                IF(! EMPTY(mdata_nas5),sr_cdbvalue(mdata_nas5),nulo)+','+; //51
                                sr_cdbvalue(mempre_c                                    )+','+; //52
                                sr_cdbvalue(mcargo_c                                    )+','+; //53
                                sr_cdbvalue(msalario_c                                  )+','+; //54
                                sr_cdbvalue(mend_c                                      )+','+; //55
                                sr_cdbvalue(mbairro_c                                   )+','+; //56
                                sr_cdbvalue(mcidade_c                                   )+','+; //57
                                sr_cdbvalue(muf_c                                       )+','+; //58
                                sr_cdbvalue(mcep_c                                      )+','+; //59
                                sr_cdbvalue(mfone_c1                                    )+','+; //60
                                sr_cdbvalue(mfone_c2                                    )+','+; //61
                                sr_cdbvalue(mloja1                                      )+','+; //62
                                sr_cdbvalue(mtel_loja1                                  )+','+; //63
                                IF(! EMPTY(mdesde1),sr_cdbvalue(mdesde1),nulo)+','+; //64
                                sr_cdbvalue(mloja2                                      )+','+; //65
                                sr_cdbvalue(mtel_loja2                                  )+','+; //66
                                IF(! EMPTY(mdesde2),sr_cdbvalue(mdesde2),nulo)+','+; //67
                                sr_cdbvalue(mnome_r1                                    )+','+; //68
                                sr_cdbvalue(mfone_r1                                    )+','+; //69
                                sr_cdbvalue(mnome_r2                                    )+','+; //70
                                sr_cdbvalue(mfone_r2                                    )+','+; //71
                                sr_cdbvalue(mbanco1                                     )+','+; //72
                                sr_cdbvalue(mag1                                        )+','+; //73
                                sr_cdbvalue(mconta1                                     )+','+; //74
                                sr_cdbvalue(mbanco2                                     )+','+; //75
                                sr_cdbvalue(mag2                                        )+','+; //76
                                sr_cdbvalue(mconta2                                     )+','+; //77
                                sr_cdbvalue(mcartao1                                    )+','+; //78
                                sr_cdbvalue(mno1                                        )+','+; //79
                                IF(! EMPTY(mvenc1),sr_cdbvalue(mvenc1),nulo)+','+; //80
                                sr_cdbvalue(mcartao2                                    )+','+; //81
                                sr_cdbvalue(mno2                                        )+','+; //82
                                IF(! EMPTY(mvenc2),sr_cdbvalue(mvenc2),nulo)+','+; //83
                                sr_cdbvalue(mpai                                        )+','+; //84
                                sr_cdbvalue(mmae                                        )+','+; //85
                                sr_cdbvalue(IF(! EMPTY(mend_cob),mend_cob,mendereco)    )+','+; //86
                                sr_cdbvalue(IF(! EMPTY(mbairro_cob),mbairro_cob,mbairro))+','+; //87
                                sr_cdbvalue(IF(! EMPTY(mcidade_cob),mcidade_cob,mcidade))+','+; //88
                                sr_cdbvalue(IF(! EMPTY(muf_cob),muf_cob,muf)            )+','+; //89
                                sr_cdbvalue(IF(! EMPTY(mcep_cob),mcep_cob,mcep)         )+','+; //90
                                sr_cdbvalue(IF(! EMPTY(mfone_cob),mfone_cob,mtel1)      )+','+; //91
                                sr_cdbvalue(mregiao                                     )+','+; //92
                                sr_cdbvalue(STRZERO(mcod_forn,4)                        )+','+; //93
                                sr_cdbvalue(ml_obs1                                     )+','+; //94
                                sr_cdbvalue(ml_obs2                                     )+','+; //95
                                sr_cdbvalue(ml_obs3                                     )+','+; //96
                                sr_cdbvalue(mpocket                                     )+','+; //111
                                sr_cdbvalue(STRZERO(mcod_profi,5)                       )+','+; //112
                                IF(! EMPTY(mdata_bloq),sr_cdbvalue(mdata_bloq),nulo)     +','+; //113
                                sr_cdbvalue(mobs_bloq                                   )+','+; //114
                                sr_cdbvalue(mnumero                                     )+','+; //115
                                sr_cdbvalue(mcomplemento                                )+','+; //116
                                sr_cdbvalue(mnaturalidade                               )+','+; //117
                                sr_cdbvalue(mrota1                                      )+','+; //13
                                sr_cdbvalue(' ')+')',,.f.)
                                sr_getconnection():exec("COMMIT",,.f.)
                        ENDIF
                        SR_SetActiveConnection(nCnn)
                ENDIF
                ****************
                SELE('cli');ORDSETFOCUS(1)
                ****************
                setcor(3)
                DEVPOS(0,13);DEVOUT(STR(mcod_cli))
                setcor(1)
                INKEY(2)
/*
                IF mdepen = 'S'
                        sacdepe(mcod_cli)
                ENDIF
*/
                IF mop_tab = 'S'
                        tabcliprod()
                ENDIF
                IF m_set[1,157] = 'PROVEDOR'
                        *************
                        SELE('osno')
                        *************
                        IF ! BLOQARQ()
                                LOOP
                        ENDIF
                        GO TOP
                        IF LASTREC() = 0
                                IF ! ADIREG()
                                        atencao('Nao foi possivel gerar o numero do PEDIDO')
                                        LOOP
                                ENDIF
                        ELSE
                                IF ! BLOQARQ()
                                        atencao('Nao foi possivel gerar o numero da O.S.')
                                        LOOP
                                ENDIF
                        ENDIF
                        mnum_os = VAL(osno->num_os)+1
                        osno->num_os := STRZERO(mnum_os,6)
                        DBCOMMIT()
                        DBUNLOCK()

                        sr_getconnection():exec('INSERT INTO sacoss ('+;
                        'num_os      ,'+; //2
                        'operador    ,'+; //3
                        'cod_cli     ,'+; //4
                        'data_ent    ,'+; //5
                        'hora_ent    ,'+; //6
                        'diag1       ,'+; //11
                        'tipo_os     ,'+; //35
                        'SR_DELETED )'+;
                        ' VALUES ('+;
                        sr_cdbvalue(STRZERO(mnum_os,6)  )+','+; //2
                        sr_cdbvalue(cod_operado         )+','+; //3
                        sr_cdbvalue(mcod_cli            )+','+; //4
                        sr_cdbvalue(mdata_cad           )+','+; //5
                        sr_cdbvalue(TIME()             )+','+; //6
                        sr_cdbvalue('INSTALACAO PONTO DE INTERNET')+','+; //12
                        sr_cdbvalue('I'                 )+','+; //37
                        sr_cdbvalue(' ')+')',,.f.)
                        sr_getconnection():exec("COMMIT",,.f.)
                        setcor(1)
                        atencao('Foi Gerada o Numero da O.S.: '+STRZERO(mnum_os,6))
                ENDIF

                //SET KEY -9 TO fecha_pd
                CLEAR GETS
                mp := '*'
                opcao := op_simnao('N','Deseja imprimir o cadastro do cliente [S/n]:')
                IF opcao = 'S'
                        sac5cad1(mcod_cli)
                ENDIF
                /*
                mop_forn := op_simnao('S','Deseja Cadastrar com FORNCEDOR [S/n]:')
                IF mop_forn = 'S'
			****************
        	        SELE('forn');ORDSETFOCUS(1)
                	****************
	                IF BLOQARQ()
        	                GO BOTT
                	        mcod_forn := STRZERO(VAL(forn->cod_forn)+1,4)
	                ENDIF
                        sr_getconnection():exec('INSERT INTO sacforn ('+;
                        'cod_forn       ,'+; //1
                        'razao          ,'+; //2
                        'data_cad       ,'+; //3
                        'endereco       ,'+; //4
                        'bairro         ,'+; //5
                        'cidade         ,'+; //6
                        'uf             ,'+; //7
                        'cep            ,'+; //8
                        'email          ,'+; //9
                        'tel1           ,'+; //10
                        'tel2           ,'+; //11
                        'fax            ,'+; //12
                        'cgc            ,'+; //13
                        'insc           ,'+; //14
                        'cpf            ,'+; //15
                        'obs            ,'+; //16
                        'obs1           ,'+; //17
                        'obs2           ,'+; //18
                        'obs3           ,'+; //19
                        'fantasia       ,'+; //20
                        'SR_DELETED )'+;
                        ' VALUES ('+;
                        sr_cdbvalue(mcod_forn                                   )+','+; //1
                        sr_cdbvalue(mrazao                                      )+','+; //2
                        sr_cdbvalue(mdata_cad                                   )+','+; //3
                        sr_cdbvalue(mendereco                                   )+','+; //4
                        sr_cdbvalue(mbairro                                     )+','+; //5
                        sr_cdbvalue(mcidade                                     )+','+; //6
                        sr_cdbvalue(muf                                         )+','+; //7
                        sr_cdbvalue(mcep                                        )+','+; //8
                        sr_cdbvalue(SUBSTR(memail,1,120)                        )+','+; //9
                        sr_cdbvalue(mtel1                                       )+','+; //10
                        sr_cdbvalue(mtel2                                       )+','+; //11
                        sr_cdbvalue(mfax                                        )+','+; //12
                        sr_cdbvalue(mcgc                                        )+','+; //13
                        sr_cdbvalue(SUBSTR(minsc,1,14)                          )+','+; //14
                        sr_cdbvalue(mcpf                                        )+','+; //15
                        sr_cdbvalue(SUBSTR(mobs,1,60)                           )+','+; //16
                        sr_cdbvalue(SUBSTR(ml_obs1,1,60)                        )+','+; //17
                        sr_cdbvalue(SUBSTR(ml_obs2,1,60)                        )+','+; //18
                        sr_cdbvalue(SUBSTR(ml_obs3,1,60)                        )+','+; //19
                        sr_cdbvalue(mnome                                       )+','+; //20
                        sr_cdbvalue(' ')+')',,.f.)
                        sr_getconnection():exec("COMMIT",,.f.)
                ENDIF
                */
                ****************
                SELE('cli');ORDSETFOCUS(2)
                ****************
                wvw_lclosewindow()
                RETURN mp
        ENDIF
ENDDO
wvw_lclosewindow()
RETURN NIL
*********************** f i m ************************************
FUNCTION alt_codcli()
***************
LOCAL aret:={}
MEMVAR mcod_cli
CLEAR GETS
op_tela(10,10,12,50,' ALTERACAO DO CODIGO DO CLIENTE ')
DEVPOS(01,00);DEVOUT('Digite o Codigo do Cliente:')
@ 01,COL()+1 GET mcod_cli PICT '99999' VALID IF(LEN(mcod_cli) < 5,.F.,.T.)
READ
wvw_lclosewindow()
IF LASTKEY() = 27
	****************
	SELE('cli');ORDSETFOCUS(2)
	****************
        mcod_cli := 0
	RETURN .F.
ENDIF
aret:={}
sr_getconnection():exec("SELECT * FROM saccli WHERE cod_cli = "+sr_cdbvalue(mcod_cli),,.t.,@aret)
sr_getconnection():exec('COMMIT',,.f.)
IF LEN(aret) > 0
	atencao('Este codigo ja existe nao pode ser usado...')
	****************
	SELE('cli');ORDSETFOCUS(2)
	****************
        mcod_cli := 0
        RETURN .F.
ENDIF
****************
SELE('cli');ORDSETFOCUS(2)
****************
RETURN .T.