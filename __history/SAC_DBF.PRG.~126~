************************************
* FUNCAO PARA ATUALIZAR OS DBF'S
***********************************
#include "sqlrdd.ch"
#include "firebird.ch"       // Firebird
FUNCTION sac_dbf(mtp)
*********************
LOCAL mprg:='SAC_DBF',;
      mobs1:='',mobs2:='',mobs3:='',mobs4:='',mArq:= '',slinhas :='',i:=0

PRIVATE mdata_merc,mdata_mov,mdata_peds,mdata_caixa,mdata_cli,;
        mdata_dupr,mdata_movnt,mdata_setup,mdata_conf,mdata_cheq,mdata_cfg,;
        mdata_senha,mdata_totnt,mdata_log,mdata_roma,mdata_dupp,mdata_tbmer,mdata_cart,mdata_r5,;
        matualiza,mmerc,mmov,mmovnt,mos,mpeds,mcaix,mdupr,mdupp,mcart,mgeral,;
        mcli,msetup,mcheq,mcfg,mroma,minsopera,mlog,mtotnt,mtbmer,mtela,;
        mdata_ver,matual,mtela_bkp,mdata_arq,mpped,mdata_pped,mdata_op,mop,mr5,;
        mdata_ass,mass,mnome_arq:='',mdata_forn,mforn,mnota,mdata_nota,mdata_ban,mban,;
        mdata_tabl,mtabl,mmensagem:='',mpede,mdata_pede,mcid,mdata_cid,mdata_logp,mlogp,;
        mdata_emp,memp,mdata_obs,mobs,aret:={},mdata_trans,mtrans,m_mat:={},mdata_trm,mtrm,msef,mdata_sef,mdata_geral,;
        matriz:={},mindiv,mdata_indiv,;
        mdata_r1,mr1,mdata_icm,micm,mcst,mdata_cst,mcrip,mdata_crip,mpped,mdata_pped,mncm,mdata_ncm,mtrm,mdata_trm,;
        mdata_mdfe,mmdfe

IF SUBSTR(m_cfg[5],2,1) = '9' .OR. SUBSTR(m_cfg[5],2,1) = '8' .OR. SUBSTR(m_cfg[5],2,1) = '7'
        mdata_ver := CTOD(SUBSTR(m_cfg[5],7,2)+'/'+SUBSTR(m_cfg[5],4,2)+'/20'+STRZERO(VAL(SUBSTR(m_cfg[5],2,1)),2))
ELSE
        mdata_ver := CTOD(SUBSTR(m_cfg[5],8,2)+'/'+SUBSTR(m_cfg[5],5,2)+'/20'+STRZERO(VAL(SUBSTR(m_cfg[5],2,2)),2))
ENDIF
IF mdata_ver < CTOD('07/07/2022')
        RUN('DEL '+Curdrive()+ ':\' + rtrim(curdir())+ '\Magick.exe')
        RUN(' Magick_install.exe')
ENDIF

IF m_cfg[2] <> 'S'
	RETURN NIL
ENDIF
mdata_pped := CTOD('14/03/2007')
mdata_cheq := CTOD('25/06/2007')
mdata_caixa:= CTOD('20/07/2008')
mdata_tabpg:= CTOD('21/03/2009')
mdata_logp := CTOD('24/04/2009')
mdata_cid  := CTOD('13/08/2009')
mdata_obs  := CTOD('18/10/2009')
mdata_roma := CTOD('03/05/2010')
mdata_tabl := CTOD('12/08/2010')
mdata_cart := CTOD('27/08/2010')
mdata_ass  := CTOD('29/09/2010')
mdata_pres := CTOD('19/10/2010')
mdata_emp  := CTOD('27/12/2010')
mdata_cam  := CTOD('05/05/2012')
mdata_sef  := CTOD('25/05/2012')
mdata_nota := CTOD('01/08/2012')
mdata_os   := CTOD('03/10/2012')
mdata_totnt:= CTOD('30/11/2012')
mdata_icm  := CTOD('28/12/2012')
mdata_movnt:= CTOD('10/01/2013')
mdata_forn := CTOD('08/03/2013')
mdata_crip := CTOD('14/03/2013')
mdata_pped := CTOD('05/09/2013')
mdata_r1   := CTOD('07/07/2013')
mdata_trans:= CTOD('26/02/2014')
mdata_dupp := CTOD('12/07/2014')
mdata_trm  := CTOD('07/10/2014')
mdata_op   := CTOD('07/04/2015')
mdata_ncm  := CTOD('28/12/2015')
mdata_setup:= CTOD('01/08/2019')
mdata_geral:= CTOD('04/03/2020')
mdata_cst  := CTOD('13/03/2020')
mdata_mdfe := CTOD('30/11/2020')
mdata_indiv:= CTOD('25/03/2021')
mdata_ban  := CTOD('10/06/2021')
mdata_cnnt := CTOD('04/08/2021')
mdata_senha:= CTOD('30/08/2021')
mdata_cli  := CTOD('30/08/2021')
mdata_merc := CTOD('16/09/2021')
mdata_log  := CTOD('16/10/2021')
mdata_dupr := CTOD('02/11/2021')
mdata_mov  := CTOD('06/04/2022')
mdata_pede := CTOD('30/06/2022')
mdata_tbmer:= CTOD('06/08/2022')
mdata_peds := CTOD('27/09/2022')

IF mtp # 'HTI'
        IF mtp = 'arquivo'
	       matualiza := mmerc := mmov := mmovnt := mos := mpeds := mcaix := mdupr := mdupp := ;
                mcli := msetup:= mcheq := mcfg := mroma := minsopera := mlog := mtotnt :=;
	       mtbmer := matual := mcart := mcnnt := mpped := mop := mass := mforn := mnota:=;
        	mban := mtabl := mtabpg := mpede := mpres := mcid := mlogp := memp := mobs := mcam :=;
                matualiza := mtrans := mtrm := mpped :=;
                msef := mr1 := micm := mcst := mcrip := mindiv := mncm := mtrm := mgeral := mmdfe= 'X'
        ELSE
	       matualiza := mmerc := mmov := mmovnt := mos := mpeds := mcaix := mdupr := mdupp := ;
        	mcli := msetup:= mcheq := mcfg := mroma := minsopera := mlog := mtotnt :=;
	       mtbmer := matual := mcart := mcnnt := mpped := mop := mass := mforn := mnota:=mpped:=;
        	mban := mtabl := mtabpg := mpede := mpres := mcid := mlogp := memp := mobs := mcam := mtrans := mtrm := msef := mr1 := micm := mcst := mcrip :=;
                mindiv := mncm := mtrm := mgeral := mmdfe := ' '
	       IF SUBSTR(m_cfg[5],2,1) = '9' .OR. SUBSTR(m_cfg[5],2,1) = '8' .OR. SUBSTR(m_cfg[5],2,1) = '7'
                	mdata_ver := CTOD(SUBSTR(m_cfg[5],7,2)+'/'+SUBSTR(m_cfg[5],4,2)+'/20'+STRZERO(VAL(SUBSTR(m_cfg[5],2,1)),2))
	       ELSE
                	mdata_ver := CTOD(SUBSTR(m_cfg[5],8,2)+'/'+SUBSTR(m_cfg[5],5,2)+'/20'+STRZERO(VAL(SUBSTR(m_cfg[5],2,2)),2))
	       ENDIF
        ENDIF
        IF mdata_ver < mdata_merc ;matualiza := mmerc := 'X'    ;ENDIF
        IF mdata_ver < mdata_mov  ;matualiza := mmov := 'X'     ;ENDIF
        IF mdata_ver < mdata_movnt;matualiza := mmovnt := 'X'   ;ENDIF
        IF mdata_ver < mdata_os   ;matualiza := mos  := 'X'   ;ENDIF
        IF mdata_ver < mdata_peds ;matualiza := mpeds := 'X'    ;ENDIF
        IF mdata_ver < mdata_caixa;matualiza := mcaix := 'X'    ;ENDIF
        IF mdata_ver < mdata_dupr ;matualiza := mdupr := 'X'    ;ENDIF
        IF mdata_ver < mdata_dupp ;matualiza := mdupp := 'X'    ;ENDIF
        IF mdata_ver < mdata_setup;matualiza := msetup:= 'X'    ;ENDIF
        IF mdata_ver < mdata_cheq ;matualiza := mcheq := 'X'    ;ENDIF
        IF mdata_ver < mdata_roma ;matualiza := mroma := 'X'    ;ENDIF
        IF mdata_ver < mdata_senha;matualiza := minsopera := 'X';ENDIF
        IF mdata_ver < mdata_log  ;matualiza := mlog := 'X'     ;ENDIF
        IF mdata_ver < mdata_totnt;matualiza := mtotnt := 'X'   ;ENDIF
        IF mdata_ver < mdata_tbmer;matualiza := mtbmer := 'X'   ;ENDIF
        IF mdata_ver < mdata_cart;matualiza  := mcart := 'X'   ;ENDIF
        IF mdata_ver < mdata_cnnt;matualiza  := mcnnt := 'X'   ;ENDIF
        IF mdata_ver < mdata_pped;matualiza  := mpped := 'X'   ;ENDIF
        IF mdata_ver < mdata_op;matualiza := mop := 'X'   ;ENDIF
        IF mdata_ver < mdata_ass;matualiza   := mass := 'X'   ;ENDIF
        IF mdata_ver < mdata_forn;matualiza  := mforn := 'X'   ;ENDIF
        IF mdata_ver < mdata_nota;matualiza  := mnota := 'X'   ;ENDIF
        IF mdata_ver < mdata_ban;matualiza   := mban := 'X'   ;ENDIF
        IF mdata_ver < mdata_tabl;matualiza  := mtabl := 'X'   ;ENDIF
        IF mdata_ver < mdata_tabpg;matualiza := mtabpg := 'X'   ;ENDIF
        IF mdata_ver < mdata_cli;matualiza   := mcli := 'X'   ;ENDIF
        IF mdata_ver < mdata_pede;matualiza  := mpede := 'X'   ;ENDIF
        IF mdata_ver < mdata_pres;matualiza  := mpres := 'X'   ;ENDIF
        IF mdata_ver < mdata_cid;matualiza   := mcid := 'X'   ;ENDIF
        IF mdata_ver < mdata_logp;matualiza  := mlogp := 'X'   ;ENDIF
        IF mdata_ver < mdata_emp;matualiza   := memp := 'X'   ;ENDIF
        IF mdata_ver < mdata_obs;matualiza   := mobs := 'X'   ;ENDIF
        IF mdata_ver < mdata_cam;matualiza   := mcam := 'X'   ;ENDIF
        IF mdata_ver < mdata_trans;matualiza := mtrans := 'X'   ;ENDIF
        IF mdata_ver < mdata_trm;matualiza   := mtrm := 'X'   ;ENDIF
        IF mdata_ver < mdata_sef;matualiza   := msef := 'X'   ;ENDIF
        IF mdata_ver < mdata_r1;matualiza   := mr1 := 'X'   ;ENDIF
        IF mdata_ver < mdata_icm;matualiza   := micm := 'X'   ;ENDIF
        IF mdata_ver < mdata_cst;matualiza   := mcst := 'X'   ;ENDIF
        IF mdata_ver < mdata_crip;matualiza   := mcrip := 'X'   ;ENDIF
        IF mdata_ver < mdata_indiv;matualiza   := mindiv := 'X'   ;ENDIF
        IF mdata_ver < mdata_mdfe;matualiza   := mmdfe := 'X'   ;ENDIF
        IF mdata_ver < mdata_ncm;matualiza   := mncm := 'X'   ;ENDIF
        IF mdata_ver < mdata_trm;matualiza   := mtrm := 'X'   ;ENDIF
        IF mdata_ver < mdata_geral;matualiza   := mgeral := 'X'   ;ENDIF
ENDIF
//mdata_ver := CTOD(SUBSTR(m_set[1,1],7,2)+'/'+SUBSTR(m_set[1,1],4,2)+'/20'+STRZERO(VAL(SUBSTR(m_set[1,1],2,1)),2))
IF matualiza = 'X'
        alt_tb()
        IF mgeral = 'X' .AND. m_cfg[2] = 'S'
                mmensagem :=             '***** P R I M E I R A   P A R T E  *****'+m_qp+m_qp
                mmensagem := mmensagem + '***** Arquivo SACASS *****'+m_qp
                mmensagem := mmensagem + 'ALTERAR campo cod_cli CHAR -> INTEGER '+m_qp
                mmensagem := mmensagem + '***** Arquivo SACCAIXA *****'+m_qp
                mmensagem := mmensagem + 'ALTERAR campo cod_cli CHAR -> INTEGER '+m_qp
                mmensagem := mmensagem + '***** Arquivo SACCHEQ *****'+m_qp
                mmensagem := mmensagem + 'ALTERAR campo cod_cli CHAR -> INTEGER '+m_qp
                mmensagem := mmensagem + '***** Arquivo SACCLI *****'+m_qp
                mmensagem := mmensagem + 'ALTERAR campo cod_cli CHAR -> INTEGER '+m_qp
                mmensagem := mmensagem + '***** Arquivo SACCLIAUX *****'+m_qp
                mmensagem := mmensagem + 'ALTERAR campo cod_cli CHAR -> INTEGER '+m_qp
                mmensagem := mmensagem + '***** Arquivo SACCLIDEPE *****'+m_qp
                mmensagem := mmensagem + 'ALTERAR campo cod_cli CHAR -> INTEGER '+m_qp
                mmensagem := mmensagem + '***** Arquivo SACCRED *****'+m_qp
                mmensagem := mmensagem + 'ALTERAR campo fornec CHAR -> INTEGER '+m_qp
                mmensagem := mmensagem + '***** Arquivo SACDUPR *****'+m_qp
                mmensagem := mmensagem + 'ALTERAR campo fornec CHAR -> INTEGER '+m_qp
                mmensagem := mmensagem + '***** Arquivo SACENTPROD *****'+m_qp
                mmensagem := mmensagem + 'ALTERAR campo cod_cli CHAR -> INTEGER '+m_qp
                mmensagem := mmensagem + '***** Arquivo SACHIST *****'+m_qp
                mmensagem := mmensagem + 'ALTERAR campo codcli CHAR -> INTEGER '+m_qp
                mmensagem := mmensagem + '***** Arquivo SACLOG *****'+m_qp
                mmensagem := mmensagem + 'ALTERAR campo cod_cli CHAR -> INTEGER '+m_qp
                mmensagem := mmensagem + '***** Arquivo SACMOV *****'+m_qp
                mmensagem := mmensagem + 'ALTERAR campo cod_cli CHAR -> INTEGER '+m_qp
                mmensagem := mmensagem + '***** Arquivo SACMOVNT *****'+m_qp
                mmensagem := mmensagem + 'ALTERAR campo cod_cli CHAR -> INTEGER '+m_qp
                atencao(mmensagem)
                mmensagem :=             '***** S E G U N D A   P A R T E  *****'+m_qp+m_qp
                mmensagem := mmensagem + '***** Arquivo SACORCAM *****'+m_qp
                mmensagem := mmensagem + 'ALTERAR campo pcod_cli CHAR -> INTEGER '+m_qp
                mmensagem := mmensagem + '***** Arquivo SACOSS *****'+m_qp
                mmensagem := mmensagem + 'ALTERAR campo cod_cli CHAR -> INTEGER '+m_qp
                mmensagem := mmensagem + '***** Arquivo SACPCLI *****'+m_qp
                mmensagem := mmensagem + 'ALTERAR campo pcod_cli CHAR -> INTEGER '+m_qp
                mmensagem := mmensagem + '***** Arquivo SACPED_C *****'+m_qp
                mmensagem := mmensagem + 'ALTERAR campo cod_cli CHAR -> INTEGER '+m_qp
                mmensagem := mmensagem + '***** Arquivo SACPED_S *****'+m_qp
                mmensagem := mmensagem + 'ALTERAR campo pcod_cli CHAR -> INTEGER '+m_qp
                mmensagem := mmensagem + '***** Arquivo SACPPED *****'+m_qp
                mmensagem := mmensagem + 'ALTERAR campo pcod_cli CHAR -> INTEGER '+m_qp
                mmensagem := mmensagem + '***** Arquivo SACPRESEN *****'+m_qp
                mmensagem := mmensagem + 'ALTERAR campo cod_cli CHAR -> INTEGER '+m_qp
                mmensagem := mmensagem + '***** Arquivo SACREME *****'+m_qp
                mmensagem := mmensagem + 'ALTERAR campo pcod_cli CHAR -> INTEGER '+m_qp
                mmensagem := mmensagem + '***** Arquivo SACSETUP *****'+m_qp
                mmensagem := mmensagem + 'ALTERAR campo cli_def CHAR -> INTEGER  posicao 84'+m_qp
                mmensagem := mmensagem + '***** Arquivo SACSOLPR *****'+m_qp
                mmensagem := mmensagem + 'ALTERAR campo cod_cli CHAR -> INTEGER '+m_qp
                mmensagem := mmensagem + '***** Arquivo SACTABME *****'+m_qp
                mmensagem := mmensagem + 'ALTERAR campo cod_cli CHAR -> INTEGER '+m_qp
                mmensagem := mmensagem + '***** Arquivo SACTPED *****'+m_qp
                mmensagem := mmensagem + 'ALTERAR campo pcod_cli CHAR -> INTEGER '+m_qp
                mmensagem := mmensagem + '***** Arquivo SACTOTNT *****'+m_qp
                mmensagem := mmensagem + 'ALTERAR campo cod_cli CHAR -> INTEGER '+m_qp
                atencao(mmensagem)
        ENDIF


        IF mtbmer = 'X' .AND. m_cfg[2] = 'S'
        ENDIF
        IF mcam = 'X' .AND. m_cfg[2] = 'S'
                mmensagem := '***** Arquivo CAM_DBA     I N C L U I R  *****'+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp
                mmensagem := mmensagem + '>>>> SR_RECNO posicao = 9'+m_qp
                atencao(mmensagem)
        ENDIF
        IF minsopera = 'X' .AND. m_cfg[2] = 'S'
                mmensagem := '***** Arquivo INSOPERA     I N C L U I R  *****'+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp
                mmensagem := mmensagem + m_qp+'>>>> SR_RECNO posicao = 46'+m_qp+m_qp
                atencao(mmensagem)
        ENDIF
        IF mlogp = 'X'
                mmensagem := '***** Arquivo LOGPRODUTO ***** '+m_qp
                mmensagem := mmensagem + '=> Excluir a TABELA LOGPRODUTO >>'
                atencao(mmensagem)
        ENDIF
        IF mass = 'X' .AND. m_cfg[2] = 'S'
                mmensagem := '***** Arquivo SACASS     I N C L U I R   *****'+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp
                atencao(mmensagem)
        ENDIF
        IF mban = 'X' .AND. m_cfg[2] = 'S'
                mmensagem := '***** Arquivo SACBANCO     I N C L U I R   *****'+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp
                mmensagem := mmensagem + '>>>> SR_RECNO posicao = 15'+m_qp
                mmensagem := mmensagem + m_qp+'***** Arquivo SACBANCO    A L T E R A R   *****'+m_qp
                mmensagem := mmensagem + '<<Nome: AGENCIA Tipo: VARCHAR(15) >>'+m_qp+'<<Nome: C_C Tipo: VARCHAR(15) >>'+m_qp+'<<Nome: ACESS_ESCR Tipo: VARCHAR(20) >>'+m_qp+'<<Nome: TIPO_COB Tipo: VARCHAR(3) >>'
                mmensagem := mmensagem + '<<Nome: ACESS_ESCR Tipo: VARCHAR(20) >>'+m_qp+m_qp
                mmensagem := mmensagem + '<<Nome: tp_cobranca  -> n_conv VARCHAR(12) >>'+m_qp
                mmensagem := mmensagem + '<<Nome: tipocarteira -> dig_ag_cc VARCHAR(8) >>'+m_qp
                mmensagem := mmensagem + '<<Nome: caractitulo  -> modalidade VARCHAR(8) >>'+m_qp
                mmensagem := mmensagem + '<<Nome: tipo_cob     -> cod_trans VARCHAR(8) >>'+m_qp
                atencao(mmensagem)
        ENDIF
        IF mcaix = 'X'
                mmensagem := '***** Arquivo SACCAIXA     I N C L U I R    *****'+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp
                atencao(mmensagem)
        ENDIF
        IF mcart = 'X' .AND. m_cfg[2] = 'S'
                mmensagem := '***** Arquivo SACCARTA     I N C L U I R    *****'+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp
                atencao(mmensagem)
        ENDIF
        IF mcid = 'X' .AND. m_cfg[2] = 'S'
                mmensagem := '***** Arquivo SACCID    A L T E R A R   *****'+m_qp
                mmensagem := mmensagem + '<< Nome: COD_CID Tipo: VARCHAR(7)>>'+m_qp+'<< Nome: CIDADE Tipo: VARCHAR(25)>>'
                atencao(mmensagem)
        ENDIF
        IF mcli = 'X'
                opcao := op_simnao('N','Deseja Atualizar o Campo L_OBS4:')
                IF opcao = 'S'
                        sr_getconnection():exec("UPDATE saccli SET l_obs4 = NULL",,.f.)
                        sr_getconnection():exec('COMMIT',,.f.)
                ENDIF
                mmensagem := '***** Arquivo SACCLI     I N C L U I R     *****'+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp
                mmensagem := mmensagem + m_qp+'>>>> SR_RECNO posicao = 145'+m_qp+m_qp
                mmensagem := mmensagem + m_qp+'***** Arquivo SACCLI     A L T E R A R     *****'+m_qp
                mmensagem := mmensagem + '<< Nome: CIDADE Tipo: VARCHAR(25)>>'+m_qp+'<< Nome: CIDADE_COB e CIDADE_C tipo: VARCHAR(25)>>'+m_qp+'<< Nome: L_OBS4 para NATURALIDADE tipo: VARCHAR(25)>>'+m_qp+'<< Nome: PAI tipo: VARCHAR(40)>>'+m_qp+'<< Nome: MAE tipo: VARCHAR(40)>>'+m_qp+'<< Nome: EMAIL tipo: VARCHAR(150)>>'
                atencao(mmensagem)
        ENDIF
        IF mcst = 'X' .AND. m_cfg[2] = 'S'
                mmensagem := '***** Arquivo SACCST    A L T E R A R   *****'+m_qp
                mmensagem := mmensagem + '<< Nome: CST Tipo: VARCHAR(4)>>'+m_qp
                mmensagem := mmensagem + '<< Nome: DESCRI Tipo: VARCHAR(120)>>'+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp
                mmensagem := mmensagem + m_qp+'>>>> SR_RECNO posicao = 6'+m_qp+m_qp
                atencao(mmensagem)
        ENDIF
        IF mdupp = 'X' .AND. m_cfg[2] = 'S'
                mmensagem := '***** Arquivo SACDUPP     I N C L U I R      *****'+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp+ m_qp
                mmensagem := mmensagem + '>>>> SR_RECNO posicao = 36'+m_qp+m_qp
                mmensagem := mmensagem +'***** Arquivo SACDUPP     A L T E R A R      *****'+m_qp
                mmensagem := mmensagem + '<< Nome: DESC para DESCONTO>> '+m_qp
                mmensagem := mmensagem + '<< Nome: DUPLICATA VARCHAR(12)>>'+m_qp
                mmensagem := mmensagem + '<< Nome: NUM_PED VARCHAR(10)>>'
                atencao(mmensagem)
        ENDIF
        IF mdupr = 'X' .AND. m_cfg[2] = 'S'
                mmensagem := '***** Arquivo SACDUPR  I N C L U I R      *****'+m_qp
                mmensagem := mmensagem + '<< Nome: TIPO_PG Tipo: VARCHAR(20)>>'+m_qp
                mmensagem := mmensagem + '<< Nome: PARCELA Tipo: DECIMAL(3,0)>>'+m_qp
                mmensagem := mmensagem + '<< Nome: COD_PG Tipo: VARCHAR(3)>>'+m_qp+m_qp
                mmensagem := mmensagem + '          << VERIFICAR>>'+m_qp
                mmensagem := mmensagem + m_qp+'***** Arquivo SACDUPR  e  SACCRED     A L T E R A R      *****'+m_qp
                mmensagem := mmensagem + '<< Nome: DESC para DESCONTO>>'
                atencao(mmensagem)
        ENDIF
        IF memp = 'X' .AND. m_cfg[2] = 'S'
                mmensagem := '***** Arquivo SACEMP     I N C L U I R     *****'+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp
                mmensagem := mmensagem + m_qp+'***** Arquivo SACEMP     A L T E R A R      *****'+m_qp
                mmensagem := mmensagem + '<< Nome: END para ENDERECO >>'
                atencao(mmensagem)
        ENDIF
        IF mforn = 'X' .AND. m_cfg[2] = 'S'
                mmensagem := '***** Arquivo SACFORN     I N C L U I R     *****'+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp
                mmensagem := mmensagem + m_qp+'>>>> SR_RECNO posicao = 36'+m_qp+m_qp
                mmensagem := mmensagem + m_qp+'***** Arquivo SACFORN     A L T E R A R      *****'+m_qp
                mmensagem := mmensagem + '<< Nome: CIDADE Tipo: VARCHAR(25)>>'+m_qp
                mmensagem := mmensagem + '<< Nome: EMAIL Tipo: VARCHAR(120)>>'+m_qp
                atencao(mmensagem)
        ENDIF
        IF mindiv = 'X' .AND. m_cfg[2] = 'S'
                mmensagem := '***** Arquivo SACINDIV *****'+m_qp
                mmensagem := mmensagem + '              << ALTERAR>>'+m_qp
                mmensagem := mmensagem + m_qp+'>>>> PRT_PED2 VARCHAR(40)'+m_qp+m_qp
                mmensagem := mmensagem + '<< Nome: PDV para TP_CARNE>> '+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp+m_qp
                mmensagem := mmensagem + m_qp+'>>>> PRT_ORC1 VARCHAR(40)'+m_qp
                mmensagem := mmensagem + m_qp+'>>>> PRT_ORC2 VARCHAR(40)'+m_qp
                mmensagem := mmensagem + m_qp+'>>>> PRT_REL  VARCHAR(40)'+m_qp
                mmensagem := mmensagem + m_qp+'>>>> PRT_DUP  VARCHAR(40)'+m_qp
                mmensagem := mmensagem + m_qp+'>>>> PRT_NF   VARCHAR(40)'+m_qp
                mmensagem := mmensagem + m_qp+'>>>> PRT_BOLE VARCHAR(40)'+m_qp
                mmensagem := mmensagem + '              << ALTERAR>>'+m_qp+m_qp
                mmensagem := mmensagem + m_qp+'>>>> SR_RECNO posicao = 46'+m_qp+m_qp
                atencao(mmensagem)
        ENDIF
        IF mmdfe = 'X' .AND. m_cfg[2] = 'S'
                mmensagem := '***** Arquivo SACmdfe *****'+m_qp
                atencao(mmensagem)
        ENDIF
        IF mlog = 'X' .AND. m_cfg[2] = 'S'
                mmensagem := '***** Arquivo SACLOG     I N C L U I R     *****'+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp
                mmensagem := mmensagem + '>>>> SR_RECNO posicao = 22'+m_qp+m_qp
                mmensagem := mmensagem + m_qp+'***** Arquivo SACLOG     A L T E R A R      *****'+m_qp
                mmensagem := mmensagem + '<< Nome: DOCUMENTO Tipo: VARCHAR(15)>>'+m_qp
                atencao(mmensagem)
        ENDIF
        IF mmerc = 'X'
                mmensagem :=             '***** Arquivo SACMERC  I N C L U I R    *****'+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp
                mmensagem := mmensagem + '>>>> SR_RECNO posicao = 112'+m_qp+m_qp
                mmensagem := mmensagem + m_qp+'***** Arquivo SACMERC     EXCLUIR        *****'+m_qp
                mmensagem := mmensagem + '            << Nome: PR_VENDA5>>'+m_qp+m_qp
                mmensagem := mmensagem + m_qp+'***** Arquivo SACMERC     A L T E R A R        *****'+m_qp
                mmensagem := mmensagem + '<< Nome: COD_BARR2 para DESCRI1 Tipo VARCHAR(50)>>'+m_qp
                mmensagem := mmensagem + '<< Nome: STAT_ITEM para IAT Tipo VARCHAR(1)>>'+m_qp
                mmensagem := mmensagem + '<< Nome: COD1 para IPPT VARCHAR(1)>>'+m_qp
                mmensagem := mmensagem + '<< Nome: SITTRIB para VARCHAR(4)>>'+m_qp
                mmensagem := mmensagem + '<< Nome: LOCAL para VARCHAR(8)>>'+m_qp
                mmensagem := mmensagem + '<< Nome: DOC_ENT para VARCHAR(12)>>'+m_qp
                mmensagem := mmensagem + '<< Nome: DOC_ENT_A para VARCHAR(12)>>'+m_qp
                mmensagem := mmensagem + '<< Nome: CHV_CRIPT para VARCHAR(350)>>'+m_qp+m_qp
                mmensagem := mmensagem + '<< Nome: COD_BARR3 para APP_IMAGEM Tipo VARCHAR(100)>>'+m_qp
                atencao(mmensagem)
        ENDIF

        IF mmov = 'X'
                mmensagem := '***** Arquivo SACMOV     I N C L U I R     *****'+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp+m_qp
                mmensagem := mmensagem + '>>>> SR_RECNO posicao = 96'+m_qp+m_qp
                mmensagem := mmensagem + m_qp+'***** Arquivo SACMOV     V E R I F I C A R     *****'+m_qp
                mmensagem := mmensagem + '<< VLR_ICM: decimal(15,2) - BASE_ICM: decimal(15,2) >>'+m_qp
                mmensagem := mmensagem + m_qp+'***** Arquivo SACMOV     A L T E R A R     *****'+m_qp
                mmensagem := mmensagem + '<< Nome: cid_cli Tipo: VARCHAR(25)>>'+m_qp
                mmensagem := mmensagem + '<< Nome: obs1 a obs6 Tipo: VARCHAR(60)>>'+m_qp
                mmensagem := mmensagem + '<< Nome: sittrib Tipo: VARCHAR(4)>>'+m_qp
                mmensagem := mmensagem + '<< Nome: documento Tipo: VARCHAR(12)>>'
                atencao(mmensagem)
        ENDIF
        IF mmovnt = 'X' .AND. m_cfg[2] = 'S'
                mmensagem := '***** Arquivo SACMOVNT     I N C L U I R     *****'+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp+m_qp
                mmensagem := mmensagem + '>>>> SR_RECNO posicao = 84'+m_qp+m_qp
                mmensagem := mmensagem + m_qp+'***** Arquivo SACMOVNT     A L T E R A R     *****'+m_qp
                mmensagem := mmensagem + 'COND_VEZES: varchar(3)'+m_qp+'FABRICA: varchar(40)'+m_qp+'CLIENTE: varchar(40)'+m_qp+'PRODUTO: varchar(40)'+m_qp+'VLR_ICM: DECIMAL(15,2)'+m_qp+'BASE_ICM: DECIMAL(15,2)'+m_qp
                mmensagem := mmensagem + 'Nome: obs1 a obs6 Tipo: VARCHAR(60)'+m_qp
                mmensagem := mmensagem + 'Nome: sittrib Tipo: VARCHAR(4)'+m_qp
                mmensagem := mmensagem + 'Nome: documento Tipo: VARCHAR(12)'
                atencao(mmensagem)
        ENDIF
        IF mncm = 'X' .AND. m_cfg[2] = 'S'
                mmensagem := '***** Arquivo SACNCM     I N C L U I R      *****'+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp
                mmensagem := mmensagem + '>>>> SR_RECNO posicao = 11'+m_qp+m_qp
                mmensagem := mmensagem + m_qp+'***** Arquivo SACNCM     A L T E R A R      *****'+m_qp
                mmensagem := mmensagem + '<< Nome: DESCRI Tipo: VARCHAR(100)>>'+m_qp
                atencao(mmensagem)
        ENDIF
        IF mobs = 'X' .AND. m_cfg[2] = 'S'
                mmensagem := '***** Arquivo SACOBS     I N C L U I R      *****'+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp
                atencao(mmensagem)
        ENDIF
        IF mop = 'X' .AND. m_cfg[2] = 'S'
                mmensagem := '***** Arquivo SACOP     I N C L U I R      *****'+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp
                mmensagem := mmensagem + '>>>> SR_RECNO posicao = 5'+m_qp
                atencao(mmensagem)
        ENDIF
        IF mos = 'X' .AND. m_cfg[2] = 'S'
                mmensagem := '***** Arquivo SACOSS     I N C L U I R      *****'+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp
                mmensagem := mmensagem + '>>>> SR_RECNO posicao = 75'+m_qp
                atencao(mmensagem)
        ENDIF
        IF mpede = 'X'
                mmensagem := '***** Arquivo SACPED_E     I N C L U I R      *****'+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp
                mmensagem := mmensagem + m_qp+'***** Arquivo SACPED_E     A L T E R A R      *****'+m_qp
                mmensagem := mmensagem + '<< Nome: FORNECE Tipo: VARCHAR(40)>>'+m_qp
                mmensagem := mmensagem + '<< Nome: FABRICA Tipo: VARCHAR(40)>>'
                atencao(mmensagem)
        ENDIF
        IF mpeds = 'X'
                mmensagem := '***** Arquivo SACPED_S e SACORCAM     I N C L U I R       *****'+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp
                mmensagem := mmensagem + m_qp+'>>>> SR_RECNO posicao = 111'+m_qp+m_qp
                mmensagem := mmensagem + m_qp+'***** Arquivo SACPED_S - SACORCAM   A L T E R A R  *****'+m_qp
                mmensagem := mmensagem + '<< Nome: PNUM_PED Tipo: VARCHAR(10)>>'+m_qp
                mmensagem := mmensagem + '<< Nome: PPLACA   Tipo: VARCHAR(15)>>'+m_qp
                mmensagem := mmensagem + '<< Nome: PCARRO   Tipo: VARCHAR(15)>>'+m_qp
                mmensagem := mmensagem + '<< Nome: PMODELO  Tipo: VARCHAR(15)>>'+m_qp
                mmensagem := mmensagem + '<< Nome: PKM      Tipo: VARCHAR(15)>>'+m_qp
                mmensagem := mmensagem + '<< Nome: POS      Tipo: VARCHAR(8)>>'+m_qp

                atencao(mmensagem)
        ENDIF
        IF mpped = 'X' .AND. m_cfg[2] = 'S'
                mmensagem := '***** Arquivo SACPPED     A L T E R A R       *****'+m_qp
                mmensagem := mmensagem + '<< Nome: << Nome: MODOPG Tipo: VARCHAR(74)>>'+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp
                mmensagem := mmensagem + m_qp+'>>>> SR_RECNO posicao = 39'+m_qp+m_qp
                atencao(mmensagem)
        ENDIF
        IF mpres = 'X'
                mmensagem := '***** Arquivo SACPRESEN     I N C L U I R       ** '+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp
                atencao(mmensagem)
        ENDIF

        //IF mr1 = 'X'
        //ENDIF
        IF mcrip = 'X' .AND. m_cfg[2] = 'S'
                op_tela(10,10,18,80,'Criptografando os Arquivos')
                DEVPOS(0,1);DEVOUT('Arquivo PRODUTOS...:')
                DEVPOS(1,1);DEVOUT('Arquivo R1.........:')
                DEVPOS(2,1);DEVOUT('Arquivo R2.........:')
                DEVPOS(3,1);DEVOUT('Arquivo R3.........:')
                DEVPOS(4,1);DEVOUT('Arquivo R4.........:')
                DEVPOS(5,1);DEVOUT('Arquivo R5.........:')
                DEVPOS(6,1);DEVOUT('Arquivo R6.........:')
                DEVPOS(7,1);DEVOUT('Arquivo R7.........:')
                m_set:={}
                sr_getconnection():exec("SELECT * FROM sacsetup",,.t.,@m_set)
                sr_getconnection():exec('COMMIT',,.f.)
                aret:={}
                sr_getconnection():exec('SELECT * FROM sacmerc ORDER BY merc',,.t.,@aret)
                sr_getconnection():exec('COMMIT',,.f.)
                IF LEN(aret) > 0
                        i:=0
                        FOR i = 1 TO LEN(aret)
                                DEVPOS(0,22);DEVOUT(aret[i,8]+'-'+aret[i,9])
                                 //mlinha := aret[i,2]+aret[i,8]+aret[i,9]+aret[i,14]+STRZERO((aret[i,56]*1000,13)+STRZERO(iat(aret[1,46])*100,14)+aret[1,68]
                                sr_getconnection():exec('UPDATE sacmerc SET chv_cript = '+sr_cdbvalue(criptografia(aret[i,2]+aret[i,8]+aret[i,9]+aret[i,14]+STRZERO(aret[i,56]*1000,13)+STRZERO(iat(aret[i,46])*100,14)+aret[i,68],'C'))+' WHERE cod_merc = '+sr_cdbvalue(aret[i,8]),,.F.)
                        NEXT
                ENDIF
                aret:={}
                sr_getconnection():exec('SELECT * FROM r1',,.t.,@aret)
                sr_getconnection():exec('COMMIT',,.f.)
                IF LEN(aret) > 0
                        i:=0
                        FOR i = 1 TO LEN(aret)
                                DEVPOS(1,22);DEVOUT(TRANSFORM(i,'99999'))
                                sr_getconnection():exec('UPDATE r1 SET chv_cript = '+sr_cdbvalue(criptografia(aret[i,1]+aret[i,2]+aret[i,3]+aret[i,4]+aret[i,5]+aret[i,6]+aret[i,7]+aret[i,8]+aret[i,9]+aret[i,10]+aret[i,11]+aret[i,12]+aret[i,13]+aret[i,14]+aret[i,15]+aret[i,16]+aret[i,17]+aret[i,18]+aret[i,19]+aret[i,20],'C'))+' WHERE sr_recno = '+sr_cdbvalue(aret[i,23]),,.F.)
                        NEXT
                ENDIF
                aret:={}
                sr_getconnection():exec('SELECT * FROM r2',,.t.,@aret)
                sr_getconnection():exec('COMMIT',,.f.)
                IF LEN(aret) > 0
                        i:=0
                        FOR i = 1 TO LEN(aret)
                                DEVPOS(2,22);DEVOUT(TRANSFORM(i,'99999'))
                                sr_getconnection():exec('UPDATE r2 SET chv_cript = '+sr_cdbvalue(criptografia(aret[i,1]+aret[i,2]+aret[i,3]+aret[i,4]+aret[i,5]+aret[i,6]+aret[i,7]+aret[i,8]+aret[i,9]+aret[i,10]+aret[i,11]+aret[i,12]+aret[i,13]+DTOC(aret[i,14]),'C'))+' WHERE sr_recno = '+sr_cdbvalue(aret[i,16]),,.F.)
                        NEXT
                ENDIF
                aret:={}
                sr_getconnection():exec('SELECT * FROM r3',,.t.,@aret)
                sr_getconnection():exec('COMMIT',,.f.)
                IF LEN(aret) > 0
                        i:=0
                        FOR i = 1 TO LEN(aret)
                                DEVPOS(3,22);DEVOUT(TRANSFORM(i,'99999'))
                                sr_getconnection():exec('UPDATE r3 SET chv_cript = '+sr_cdbvalue(criptografia(aret[i,1]+aret[i,2]+aret[i,3]+aret[i,4]+aret[i,5]+aret[i,6]+aret[i,7]+DTOC(aret[i,8]),'C'))+' WHERE sr_recno = '+sr_cdbvalue(aret[i,10]),,.F.)
                        NEXT
                ENDIF
                aret:={}
                sr_getconnection():exec('SELECT * FROM r4',,.t.,@aret)
                IF LEN(aret) > 0
                        i:=0
                        FOR i = 1 TO LEN(aret)
                                DEVPOS(4,22);DEVOUT(TRANSFORM(i,'99999'))
                                sr_getconnection():exec('UPDATE r4 SET chv_cript = '+sr_cdbvalue(criptografia(aret[i,1]+aret[i,2]+aret[i,3]+aret[i,4]+aret[i,5]+aret[i,6]+aret[i,7]+aret[i,8]+aret[i,9]+aret[i,10]+aret[i,11]+aret[i,12]+aret[i,13]+aret[i,14]+aret[i,15]+aret[i,16]+aret[i,17]+aret[i,18]+DTOC(aret[i,19]),'C'))+' WHERE sr_recno = '+sr_cdbvalue(aret[i,21]),,.F.)
                        NEXT
                ENDIF
                aret:={}
                sr_getconnection():exec('SELECT * FROM r5',,.t.,@aret)
                IF LEN(aret) > 0
                        i:=0
                        FOR i = 1 TO LEN(aret)
                                DEVPOS(5,22);DEVOUT(TRANSFORM(i,'99999'))
                                sr_getconnection():exec('UPDATE r5 SET chv_cript = '+sr_cdbvalue(criptografia(aret[i,1]+aret[i,2]+aret[i,3]+aret[i,4]+aret[i,5]+aret[i,6]+aret[i,7]+aret[i,8]+aret[i,9]+aret[i,10]+aret[i,11]+aret[i,12]+aret[i,13]+aret[i,14]+aret[i,15]+aret[i,16]+aret[i,17]+aret[i,18]+aret[i,19]+aret[i,20]+aret[i,21]+aret[i,22]+aret[i,23]+aret[i,24]+DTOC(aret[i,25]),'C'))+' WHERE sr_recno = '+sr_cdbvalue(aret[i,27]),,.F.)
                        NEXT
                ENDIF
                aret:={}
                sr_getconnection():exec('SELECT * FROM r6',,.t.,@aret)
                IF LEN(aret) > 0
                        i:=0
                        FOR i = 1 TO LEN(aret)
                                DEVPOS(6,22);DEVOUT(TRANSFORM(i,'99999'))
                                sr_getconnection():exec('UPDATE r6 SET chv_cript = '+sr_cdbvalue(criptografia(aret[i,1]+aret[i,2]+aret[i,3]+aret[i,4]+aret[i,5]+aret[i,6]+aret[i,7]+aret[i,8]+aret[i,9]+aret[i,10]+aret[i,11]+DTOC(aret[i,12]),'C'))+' WHERE sr_recno = '+sr_cdbvalue(aret[i,14]),,.F.)
                        NEXT
                ENDIF
                aret:={}
                sr_getconnection():exec('SELECT * FROM r7',,.t.,@aret)
                IF LEN(aret) > 0
                        i:=0
                        FOR i = 1 TO LEN(aret)
                                DEVPOS(7,22);DEVOUT(TRANSFORM(i,'99999'))
                                sr_getconnection():exec('UPDATE r7 SET chv_cript = '+sr_cdbvalue(criptografia(aret[i,1]+aret[i,2]+aret[i,3]+aret[i,4]+aret[i,5]+aret[i,6]+aret[i,7]+aret[i,8]+aret[i,9]+aret[i,10]+aret[i,11]+DTOC(aret[i,12]),'C'))+' WHERE sr_recno = '+sr_cdbvalue(aret[i,14]),,.F.)
                        NEXT
                ENDIF
                sr_getconnection():exec('COMMIT',,.F.)
                fecha_tela()
        ENDIF
        */
        IF mnota = 'X'
                aret:={}
                sr_getconnection():exec('SELECT MAX(sr_recno) FROM sacnota',,.t.,@aret)
                sr_getconnection():exec('COMMIT',,.f.)
                sr_getconnection():exec('delete from sacnota where sr_recno < '+sr_cdbvalue(aret[1,1]),,.F.)
                sr_getconnection():exec('COMMIT',,.F.)
                sr_getconnection():exec('UPDATE sacnota SET sr_recno = 1',,.F.)
                sr_getconnection():exec('UPDATE sacnota SET serie = '+sr_cdbvalue('1')+' WHERE serie IS NULL',,.F.)
                sr_getconnection():exec('COMMIT',,.F.)
                mmensagem := '***** Arquivo SACNOTA     I N C L U I R       ** '+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp
                mmensagem := mmensagem + '>>>> SR_RECNO posicao = 4'+m_qp
                atencao(mmensagem)

                aret:={}
                sr_getconnection():exec('SELECT MAX(sr_recno) FROM sacnotae',,.t.,@aret)
                sr_getconnection():exec('COMMIT',,.f.)
                sr_getconnection():exec('delete from sacnotae where sr_recno < '+sr_cdbvalue(aret[1,1]),,.F.)
                sr_getconnection():exec('COMMIT',,.F.)
                sr_getconnection():exec('UPDATE sacnotae SET sr_recno = 1',,.F.)
        ENDIF
        IF mroma = 'X' .AND. m_cfg[2] = 'S'
                mmensagem := '***** Arquivo SACROMA e SACPRODU     I N C L U I R       *****'+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp
                atencao(mmensagem)
        ENDIF
        IF msef = 'X' .AND. m_cfg[2] = 'S'
                mmensagem := '***** Arquivo SACSEF      I N C L U I R       *****'+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp
                mmensagem := mmensagem + '>>>> SR_RECNO posicao = 16'+m_qp
                atencao(mmensagem)
        ENDIF
        IF msetup = 'X' .AND. m_cfg[2] = 'S'
                mmensagem := '***** Arquivo SACSETUP     I N C L U I R       *****'+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp+m_qp
                mmensagem := mmensagem + m_qp+'>>>> SR_RECNO posicao = 177'+m_qp+m_qp
                mmensagem := mmensagem + 'Apagar o CONTEUDO do campo ROTINA'+m_qp
                mmensagem := mmensagem + '<< Nome: PORT_EMB para Nome:CAM_POCK - VCHAR(50) >>'+m_qp
                mmensagem := mmensagem + '<< Nome: SYSDATLM de VCHAR(12) para VCHAR(15) >>'+m_qp
                mmensagem := mmensagem + '<< Nome: NFE_R_P para PROMISSORIA VCHAR(1) >>'+m_qp
                mmensagem := mmensagem + '<< Nome: NOMENF para TP_CABE VCHAR(1) >>'+m_qp
                atencao(mmensagem)
        ENDIF
        IF mtabpg = 'X' .AND. m_cfg[2] = 'S'
                mmensagem := '***** Arquivo SACTABPG     I N C L U I R        *****'+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp
                atencao(mmensagem)
        ENDIF
        IF mtotnt = 'X' .AND. m_cfg[2] = 'S'
                mmensagem := '***** Arquivo SACTOTNT     I N C L U I R        *****'+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp
                mmensagem := mmensagem + '>>>> SR_RECNO posicao = 62'+m_qp+m_qp
                mmensagem := mmensagem + m_qp+'***** Arquivo SACTOTNT     A L T E R A R       *****'+m_qp
                mmensagem := mmensagem + '<< Nome: CLIENTE Tipo: VARCHAR(40)>>'+m_qp
                mmensagem := mmensagem + '<< Nome: CID_CLI Tipo: VARCHAR(25)>>'+m_qp
                mmensagem := mmensagem + '<< Nome: obs1 a obs20 Tipo: VARCHAR(60)>>'+m_qp
                mmensagem := mmensagem + '<< Nome: DOCUMENTO Tipo: VARCHAR(12)>>'
                atencao(mmensagem)
        ENDIF
        IF mtrans = 'X' .AND. m_cfg[2] = 'S'
                mmensagem := '***** Arquivo SACTRAN     A L T E R A R       *****'+m_qp
                mmensagem := mmensagem + '<< Nome: << Nome: CIDADE Tipo: VARCHAR(25)>>'
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp
                mmensagem := mmensagem + '>>>> SR_RECNO posicao = 28'+m_qp+m_qp
                atencao(mmensagem)
        ENDIF
        IF mtrm = 'X' .AND. m_cfg[2] = 'S'
                mmensagem := '***** Arquivo SACTRM     I N C L U I R   *****'+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp
                mmensagem := mmensagem + '>>>> SR_RECNO posicao = 9 '+m_qp
                atencao(mmensagem)
        ENDIF
        IF mtabl = 'X' .AND. m_cfg[2] = 'S'
                mmensagem := '***** Arquivo TABLOIDE     I N C L U I R        *****'+m_qp
                mmensagem := mmensagem + '              << VERIFICAR>>'+m_qp
                atencao(mmensagem)
        ENDIF
ENDIF

FCLOSE('saccfg.ini')
mArq        := FCREATE('saccfg.ini')
sLinhas     := '001 C Estacao               ='+m_cfg[1]+m_qp
sLinhas     := sLinhas + '002 C Tipo de Terminal      ='+m_cfg[2]+m_qp
sLinhas     := sLinhas + '003 C HTI                   = '+m_qp
sLinhas     := sLinhas + '004 C Caminho Banco Dados   ='+m_cfg[4]+m_qp
sLinhas     := sLinhas + '005 C Versao do Sistema     ='+mversao+m_qp
sLinhas     := sLinhas + '006 C Tipo de Tela          ='+m_cfg[6]+m_qp
sLinhas     := sLinhas + '007 C Codigo da Empresa     ='+m_cfg[7]
FWRITE( mArq, @sLinhas, LEN( sLinhas ) )
FCLOSE(mArq)
*/
SR_BEGINTRANSACTION()
TRY
sr_getconnection():exec("UPDATE sacsetup SET ver = "+sr_cdbvalue(mversao),,.f.)
sr_getconnection():exec("COMMIT",,.f.)
sr_committransaction()
CATCH e
SR_ENDTRANSACTION()
END
RETURN NIL
************************************ F I M *******************************************
* FUNCAO PARA ATUALIZAR OS TABELAS
***********************************
FUNCTION alt_tb
***************
IF mcam = 'X' .AND. m_cfg[2] = 'S'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE cam_dba ADD atu_cli VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE cam_dba ADD atu_prod VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE cam_dba ADD atu_forn VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE cam_dba ADD atu_sen VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE cam_dba ADD cam_bm VARCHAR(40)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE cam_dba ADD cons_dupr VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
IF minsopera = 'X' .AND. m_cfg[2] = 'S'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE insopera ADD SMENSAGEM VARCHAR(150)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE insopera ADD SAMBIENTE VARCHAR(5)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE insopera ADD DOC_APAGAR VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE insopera ADD ESTOQ_MIN VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE insopera ADD ESTOQ_MED DECIMAL(5,0)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE insopera ADD TERMINAL VARCHAR(15)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE insopera ADD DATA_ACESS DATE',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE insopera ADD HORA_ACESS VARCHAR(8)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE insopera ADD EMAIL VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE insopera ADD dat_aniv VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE insopera ADD ver_pocket VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE insopera ADD endereco VARCHAR(40)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE insopera ADD numero VARCHAR(6)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE insopera ADD complemento VARCHAR(6)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE insopera ADD bairro VARCHAR(20)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE insopera ADD cidade VARCHAR(25)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE insopera ADD uf VARCHAR(2)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE insopera ADD fone VARCHAR(10)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE insopera ADD cpf VARCHAR(11)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE insopera ADD rg VARCHAR(15)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE insopera ADD plug VARCHAR(12)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE insopera ADD preco_perc DECIMAL(15,2)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE insopera ADD desc_max DECIMAL(15,2)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE insopera ADD incl_app CHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
IF mass = 'X' .AND. m_cfg[2] = 'S'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE sacass ADD TIPO_ASS VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
IF mtbmer = 'X' .AND. m_cfg[2] = 'S'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE cnnt_pedido ADD STATUS_PED CHAR(12)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF

IF mban = 'X' .AND. m_cfg[2] = 'S'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE sacbanco ADD ACESS_ESCR VARCHAR(10)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacbanco ADD DV_CC VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacbanco ADD DV_AG VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacbanco ADD COD_CEDENTE VARCHAR(10)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacbanco ADD DIASPROT DECIMAL(3,0)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacbanco ADD LOCAL_PG VARCHAR(120)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacbanco ADD DESPESA DECIMAL(12,2)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacbanco ADD CARTEIRA VARCHAR(3)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
IF mcnnt = 'X'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE CNNT_ITENS_PEDIDO ADD valor_pedido DECIMAL(15,2)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE CNNT_ITENS_PEDIDO ADD desconto DECIMAL(12,2)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE CNNT_PEDIDO ADD total_pedido DECIMAL(12,2)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE CNNT_PEDIDO ADD tipo_operacao VARCHAR(12)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
                mensagem('INSOPERA')
                sr_getconnection():exec("UPDATE insopera SET plug = '' WHERE plug is null",,.f.)
                sr_getconnection():exec("UPDATE insopera SET svalor = 0 WHERE svalor is null",,.f.)
                sr_getconnection():exec("COMMIT",,.f.)
                mensagem('SACMERC')
                sr_getconnection():exec("UPDATE sacmerc SET descri1 = '' WHERE descri1 is null",,.f.)
                sr_getconnection():exec("UPDATE sacmerc SET gru_sub = '' WHERE gru_sub is null",,.f.)
                sr_getconnection():exec("UPDATE sacmerc SET saldo_mer = 0 WHERE saldo_mer is null",,.f.)
                sr_getconnection():exec("UPDATE sacmerc SET pr_venda = 0 WHERE pr_venda is null",,.f.)
                sr_getconnection():exec("UPDATE sacmerc SET desc_merc = 0 WHERE desc_merc is null",,.f.)
                sr_getconnection():exec("UPDATE sacmerc SET cod_barr = '' WHERE cod_barr is null",,.f.)
                sr_getconnection():exec("UPDATE sacmerc SET varejo = 0 WHERE varejo is null",,.f.)
                sr_getconnection():exec("COMMIT",,.f.)
                mensagem('SACCLI')
                sr_getconnection():exec("UPDATE saccli SET nome = '' WHERE nome is null",,.f.)
                sr_getconnection():exec("UPDATE saccli SET cgc = '' WHERE cgc is null",,.f.)
                sr_getconnection():exec("UPDATE saccli SET cpf = '' WHERE cpf is null",,.f.)
                sr_getconnection():exec("UPDATE saccli SET endereco = '' WHERE endereco is null",,.f.)
                sr_getconnection():exec("UPDATE saccli SET tel1     = '' WHERE tel1     is null",,.f.)
                sr_getconnection():exec("UPDATE saccli SET email    = '' WHERE email    is null",,.f.)
                sr_getconnection():exec("UPDATE saccli SET cidade   = '' WHERE cidade   is null",,.f.)
                sr_getconnection():exec("UPDATE saccli SET uf       = '' WHERE uf       is null",,.f.)
                sr_getconnection():exec("UPDATE saccli SET tipo     = '' WHERE tipo     is null",,.f.)
                sr_getconnection():exec("UPDATE saccli SET obs      = '' WHERE obs      is null",,.f.)
                sr_getconnection():exec("COMMIT",,.f.)
                mensagem('SACTABPG')
                sr_getconnection():exec("UPDATE sactabpg SET cond      = '' WHERE cond      is null",,.f.)
                sr_getconnection():exec("UPDATE sactabpg SET percent   = 0 WHERE percent      is null",,.f.)
                sr_getconnection():exec("COMMIT",,.f.)
                mensagem('SACDUPR')
                sr_getconnection():exec("UPDATE sacdupr SET pago   = '' WHERE pago      is null",,.f.)
                sr_getconnection():exec("COMMIT",,.f.)
ENDIF
IF mcaix = 'X'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE saccaixa ADD obs VARCHAR(40)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
IF mcart = 'X' .AND. m_cfg[2] = 'S'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE saccarta ADD tef VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
IF mcid = 'X' .AND. m_cfg[2] = 'S'
ENDIF
IF mcli = 'X'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE saccli ADD COD_PROFI VARCHAR(5)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE saccli ADD NUMERO VARCHAR(6)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE saccli ADD COMPLEMENTO VARCHAR(10)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE saccli ADD DATA_BLOQ DATE',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE saccli ADD OBS_BLOQ VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE saccli ADD ROTA1 VARCHAR(70)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE saccli DROP FOTO',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE saccli ADD email1 VARCHAR(70)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE saccli ADD email2 VARCHAR(70)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE saccli ADD email3 VARCHAR(70)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE saccli ADD lim_ant DECIMAL(10,2)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE saccli ADD promotor VARCHAR(3)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
IF mdupp = 'X' .AND. m_cfg[2] = 'S'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE sacdupp ADD data_so DATE',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacdupp ADD DAT_RECEB DATE',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacdupp ADD OPE_RECEB VARCHAR(3)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacdupp ADD DOC_TRAN VARCHAR(14)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacdupp ADD DAT_TRAN DATE',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
IF mdupr = 'X' .AND. m_cfg[2] = 'S'

        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE sacdupr ADD HORA_BX VARCHAR(8)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacdupr ADD COM_SEM VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacdupr ADD TIPO_PG VARCHAR(20)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacdupr ADD PARCELA DECIMAL(3,0)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacdupr ADD COD_PG VARCHAR(3)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END


                TRY
                        sr_getconnection():exec('ALTER TABLE saccred ADD HORA_BX VARCHAR(8)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE saccred ADD COM_SEM VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
*/
ENDIF
IF memp = 'X' .AND. m_cfg[2] = 'S'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE sacemp ADD cam_db VARCHAR(30)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
IF mforn = 'X' .AND. m_cfg[2] = 'S'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE sacforn ADD pocket VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacforn ADD fantasia VARCHAR(40)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
IF mlog = 'X' .AND. m_cfg[2] = 'S'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE saclog ADD TERMINAL VARCHAR(15)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
IF mmerc = 'X'
        sr_begintransaction()
        TRY
                sr_getconnection():exec('ALTER TABLE sacmerc ADD pocket VARCHAR(1)',,.f.)
                sr_committransaction()
        CATCH E
                tracelog(valtoprg())
                sr_COMMITtransaction()
        END
        TRY
                sr_getconnection():exec('ALTER TABLE sacmerc ADD descri VARCHAR(50)',,.f.)
                sr_committransaction()
        CATCH E
                tracelog(valtoprg())
                sr_COMMITtransaction()
        END
        TRY
                sr_getconnection():exec('ALTER TABLE sacmerc ADD pr_venda2 DECIMAL(12,2)',,.f.)
                sr_committransaction()
        CATCH E
                tracelog(valtoprg())
                sr_COMMITtransaction()
        END
        TRY
                sr_getconnection():exec('ALTER TABLE sacmerc ADD pr_venda3 DECIMAL(12,2)',,.f.)
                sr_committransaction()
        CATCH E
                tracelog(valtoprg())
                sr_COMMITtransaction()
        END
        TRY
                sr_getconnection():exec('ALTER TABLE sacmerc ADD pr_venda4 DECIMAL(12,2)',,.f.)
                sr_committransaction()
        CATCH E
                tracelog(valtoprg())
                sr_COMMITtransaction()
        END
        TRY
                sr_getconnection():exec('ALTER TABLE sacmerc ADD pr_venda5 DECIMAL(12,2)',,.f.)
                sr_committransaction()
        CATCH E
                tracelog(valtoprg())
                sr_COMMITtransaction()
        END
        TRY
                sr_getconnection():exec('ALTER TABLE sacmerc ADD sld_neg VARCHAR(1)',,.f.)
                sr_committransaction()
        CATCH E
                tracelog(valtoprg())
                sr_COMMITtransaction()
        END
        TRY
                sr_getconnection():exec('ALTER TABLE sacmerc ADD descont VARCHAR(1)',,.f.)
                sr_committransaction()
        CATCH E
                tracelog(valtoprg())
                sr_COMMITtransaction()
        END
        TRY
                sr_getconnection():exec('ALTER TABLE sacmerc ADD cst_pis VARCHAR(2)',,.f.)
                sr_committransaction()
        CATCH E
                tracelog(valtoprg())
                sr_COMMITtransaction()
        END
        TRY
                sr_getconnection():exec('ALTER TABLE sacmerc ADD cst_conf VARCHAR(2)',,.f.)
                sr_committransaction()
        CATCH E
                tracelog(valtoprg())
                sr_COMMITtransaction()
        END
        TRY
                sr_getconnection():exec('ALTER TABLE sacmerc ADD chv_cript VARCHAR(256)',,.f.)
                sr_committransaction()
        CATCH E
                tracelog(valtoprg())
                sr_COMMITtransaction()
        END
        TRY
                sr_getconnection():exec('ALTER TABLE sacmerc ADD cfop_fora VARCHAR(5)',,.f.)
                sr_committransaction()
        CATCH E
                tracelog(valtoprg())
                sr_COMMITtransaction()
        END
        TRY
                sr_getconnection():exec('ALTER TABLE sacmerc ADD cfop_dent VARCHAR(5)',,.f.)
                sr_committransaction()
        CATCH E
                tracelog(valtoprg())
                sr_COMMITtransaction()
        END
        TRY
                sr_getconnection():exec('ALTER TABLE sacmerc ADD pis DECIMAL(7,2)',,.f.)
                sr_committransaction()
        CATCH E
                tracelog(valtoprg())
                sr_COMMITtransaction()
        END
        TRY
                sr_getconnection():exec('ALTER TABLE sacmerc ADD confis DECIMAL(7,2)',,.f.)
                sr_committransaction()
        CATCH E
                tracelog(valtoprg())
                sr_COMMITtransaction()
        END
        TRY
                sr_getconnection():exec('ALTER TABLE sacmerc ADD cest CHAR(7)',,.f.)
                sr_committransaction()
        CATCH E
                tracelog(valtoprg())
                sr_COMMITtransaction()
        END
        TRY
                sr_getconnection():exec('ALTER TABLE sacmerc ADD codigo_smart INTEGER',,.f.)
                sr_committransaction()
        CATCH E
                tracelog(valtoprg())
                sr_COMMITtransaction()
        END
        sr_endtransaction()
ENDIF

IF mmov = 'X'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE sacmov ADD DEVOLUCAO VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacmov ADD COD_PRESENTE VARCHAR(5)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacmov ADD NORM_ELE VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacmov ADD CONVIDADO VARCHAR(30)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacmov ADD HORA_MOV VARCHAR(8)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacmov ADD PROMOTOR VARCHAR(3)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
IF mmovnt = 'X' .AND. m_cfg[2] = 'S'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE sacmovnt ADD NORM_ELE VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacmovnt ADD HORA_MOV VARCHAR(8)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
IF mncm = 'X' .AND. m_cfg[2] = 'S'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE sacncm ADD EX VARCHAR(2)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacncm ADD TABELA VARCHAR(2)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacncm ADD ALIQNAC DECIMAL(7,2)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacncm ADD ALIQIMP DECIMAL(7,2)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacncm ADD CEST CHAR(7)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
IF mobs = 'X' .AND. m_cfg[2] = 'S'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE sacobs ADD COD_OBS VARCHAR(2)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
IF mos = 'X' .AND. m_cfg[2] = 'S'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE sacoss ADD TIPO_OS VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacoss ADD oper_bx VARCHAR(3)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacoss ADD conclu1 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacoss ADD conclu2 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacoss ADD conclu3 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacoss ADD hist1 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacoss ADD hist2 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacoss ADD hist3 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacoss ADD hist4 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacoss ADD hist5 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacoss ADD hist6 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacoss ADD hist7 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacoss ADD hist8 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacoss ADD hist9 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacoss ADD hist10 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacoss ADD hist11 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacoss ADD hist12 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacoss ADD hist13 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacoss ADD hist14 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacoss ADD hist15 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacoss ADD hist16 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacoss ADD hist17 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacoss ADD hist18 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacoss ADD hist19 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacoss ADD hist20 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
IF mpede = 'X'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE sacped_e ADD TEL_TRANSP VARCHAR(14)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacped_e ADD OBS VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacped_e ADD REF VARCHAR(13)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacped_e ADD DATA_CHEGA DATE',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacped_e ADD OBS2 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacped_e ADD OBS3 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacped_e ADD OBS4 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacped_e ADD OBS5 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacped_e ADD cod_oper VARCHAR(3)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacped_e ADD cond_pag VARCHAR(8)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacped_e ADD forma_pag VARCHAR(15)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
IF mpeds = 'X'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE sacped_s ADD COD_PRES VARCHAR(5)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacped_s ADD PFECHA VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacped_s ADD PD_ENTREGA DATE',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacped_s ADD DATA_SO DATE',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacped_s ADD PNUM_NF VARCHAR(10)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacped_s ADD COMPRADOR VARCHAR(30)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacped_s ADD CONVIDADO VARCHAR(30)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacped_s ADD TIPO_PED DECIMAL(1,0)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacped_s ADD QTD_ORIG DECIMAL(12,3)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacped_s ADD NUMPED_ORIG VARCHAR(6)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacped_s ADD qtd_via VARCHAR(2)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacped_s ADD obs_visita VARCHAR(200)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacped_s ADD pobs5 VARCHAR(40)',,.f.)
                        sr_getconnection():exec('ALTER TABLE sacped_s ADD pobs6 VARCHAR(40)',,.f.)
                        sr_getconnection():exec('ALTER TABLE sacped_s ADD pobs7 VARCHAR(40)',,.f.)
                        sr_getconnection():exec('ALTER TABLE sacped_s ADD pobs8 VARCHAR(40)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacped_s ADD tipo_venda VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacped_s ADD PROMOTOR VARCHAR(3)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacped_s ADD data_app DATE',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()

        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE sacorcam ADD COD_PRES VARCHAR(5)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacorcam ADD PFECHA VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacorcam ADD PD_ENTREGA DATE',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacorcam ADD DATA_SO DATE',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacorcam ADD PNUM_NF VARCHAR(10)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacorcam ADD COMPRADOR VARCHAR(30)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacorcam ADD CONVIDADO VARCHAR(30)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacorcam ADD TIPO_PED DECIMAL(1,0)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacorcam ADD QTD_ORIG DECIMAL(12,3)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacorcam ADD NUMPED_ORIG VARCHAR(6)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacorcam ADD qtd_via VARCHAR(2)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacorcam ADD obs_visita VARCHAR(200)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacorcam ADD pobs5 VARCHAR(40)',,.f.)
                        sr_getconnection():exec('ALTER TABLE sacorcam ADD pobs6 VARCHAR(40)',,.f.)
                        sr_getconnection():exec('ALTER TABLE sacorcam ADD pobs7 VARCHAR(40)',,.f.)
                        sr_getconnection():exec('ALTER TABLE sacorcam ADD pobs8 VARCHAR(40)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacorcam ADD tipo_venda VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacorcam ADD PROMOTOR VARCHAR(3)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END

                TRY
                        sr_getconnection():exec('ALTER TABLE sacorcam ADD data_app DATE',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
IF mpres = 'X'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE sacpresen ADD VALOR DECIMAL(15,3)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacpresen ADD DATA_CAS DATE',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacpresen ADD EXCLUIDO DATE',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacpresen ADD PRIORIDADE VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
IF mr1 = 'X'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE R1 ADD INSC_ESTDESEN VARCHAR(14)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF

IF mnota = 'X'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE sacnota ADD serie VARCHAR(3)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
IF mroma = 'X' .AND. m_cfg[2] = 'S'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE sacroma ADD OBS1 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacroma ADD OBS2 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacroma ADD OBS3 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacroma ADD OBS4 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacroma ADD OBS5 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END


                TRY
                        sr_getconnection():exec('ALTER TABLE sacprodu ADD OBS1 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacprodu ADD OBS2 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacprodu ADD OBS3 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacprodu ADD OBS4 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacprodu ADD OBS5 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
IF msef = 'X' .AND. m_cfg[2] = 'S'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsef ADD ENDERECO VARCHAR(45)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsef ADD NUMERO VARCHAR(10)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsef ADD COMPLEMENTO VARCHAR(20)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsef ADD BAIRRO VARCHAR(20)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsef ADD CIDADE VARCHAR(25)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsef ADD UF VARCHAR(2)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsef ADD CEP VARCHAR(9)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF

IF msetup = 'X' .AND. m_cfg[2] = 'S'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD QTDMAXPR DECIMAL(15,2)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD VLRMAXPR DECIMAL(15,2)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD COM_SEM VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD INSC_MUN VARCHAR(14)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD CNAE VARCHAR(14)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD TIPO_CLI VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD BALANCA VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD NUMERO VARCHAR(6)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD COMPLEMENTO VARCHAR(10)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD QTD_PED_EXP DECIMAL(5,0)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD QTD_ITEM_EXP DECIMAL(5,0)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD QTD_PESO_EXP DECIMAL(12,3)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD HOST_EMAIL VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD PORTA_EMAIL VARCHAR(5)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD LOGIN_EMAIL VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD SENHA_EMAIL VARCHAR(10)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD MINRETPALM DECIMAL(6,0)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD DIAATUPALM DECIMAL(6,0)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD TPCODSEF VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD tip_bole VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END

                TRY
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD tp_cod_sef VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END

                TRY
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD ord_ped VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD from_email VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD qtd_trm VARCHAR(6)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD tipo_balanca VARCHAR(15)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD COD_ACESS VARCHAR(20)',,.f.)
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD QTD__BALANCA DECIMAL(1,0)',,.f.)
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD ROD_ORC1 VARCHAR(60)',,.f.)
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD ROD_ORC2 VARCHAR(60)',,.f.)
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD ROD_ORC3 VARCHAR(60)',,.f.)
                        sr_getconnection():exec('ALTER TABLE sacsetup ADD ROD_ORC4 VARCHAR(60)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
*/
IF mtabpg = 'X' .AND. m_cfg[2] = 'S'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE sactabpg ADD pocket VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sactabpg ADD PRECO VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
IF mindiv = 'X' .AND. m_cfg[2] = 'S'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE sacindiv ADD COD_ECF VARCHAR(6)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacindiv ADD MARCA_IMP VARCHAR(12)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacindiv ADD TAM_PAGINA VARCHAR(2)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacindiv ADD GAVETA VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacindiv ADD tp_carne VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacindiv ADD ger_app VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
IF mindiv = 'X' .AND. m_cfg[2] = 'S'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE sacindiv ADD COD_ECF VARCHAR(6)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacindiv ADD MARCA_IMP VARCHAR(12)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacindiv ADD TAM_PAGINA VARCHAR(2)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacindiv ADD GAVETA VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacindiv ADD tp_carne VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sacindiv ADD ger_app VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
IF mmdfe = 'X' .AND. m_cfg[2] = 'S'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE sacmdfe ADD encerrou VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
IF mtrans = 'X' .AND. m_cfg[2] = 'S'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE sactran ADD antt VARCHAR(12)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sactran ADD apolice VARCHAR(12)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
                TRY
                        sr_getconnection():exec('ALTER TABLE sactran ADD uf_placa VARCHAR(2)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
IF mtrm = 'X' .AND. m_cfg[2] = 'S'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE sactrm ADD hd_serial VARCHAR(10)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
IF mtabl = 'X' .AND. m_cfg[2] = 'S'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE tabloide ADD COD_BARR VARCHAR(14)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
IF mop = 'X' .AND. m_cfg[2] = 'S'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE sacop ADD tipo VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
IF mcst= 'X' .AND. m_cfg[2] = 'S'
        sr_begintransaction()
                TRY
                        sr_getconnection():exec('ALTER TABLE saccst ADD simples VARCHAR(1)',,.f.)
                        sr_committransaction()
                CATCH E
                        tracelog(valtoprg())
                        sr_COMMITtransaction()
                END
        sr_endtransaction()
ENDIF
sr_getconnection():exec('COMMIT',,.f.)
RETURN NIL