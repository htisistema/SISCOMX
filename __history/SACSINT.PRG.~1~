***********************
* Relatorio do SINTEGRA
***********************
FUNCTION sacsint
****************
LOCAL MPRG:='SACSINT',mtitulo:='EMISSAO DO ARQUIVO DO SINTEGRA',;
      tela,lba,cba,opcao,mdata1,mdata2,;
      mcont_10:=0,mcont_11:=0,mcont_50:=0,mcont_51:=0,mcont_53:=0,mcont_54:=0,;
      mcont_90:=0,mcont_ger:=0,mcont_75:=0,mcont_60 :=0,;
      mponto,mdoc,ment_sai,mitem := 0,mop_nota:='G',m_produto:={},m_prodaux:={}

PRIVATE mtipo_imp,mimp_tipo:=0,marq:=SPACE(35),mnome_arq:='',marq:=''

IF ! ver_nivel(mprg,mtitulo,'15',nivel_acess,,'AMBIE')
        RETURN NIL
ENDIF

mtraco := REPLI('=',132)
SET CENTURY ON
marq := 'C:\'+CURDIR()+'\'+mpaf_ecf+STRTRAN(DTOC(DATE()),'/','')+STRTRAN(TIME(),':','')+'.TXT'+SPACE(30)
SET CENTURY OFF

lba := 20
cba := 70
op_tela(0,0,lba,cba,mtitulo)
*----------------------------------------------------------------------------
CLOSE ALL
IF ! AbriArq('sacop','op');RETURN NIL;ENDIF
IF ! AbriArq('saccli','cli');RETURN NIL;ENDIF
IF ! AbriArq('sacforn','forn');RETURN NIL;ENDIF
IF ! AbriArq('sacmov','mov');RETURN NIL;ENDIF
IF ! AbriArq('sacmovnt','movnt');RETURN NIL;ENDIF
IF ! AbriArq('sacmerc','merc');RETURN NIL;ENDIF
IF ! AbriArq('sactotnt','totnt');RETURN NIL;ENDIF
*----------------------------------------------------------------------------
SET CENTURY ON
WHILE .T.
        mcont_10:=0;mcont_11:=0;mcont_50:=0;mcont_51:=0;mcont_53:=0;mcont_54:=0
        mcont_90:=0;mcont_ger:=0;mcont_75:=0
********* VARIAVEIS DE IMPRESSAO *******************
        mtipo_imp := m_indiv[1,18]
****************************************************
        mdata1 := mdata_sis - 30
        mdata2 := mdata_sis
        m_produto := {}
        m_prodaux := {}
        mensagem('Preencha os Campos - <ESC>p/Abandonar')
        DEVPOS(1,+2);DEVOUT('Data Inicial...:')
        DEVPOS(2,+2);DEVOUT('Data Final.....:')
        DEVPOS(4,+2);DEVOUT('Caminho Arquivo:')
        setcor(3)
        DEVPOS(6,+2);DEVOUT('Registro 50..............:')
        DEVPOS(7,+2);DEVOUT('Registro 51..............:')
        DEVPOS(8,+2);DEVOUT('Registro 53..............:')
        DEVPOS(9,+2);DEVOUT('Registro 54..............:')
        DEVPOS(10,+2);DEVOUT('Registro 70..............:')
        DEVPOS(11,+2);DEVOUT('Registro 75..............:')
        setcor(1)

        @ 1,+19 GET mdata1 PICT '99/99/99' VALID IF(EMPTY(mdata1),.F.,.T.)
        @ 2,+19 GET mdata2 PICT '99/99/99' VALID IF(mdata2 < mdata1 ,.F.,.T.)
        @ 4,+19 GET marq PICT '@S40@'
        READ
        IF LASTKEY() = 27
                CLOSE ALL
                SET CENTURY OFF
                wvw_lclosewindow()
                RETURN NIL
        ENDIF
        IF op_simnao('S','Confirma o periodo:') = 'N'
                LOOP
        ENDIF
/*
        m_totnt := {}
        cComm := "SELECT * FROM sactotnt WHERE emissao >= "+sr_cdbvalue(mdata1)
        ccomm := ccomm +" AND emissao <= "+sr_cdbvalue(mdata2)
        ccomm := ccomm +" AND tip_sef IS NULL AND documento LIKE 'NF%'"
        ccomm := ccomm + " ORDER BY emissao,documento,cod_nota,cod_nat"
        sr_getconnection():exec(ccomm,,.t.,@m_totnt)
        IF LEN(m_totnt) = 0
                atencao('Nao existe movimento neste periodo !!!')
                LOOP
        ENDIF
*/
        SET DEVI TO PRINT
        SET PRINT ON
        SET PRINT TO (marq)
        SETPRC(00,00)
        mensagem('Campos: 10')
        DEVPOS(00,00);DEVOUT('10')
        DEVPOS(00,02);DEVOUT(SUBSTR(mcgc_firm,1,2)+SUBSTR(mcgc_firm,4,3)+SUBSTR(mcgc_firm,8,3)+SUBSTR(mcgc_firm,12,4)+SUBSTR(mcgc_firm,17,2))
        DEVPOS(00,16);DEVOUT(LEFT(minsc_firm,14))
        DEVPOS(00,30);DEVOUT(LEFT(m_set[1,129],35))
        DEVPOS(00,65);DEVOUT(m_set[1,133])
        DEVPOS(00,95);DEVOUT(m_set[1,19])
        DEVPOS(00,97);DEVOUT(STRZERO(VAL(mfone_firm),10))
        DEVPOS(00,107);DEVOUT(SUBSTR(DTOC(mdata1),7)+SUBSTR(DTOC(mdata1),4,2)+SUBSTR(DTOC(mdata1),1,2))
        DEVPOS(00,115);DEVOUT(SUBSTR(DTOC(mdata2),7)+SUBSTR(DTOC(mdata2),4,2)+SUBSTR(DTOC(mdata2),1,2))
        DEVPOS(00,123);DEVOUT('3')
        DEVPOS(00,124);DEVOUT('3')
        DEVPOS(00,125);DEVOUT('1')
        mcont_10 ++
        mcont_ger ++
        DEVPOS(01,00);DEVOUT('11')
        DEVPOS(01,02);DEVOUT(m_set[1,139])
        DEVPOS(01,36);DEVOUT(m_set[1,140])
        DEVPOS(01,41);DEVOUT(m_set[1,141])
        DEVPOS(01,63);DEVOUT(m_set[1,142])
        DEVPOS(01,78);DEVOUT(m_set[1,143])
        DEVPOS(01,86);DEVOUT(m_set[1,144])
        DEVPOS(01,114);DEVOUT(STRZERO(VAL(m_set[1,145]),12))
        mcont_11 ++
        mcont_ger ++
        IF mop_nota = 'S' .OR. mop_nota = 'G'
                m_totnt := {}
                cComm := "SELECT * FROM sactotnt WHERE emissao >= "+sr_cdbvalue(mdata1)
                ccomm := ccomm +" AND emissao <= "+sr_cdbvalue(mdata2)
                ccomm := ccomm +" AND ent_sai ='S' AND tip_sef IS NULL AND documento LIKE 'NF%'"
                ccomm := ccomm + " ORDER BY emissao,documento,cod_nota,cod_nat"
                sr_getconnection():exec(ccomm,,.t.,@m_totnt)
                IF LEN(m_totnt) > 0
                        i := 0
                        FOR i = 1 TO LEN(m_totnt)
                                prog_imp(i)
                                mcgc_cons := IF(! EMPTY(m_totnt[i,17]),m_totnt[i,17],m_totnt[i,18])
                                m_movnt := {}
                                cComm := "SELECT * FROM sacmovnt WHERE data_s_e >= "+sr_cdbvalue(mdata1)
                                ccomm := ccomm +" AND data_s_e <= "+sr_cdbvalue(mdata2)
                                ccomm := ccomm +" AND ent_sai ='S' AND documento = "+sr_cdbvalue(m_totnt[i,5])
                                ccomm := ccomm + " ORDER BY emissao,documento,cod_nota,cod_nat"
                                sr_getconnection():exec(ccomm,,.t.,@m_movnt)
                                IF LEN(m_movnt) = 0
                                        LOOP
                                ENDIF                           
                                mdocumento := m_movnt[1,4]
                                mtot_nota := mtot_base := mtot_icm  := mtot_ipi  := y := 0
                                y := 0
                                FOR y = 1 TO LEN(m_movnt)
                                        prog_imp(y)
                                        IF m_movnt[y,65] = '6.109'
                                                mtot_nota := mtot_nota + iat(((m_movnt[y,19]*m_movnt[y,22])+m_movnt[y,54])-m_movnt[y,50],2)
                                        ELSE
                                                mtot_nota := mtot_nota + iat(((m_movnt[y,19]*m_movnt[y,22])+m_movnt[y,54]),2)
                                        ENDIF
                                        mbase := 0
                                        IF (m_movnt[y,19]*m_movnt[y,22])*(m_movnt[y,38]/100) > 0
                                                mtot_base := mtot_base + iat((m_movnt[y,19]*m_movnt[y,22]),2)
                                                mbase := iat((m_movnt[y,19]*m_movnt[y,22]),2)
                                        ENDIF
                                        IF EMPTY(m_totnt[i,16])
                                                mtot_base := mtot_base + m_movnt[y,54]
                                                mbase := mbase + m_movnt[y,54]
                                        ENDIF
                                        mtot_icm := mtot_icm + iat(mbase*(m_movnt[y,38]/100),2)
                                NEXT
                                y := 0
                                FOR y = 1 TO LEN(m_movnt)
                                        prog_imp(y)
                                        micm := m_movnt[y,38]
                                        mcod_cli := m_movnt[y,31]
                                        mvl_nota:= mvl_base:= mvl_icm := mvl_ipi := 0
                                        mcod_nat := m_movnt[y,65]
                                        WHILE m_movnt[y,38] = micm .AND. mdocumento = m_movnt[y,4]
                                                mbase := 0
                                                IF m_movnt[y,65] = '6.109'
                                                        mvl_nota := mvl_nota + iat(((m_movnt[y,19]*m_movnt[y,22])+m_movnt[y,54])-m_movnt[y,50],2)
                                                ELSE
                                                        mvl_nota := mvl_nota + iat(((m_movnt[y,19]*m_movnt[y,22])+m_movnt[y,54]),2)
                                                ENDIF
                                                IF (m_movnt[y,19]*m_movnt[y,22])*(m_movnt[y,38]/100) > 0
                                                        mvl_base := mvl_base + iat((m_movnt[y,19]*m_movnt[y,22]),2)
                                                        mbase := iat((m_movnt[y,19]*m_movnt[y,22]),2)
                                                ENDIF
                                                IF EMPTY(m_totnt[i,16])
                                                        mvl_base := mvl_base + m_movnt[y,54]
                                                        mbase := mbase + m_movnt[y,54]
                                                ENDIF
                                                mvl_icm := mvl_icm + iat(mbase*(m_movnt[y,38]/100),2)
                                                mvl_ipi := mvl_ipi + m_movnt[y,54]
                                                y++
                                                IF y > LEN(m_movnt)
                                                        EXIT
                                                ENDIF
                                        ENDDO
                                        y--
                                        mcont_50 ++
                                        mcont_ger ++
                                        SETPOS(6,+29);DISPOUT(TRANSFORM(mcont_50,'999,999,999'))
                                        DEVPOS(PROW()+1,00);DEVOUT('50')
                                        IF ! EMPTY(m_totnt[i,17])
                                                DEVPOS(PROW(),02);DEVOUT(m_totnt[i,17])
                                        ELSE
                                                DEVPOS(PROW(),02);DEVOUT(STRZERO(VAL(m_totnt[i,18]),14))
                                        ENDIF
                                        IF EMPTY(m_totnt[i,16])
                                                DEVPOS(PROW(),16);DEVOUT('ISENTO')
                                        ELSE            
                                                DEVPOS(PROW(),16);DEVOUT(m_totnt[i,16])
                                        ENDIF
                                        DEVPOS(PROW(),30);DEVOUT(SUBSTR(DTOC(m_totnt[i,10]),7)+SUBSTR(DTOC(m_totnt[i,10]),4,2)+SUBSTR(DTOC(m_totnt[i,10]),1,2))
                                        DEVPOS(PROW(),38);DEVOUT(m_totnt[i,15])
                                        DEVPOS(PROW(),40);DEVOUT('01')
                                        DEVPOS(PROW(),42);DEVOUT(SUBSTR(m_totnt[i,6],1,3))
                                        DEVPOS(PROW(),45);DEVOUT(STRZERO(VAL(SUBSTR(m_totnt[i,5],3)),6))
                                        DEVPOS(PROW(),51);DEVOUT(SUBSTR(mcod_nat,1,1)+SUBSTR(mcod_nat,3))

                                        DEVPOS(PROW(),55);DEVOUT('P')
                                        DEVPOS(PROW(),56);DEVOUT(SUBSTR(STRZERO(mvl_nota,14,2),1,11)+SUBSTR(STRZERO(mvl_nota,14,2),13))
                                        DEVPOS(PROW(),69);DEVOUT(SUBSTR(STRZERO(mvl_base,14,2),1,11)+SUBSTR(STRZERO(mvl_base,14,2),13))
                                        DEVPOS(PROW(),82);DEVOUT(SUBSTR(STRZERO(mvl_icm,14,2),1,11)+SUBSTR(STRZERO(mvl_icm,14,2),13))
                                        DEVPOS(PROW(),95);DEVOUT(STRZERO(0,13))
                                        DEVPOS(PROW(),108);DEVOUT(STRZERO(0,13))
                                        DEVPOS(PROW(),121);DEVOUT(SUBSTR(STRZERO(micm,5,2),1,2)+SUBSTR(STRZERO(micm,5,2),4))
                                        IF m_totnt[i,37] = 'C'
                                                DEVPOS(PROW(),125);DEVOUT('S')
                                        ELSE
                                                DEVPOS(PROW(),125);DEVOUT('N')
                                        ENDIF
                                NEXT
                        NEXT
                ENDIF
        ENDIF
        IF mop_nota = 'E' .OR. mop_nota = 'G'
                m_totnt := {}
                cComm := "SELECT * FROM sactotnt WHERE emissao >= "+sr_cdbvalue(mdata1)
                ccomm := ccomm +" AND emissao <= "+sr_cdbvalue(mdata2)
                ccomm := ccomm +" AND ent_sai ='E' AND tip_sef IS NULL AND documento LIKE 'NF%'"
                ccomm := ccomm + " ORDER BY emissao,documento,cod_nota,cod_nat"
                sr_getconnection():exec(ccomm,,.t.,@m_totnt)
                IF LEN(m_totnt) > 0
                        i := 0
                        FOR i = 1 TO LEN(m_totnt)
                                prog_imp(i)
                                mcgc_cons := IF(! EMPTY(m_totnt[i,17]),m_totnt[i,17],m_totnt[i,18])
                                mdocumento := m_totnt[i,5]+SPACE(2)
                                m_mov := {}
                                cComm := "SELECT * FROM sacmov WHERE data_s_e >= "+sr_cdbvalue(m_totnt[i,10])
                                ccomm := ccomm +" AND data_s_e <= "+sr_cdbvalue(m_totnt[i,10])
                                ccomm := ccomm +" AND ent_sai ='E' AND documento = "+sr_cdbvalue(m_totnt[i,5])
                                ccomm := ccomm +" AND cod_cli = "+sr_cdbvalue(m_totnt[i,12])
                                ccomm := ccomm + " ORDER BY emissao,documento,cod_nota,cod_nat"
                                sr_getconnection():exec(ccomm,,.t.,@m_mov)
                                IF LEN(m_mov) = 0
                                        LOOP
                                ENDIF                           
                                mcod_cli := m_mov[1,40]
                                mtot_nota := mtot_base := mtot_icm  := mtot_ipi  := y := 0
                                y := 0
                                FOR y = 1 TO LEN(m_mov)
                                        prog_imp(y)
                                        mtot_nota := mtot_nota + iat(((m_mov[y,19]*m_mov[y,25])+m_mov[y,62]),2)
                                        IF m_mov[y,43] > 0
                                                mtot_base := mtot_base + iat((m_mov[y,19]*m_mov[y,25]),2)
                                        ENDIF
                                        mtot_icm := mtot_icm + m_mov[y,43]
                                        mtot_ipi := mtot_ipi + m_mov[y,62]
                                        IF ASCAN(m_produto,m_movnt[y,11])=0
                                                AADD(m_produto,m_movnt[y,11])
                                        ENDIF
                                NEXT
                                memi_doc := m_totnt[i,10]
                                micm := m_mov[1,42]
                                y := 0
                                FOR y = 1 TO LEN(m_mov)
                                        prog_imp(y)
                                        micm := m_mov[y,42]
                                        mcod_cli := m_mov[y,40]
                                        mvl_nota:= mvl_base:= mvl_icm := mvl_ipi := 0
                                        WHILE m_mov[y,42] = micm .AND. mdocumento = m_mov[y,2] .AND. mcod_cli = m_mov[y,40] .AND. ! EOF()
                                                mvl_nota := mvl_nota + iat(((m_mov[y,19]*m_mov[y,25])+m_mov[y,62]),2)
                                                IF m_mov[y,43] > 0
                                                        mvl_base := mvl_base + iat((m_mov[y,19]*m_mov[y,25]),2)
                                                ENDIF
                                                mvl_icm := mvl_icm + m_mov[y,43]
                                                mvl_ipi := mvl_ipi + m_mov[y,62]
                                                y++
                                                IF y > LEN(m_mov)
                                                        EXIT
                                                ENDIF
                                        ENDDO
                                        y--
                                        mcont_50 ++
                                        mcont_ger ++
                                        SETPOS(6,+29);DISPOUT(TRANSFORM(mcont_50,'999,999,999'))
                                        DEVPOS(PROW()+1,00);DEVOUT('50')
                                        IF ! EMPTY(m_totnt[i,17])
                                                DEVPOS(PROW(),02);DEVOUT(m_totnt[i,17])
                                        ELSE
                                                DEVPOS(PROW(),02);DEVOUT(STRZERO(VAL(m_totnt[i,18]),14))
                                        ENDIF
                                        IF EMPTY(m_totnt[i,16])
                                                DEVPOS(PROW(),16);DEVOUT('ISENTO')
                                        ELSE            
                                                DEVPOS(PROW(),16);DEVOUT(m_totnt[i,16])
                                        ENDIF
                                        DEVPOS(PROW(),30);DEVOUT(SUBSTR(DTOC(m_totnt[i,10]),7)+SUBSTR(DTOC(m_totnt[i,10]),4,2)+SUBSTR(DTOC(m_totnt[i,10]),1,2))
                                        DEVPOS(PROW(),38);DEVOUT(m_totnt[i,15])
                                        DEVPOS(PROW(),40);DEVOUT('01')
                                        DEVPOS(PROW(),42);DEVOUT(SUBSTR(m_totnt[i,6],1,3))
                                        DEVPOS(PROW(),45);DEVOUT(STRZERO(VAL(SUBSTR(m_totnt[i,5],3)),6))
                                        DEVPOS(PROW(),51);DEVOUT(SUBSTR(m_totnt[i,36],1,1)+SUBSTR(m_totnt[i,36],3))
                                        DEVPOS(PROW(),55);DEVOUT('T')
                                        DEVPOS(PROW(),56);DEVOUT(SUBSTR(STRZERO(mvl_nota,14,2),1,11)+SUBSTR(STRZERO(mvl_nota,14,2),13))
                                        DEVPOS(PROW(),69);DEVOUT(SUBSTR(STRZERO(mvl_base,14,2),1,11)+SUBSTR(STRZERO(mvl_base,14,2),13))
                                        DEVPOS(PROW(),82);DEVOUT(SUBSTR(STRZERO(mvl_icm,14,2),1,11)+SUBSTR(STRZERO(mvl_icm,14,2),13))
                                        DEVPOS(PROW(),95);DEVOUT(STRZERO(0,13))
                                        DEVPOS(PROW(),108);DEVOUT(STRZERO(0,13))
                                        DEVPOS(PROW(),121);DEVOUT(SUBSTR(STRZERO(micm,5,2),1,2)+SUBSTR(STRZERO(micm,5,2),4))
*                                       DEVPOS(PROW(),121);DEVOUT(SUBSTR(STRZERO(iat((m_totnt[i,21]/m_totnt[i,20])*100,0),5,2),1,2)+SUBSTR(STRZERO(iat((m_totnt[i,21]/m_totnt[i,20])*100,0),5,2),4))
                                        IF m_totnt[i,37] = 'C'
                                                DEVPOS(PROW(),125);DEVOUT('S')
                                        ELSE
                                                DEVPOS(PROW(),125);DEVOUT('N')
                                        ENDIF
                                NEXT
                        NEXT
                ENDIF
                // NOTAS DE ENTRADA
        ENDIF
        m_totnt := {}
        cComm := "SELECT * FROM sactotnt WHERE emissao >= "+sr_cdbvalue(mdata1)
        ccomm := ccomm +" AND emissao <= "+sr_cdbvalue(mdata2) //ccomm := ccomm +" AND ent_sai ='S' AND tip_sef IS NULL AND documento LIKE 'NF%'"
        ccomm := ccomm +" AND tip_sef IS NULL AND documento LIKE 'NF%'"
        ccomm := ccomm + " ORDER BY emissao,documento,cod_nota,cod_nat"
        sr_getconnection():exec(ccomm,,.t.,@m_totnt)
        i := 0
        FOR i = 1 TO LEN(m_totnt)
                prog_imp(i)
                IF EMPTY(m_totnt[i,35])
                        LOOP
                ENDIF
                mcont_51 ++
                mcont_ger ++
                SETPOS(7,+29);DISPOUT(TRANSFORM(mcont_51,'999,999,999'))
                DEVPOS(PROW()+1,00);DEVOUT('51')
                IF ! EMPTY(m_totnt[i,17])
                        DEVPOS(PROW(),02);DEVOUT(m_totnt[i,17])
                ELSE
                        DEVPOS(PROW(),02);DEVOUT(STRZERO(VAL(m_totnt[i,18]),14))
                ENDIF
                IF EMPTY(m_totnt[i,16])
                        DEVPOS(PROW(),16);DEVOUT('ISENTO')
                ELSE
                        DEVPOS(PROW(),16);DEVOUT(m_totnt[i,16])
                ENDIF
                DEVPOS(PROW(),30);DEVOUT(SUBSTR(DTOC(m_totnt[i,10]),7)+SUBSTR(DTOC(m_totnt[i,10]),4,2)+SUBSTR(DTOC(m_totnt[i,10]),1,2))
                DEVPOS(PROW(),38);DEVOUT(m_totnt[i,15])
                DEVPOS(PROW(),40);DEVOUT(SUBSTR(m_totnt[i,6],1,3))
                DEVPOS(PROW(),43);DEVOUT(STRZERO(VAL(SUBSTR(m_totnt[i,5],3)),6))
                DEVPOS(PROW(),49);DEVOUT(SUBSTR(m_totnt[i,36],1,1)+SUBSTR(m_totnt[i,36],3))
                DEVPOS(PROW(),53);DEVOUT(SUBSTR(STRZERO(m_totnt[i,27],14,2),1,11)+SUBSTR(STRZERO(m_totnt[i,27],14,2),13))
                DEVPOS(PROW(),66);DEVOUT(SUBSTR(STRZERO(m_totnt[i,35],14,2),1,11)+SUBSTR(STRZERO(m_totnt[i,35],14,2),13))
                DEVPOS(PROW(),79);DEVOUT(STRZERO(0,13))
                DEVPOS(PROW(),92);DEVOUT(STRZERO(0,13))
                DEVPOS(PROW(),105);DEVOUT(SPACE(20))
                IF m_totnt[i,37] = 'C'
                        DEVPOS(PROW(),125);DEVOUT('S')
                ELSE
                        DEVPOS(PROW(),125);DEVOUT('N')
                ENDIF
        NEXT
        i := 0
        FOR i = 1 TO LEN(m_totnt)
                prog_imp(i)
                IF EMPTY(m_totnt[i,23])
                        LOOP
                ENDIF
                mcont_53 ++
                mcont_ger ++
                SETPOS(8,+29);DISPOUT(TRANSFORM(mcont_53,'999,999,999'))
                DEVPOS(PROW()+1,00);DEVOUT('53')
                IF ! EMPTY(m_totnt[i,17])
                        DEVPOS(PROW(),02);DEVOUT(m_totnt[i,17])
                ELSE
                        DEVPOS(PROW(),02);DEVOUT(STRZERO(VAL(m_totnt[i,18]),14))
                ENDIF
                IF EMPTY(m_totnt[i,16])
                        DEVPOS(PROW(),16);DEVOUT('ISENTO')
                ELSE
                        DEVPOS(PROW(),16);DEVOUT(m_totnt[i,16])
                ENDIF
                DEVPOS(PROW(),30);DEVOUT(SUBSTR(DTOC(m_totnt[i,10]),7)+SUBSTR(DTOC(m_totnt[i,10]),4,2)+SUBSTR(DTOC(m_totnt[i,10]),1,2))
                DEVPOS(PROW(),38);DEVOUT(m_totnt[i,15])
                DEVPOS(PROW(),40);DEVOUT('01')
                DEVPOS(PROW(),42);DEVOUT(SUBSTR(m_totnt[i,6],1,3))
                DEVPOS(PROW(),45);DEVOUT(STRZERO(VAL(SUBSTR(m_totnt[i,5],3)),6))
                DEVPOS(PROW(),51);DEVOUT(SUBSTR(m_totnt[i,36],1,1)+SUBSTR(m_totnt[i,36],3))
                IF m_totnt[i,11] = 'S'
                        DEVPOS(PROW(),55);DEVOUT('P')
                ELSE
                        DEVPOS(PROW(),55);DEVOUT('T')
                ENDIF
                DEVPOS(PROW(),56);DEVOUT(SUBSTR(STRZERO(m_totnt[i,24],14,2),1,11)+SUBSTR(STRZERO(m_totnt[i,24],14,2),13))
                DEVPOS(PROW(),69);DEVOUT(SUBSTR(STRZERO(m_totnt[i,23],14,2),1,11)+SUBSTR(STRZERO(m_totnt[i,23],14,2),13))
                DEVPOS(PROW(),82);DEVOUT(STRZERO(0,13))
                IF m_totnt[i,37] = 'C'
                        DEVPOS(PROW(),95);DEVOUT('S')
                ELSE
                        DEVPOS(PROW(),95);DEVOUT('N')
                ENDIF
                DEVPOS(PROW(),96);DEVOUT(SPACE(30))
        NEXT
        m_movnt := {}
        cComm := "SELECT * FROM sacmovnt WHERE data_s_e >= "+sr_cdbvalue(mdata1)
        ccomm := ccomm +" AND data_s_e <= "+sr_cdbvalue(mdata2)
        ccomm := ccomm +" AND ent_sai ='S' AND documento LIKE 'NF%'"
        ccomm := ccomm + " ORDER BY emissao,documento,cod_nota,cod_nat"
        sr_getconnection():exec(ccomm,,.t.,@m_movnt)
        IF LEN(m_movnt) > 0
                mdoc := m_movnt[1,4]
                ment_sai := m_movnt[1,18]
                mitem := 1
                y := 0
                FOR y = 1 TO LEN(m_movnt)
                        prog_imp(y)
                        IF mdoc <> m_movnt[y,4]
                                mdoc := m_movnt[y,4]
                                mitem := 0
                                LOOP
                        ENDIF
                        cons_doc := {}
                        sr_getconnection():exec("SELECT * FROM sactotnt WHERE documento = "+sr_cdbvalue(m_movnt[y,3])+" AND cod_cli = "+sr_cdbvalue(m_movnt[y,31]),,.t.,@cons_doc)
                        IF LEN(cons_doc) = 0
                                mdoc := m_movnt[y,4]
                                mitem := 0
                                LOOP
                        ENDIF
                        mcont_54 ++
                        mcont_ger ++
                        SETPOS(9,+29);DISPOUT(TRANSFORM(mcont_54,'999,999,999'))
                        DEVPOS(PROW()+1,00);DEVOUT('54')
                        IF ! EMPTY(cons_doc[1,17])
                                DEVPOS(PROW(),02);DEVOUT(cons_doc[1,17])
                        ELSE
                                DEVPOS(PROW(),02);DEVOUT(STRZERO(VAL(cons_doc[1,18]),14))
                        ENDIF
                        DEVPOS(PROW(),16);DEVOUT(cons_doc[1,7])
                        DEVPOS(PROW(),18);DEVOUT(SUBSTR(m_movnt[y,5],1,3))
                        DEVPOS(PROW(),21);DEVOUT(STRZERO(VAL(SUBSTR(m_movnt[y,3],3)),6))
                        DEVPOS(PROW(),27);DEVOUT(SUBSTR(m_movnt[y,65],1,1)+SUBSTR(m_movnt[y,65],3))
                        ver_cod(VAL(m_movnt[y,11]),,,,,'*')
                        DEVPOS(PROW(),31);DEVOUT(m_movnt[y,61])
                        DEVPOS(PROW(),34);DEVOUT(STRZERO(mitem,3))
                        DEVPOS(PROW(),37);DEVOUT(STRZERO(VAL(m_movnt[y,11]),14))
                        ver_nat(cons_doc[1,36])
                        IF op->credito = 'N'
                                DEVPOS(PROW(),51);DEVOUT(STRZERO(0,11))
                                DEVPOS(PROW(),62);DEVOUT(STRZERO(0,12))
                                DEVPOS(PROW(),74);DEVOUT(STRZERO(0,12))
                                DEVPOS(PROW(),86);DEVOUT(STRZERO(0,12))
                                DEVPOS(PROW(),98);DEVOUT(STRZERO(0,12))
                                DEVPOS(PROW(),110);DEVOUT(STRZERO(0,12))
                                DEVPOS(PROW(),122);DEVOUT(STRZERO(0,4))
                        ELSE
                                DEVPOS(PROW(),51);DEVOUT(SUBSTR(STRZERO(m_movnt[y,19],12,3),1,8)+SUBSTR(STRZERO(m_movnt[y,19],12,3),10))
                                IF m_movnt[y,65] = '6.109'
                                        DEVPOS(PROW(),62);DEVOUT(SUBSTR(STRZERO((m_movnt[y,19]*m_movnt[y,22])-m_movnt[y,50],13,2),1,10)+SUBSTR(STRZERO((m_movnt[y,19]*m_movnt[y,22])-m_movnt[y,50],13,2),12))
                                ELSE
                                        DEVPOS(PROW(),62);DEVOUT(SUBSTR(STRZERO(m_movnt[y,19]*m_movnt[y,22],13,2),1,10)+SUBSTR(STRZERO(m_movnt[y,19]*m_movnt[y,22],13,2),12))
                                ENDIF
                                DEVPOS(PROW(),74);DEVOUT(SUBSTR(STRZERO(0,13,2),1,10)+SUBSTR(STRZERO(0,13,2),12))
                                IF m_movnt[y,38] > 0
                                        IF EMPTY(m_movnt[y,35])
                                                DEVPOS(PROW(),86);DEVOUT(SUBSTR(STRZERO(m_movnt[y,19]*m_movnt[y,22]+m_movnt[y,54],13,2),1,10)+SUBSTR(STRZERO(m_movnt[y,19]*m_movnt[y,22]+m_movnt[y,54],13,2),12))
                                        ELSE
                                                DEVPOS(PROW(),86);DEVOUT(SUBSTR(STRZERO(m_movnt[y,19]*m_movnt[y,22],13,2),1,10)+SUBSTR(STRZERO(m_movnt[y,19]*m_movnt[y,22],13,2),12))
                                        ENDIF           
                                ELSE
                                        DEVPOS(PROW(),86);DEVOUT(SUBSTR(STRZERO(0,13,2),1,10)+SUBSTR(STRZERO(0,13,2),12))
                                ENDIF
                                DEVPOS(PROW(),98);DEVOUT(SUBSTR(STRZERO(m_movnt[y,42],13,2),1,10)+SUBSTR(STRZERO(m_movnt[y,42],13,2),12))
                                DEVPOS(PROW(),110);DEVOUT(SUBSTR(STRZERO(m_movnt[y,54],13,2),1,10)+SUBSTR(STRZERO(m_movnt[y,54],13,2),12))
                                DEVPOS(PROW(),122);DEVOUT(SUBSTR(STRZERO(m_movnt[y,38],5,2),1,2)+SUBSTR(STRZERO(m_movnt[y,38],5,2),4))
                        ENDIF
                        IF ASCAN(m_produto,m_movnt[y,11])=0
                                AADD(m_produto,m_movnt[y,11])
                                AADD(m_prodaux,{m_movnt[y,65],m_movnt[y,61],m_movnt[y,54],m_movnt[y,38]})
                        ENDIF

                        //sef_cod(m_movnt[y,11],'movnt')
                        IF mdoc = m_movnt[y,4]  //.AND. ment_sai = m_movnt[y,18]
                                mitem ++
                        ELSE
                                mdoc := m_movnt[y,4]
                                ment_sai := m_movnt[y,18]
                                mitem := 1
                        ENDIF
                NEXT
        ENDIF                           
        m_mov := {}
        cComm := "SELECT * FROM sacmovnt WHERE data_s_e >= "+sr_cdbvalue(mdata1)
        ccomm := ccomm +" AND data_s_e <= "+sr_cdbvalue(mdata2)
        ccomm := ccomm +" AND ent_sai ='E' AND documento LIKE 'NF%'"
        ccomm := ccomm + " ORDER BY emissao,documento,cod_nota,cod_nat"
        sr_getconnection():exec(ccomm,,.t.,@m_mov)
        IF LEN(m_mov) > 0
                mdoc := m_mov[y,2]
                ment_sai := m_mov[y,17]
                mitem := y := 0
                FOR y = 1 TO LEN(m_movnt)
                        prog_imp(y)
                        IF mdoc <> m_mov[y,2]
                                mdoc := m_mov[y,2]
                                mitem := 0
                        ENDIF
                        cons_doc := {}
                        sr_getconnection():exec("SELECT * FROM sactotnt WHERE documento = "+sr_cdbvalue(m_mov[y,2])+" AND cod_cli = "+sr_cdbvalue(m_mov[y,40]),,.t.,@cons_doc)
                        IF LEN(cons_doc) = 0
                                IF mdoc <> m_mov[y,2]
                                        mdoc := m_mov[y,2]
                                        mitem := 0
                                ENDIF
                                LOOP
                        ENDIF
                        mitem ++
                        mcont_54 ++
                        mcont_ger ++
                        SETPOS(9,+29);DISPOUT(TRANSFORM(mcont_54,'999,999,999'))
                        DEVPOS(PROW()+1,00);DEVOUT('54')
                        IF ! EMPTY(cons_doc[1,17])
                                DEVPOS(PROW(),02);DEVOUT(cons_doc[1,17])
                        ELSE
                                DEVPOS(PROW(),02);DEVOUT(STRZERO(VAL(cons_doc[1,18]),14))
                        ENDIF
                        DEVPOS(PROW(),16);DEVOUT(cons_doc[1,7])
                        DEVPOS(PROW(),18);DEVOUT(SUBSTR(m_mov[y,4],1,3))
                        DEVPOS(PROW(),21);DEVOUT(STRZERO(VAL(SUBSTR(m_mov[y,2],3)),6))
                        DEVPOS(PROW(),27);DEVOUT(SUBSTR(m_mov[y,73],1,1)+SUBSTR(m_mov[y,73],3))
                        ver_cod(VAL(m_mov[y,10]),,,,,'*')
                        DEVPOS(PROW(),31);DEVOUT(m_mov[y,69])
                        DEVPOS(PROW(),34);DEVOUT(STRZERO(mitem,3))
                        DEVPOS(PROW(),37);DEVOUT(STRZERO(VAL(m_mov[y,10]),14))
                        ver_nat(cons_doc[1,36])
                        IF op->credito = 'N'
                                DEVPOS(PROW(),51);DEVOUT(STRZERO(0,11))
                                DEVPOS(PROW(),62);DEVOUT(STRZERO(0,12))
                                DEVPOS(PROW(),74);DEVOUT(STRZERO(0,12))
                                DEVPOS(PROW(),86);DEVOUT(STRZERO(0,12))
                                DEVPOS(PROW(),98);DEVOUT(STRZERO(0,12))
                                DEVPOS(PROW(),110);DEVOUT(STRZERO(0,12))
                                DEVPOS(PROW(),122);DEVOUT(STRZERO(0,4))
                        ELSE
                                DEVPOS(PROW(),51);DEVOUT(SUBSTR(STRZERO(m_mov[y,19],12,3),1,8)+SUBSTR(STRZERO(m_mov[y,19],12,3),10))
                                DEVPOS(PROW(),62);DEVOUT(SUBSTR(STRZERO(m_mov[y,19]*m_mov[y,25],13,2),1,10)+SUBSTR(STRZERO(m_mov[y,19]*m_mov[y,25],13,2),12))
                                DEVPOS(PROW(),74);DEVOUT(SUBSTR(STRZERO(0,13,2),1,10)+SUBSTR(STRZERO(0,13,2),12))
                                IF m_mov[y,42] > 0
                                        DEVPOS(PROW(),86);DEVOUT(SUBSTR(STRZERO(m_mov[y,19]*m_mov[y,25],13,2),1,10)+SUBSTR(STRZERO(m_mov[y,19]*m_mov[y,25],13,2),12))
                                ELSE
                                        DEVPOS(PROW(),86);DEVOUT(SUBSTR(STRZERO(0,13,2),1,10)+SUBSTR(STRZERO(0,13,2),12))
                                ENDIF
                                DEVPOS(PROW(),98);DEVOUT(SUBSTR(STRZERO(0,13,2),1,10)+SUBSTR(STRZERO(0,13,2),12))
                                DEVPOS(PROW(),110);DEVOUT(SUBSTR(STRZERO(m_mov[y,62],13,2),1,10)+SUBSTR(STRZERO(m_mov[y,62],13,2),12))
                                DEVPOS(PROW(),122);DEVOUT(SUBSTR(STRZERO(m_mov[y,42],5,2),1,2)+SUBSTR(STRZERO(m_mov[y,42],5,2),4))
                        ENDIF
                        IF ASCAN(m_produto,m_mov[y,10])=0
                                AADD(m_produto,m_mov[y,10])
                                AADD(m_prodaux,{m_mov[y,73],m_mov[y,69],m_mov[y,62],m_mov[y,42]})
                        ENDIF
                        //sef_cod(m_mov[y,10],'mov')
                        IF mdoc <> m_mov[y,2]
                                mdoc := m_mov[y,2]
                                ment_sai := m_mov[y,17]
                                mitem := 0
                        ENDIF
                NEXT
        ENDIF

        ****** TIPO 60
        mcons_r1 := {}
        sr_getconnection():exec("SELECT * FROM r1 ",,.t.,@mcons_r1)
        IF LEN(mcons_r1) > 0
                mcons_r2 := {}
                sr_getconnection():exec("SELECT * FROM r2 WHERE numero_usu = "+sr_cdbvalue(STRZERO(VAL(mcons_r1[1,9]),2))+" AND data_mov >= "+sr_cdbvalue(mdata1)+" AND data_mov <= "+sr_cdbvalue(mdata2)+" ORDER BY data_mov",,.t.,@mcons_r2)
                IF LEN(mcons_r2) > 0
                        mitem ++
                        mcont_60 ++
                        mcont_ger ++
                        i := 0
                        FOR i = 1 TO LEN(mcons_r2)
                                prog_imp(i)
                                SETPOS(9,+29);DISPOUT(TRANSFORM(mcont_60,'999,999,999'))
                                DEVPOS(PROW()+1,00);DEVOUT('60M')
                                DEVPOS(PROW(),PCOL());DEVOUT(mcons_r2[i,8])
                                DEVPOS(PROW(),PCOL());DEVOUT(mcons_r2[i,1])
                                DEVPOS(PROW(),PCOL());DEVOUT(mcons_r2[i,4])
                                DEVPOS(PROW(),PCOL());DEVOUT(mcons_r2[i,3])
                                DEVPOS(PROW(),PCOL());DEVOUT(mcons_r2[i,13])
                                DEVPOS(PROW(),PCOL());DEVOUT(mcons_r2[i,14])
                                DEVPOS(PROW(),PCOL());DEVOUT(mcons_r2[i,5])
                                DEVPOS(PROW(),PCOL());DEVOUT(mcons_r2[i,7])
                                DEVPOS(PROW(),PCOL());DEVOUT(mcons_r2[i,11])
                                DEVPOS(PROW(),PCOL());DEVOUT(mcons_r2[i,14])
                                DEVPOS(PROW(),PCOL());DEVOUT(SPACE(37))
                                mcons_r3 := {}
                                sr_getconnection():exec("SELECT * FROM r3 WHERE numero_usu = "+sr_cdbvalue(mcons_r2[i,4])+" AND data_mov = "+sr_cdbvalue(mcons_r2[i,14])+" ORDER BY data_mov",,.t.,@mcons_r3)
                                IF LEN(mcons_r3) > 0
                                        r3 := 0
                                        FOR r3 = 1 TO LEN(mcons_r3)
                                                mcont_60 ++
                                                mcont_ger ++
                                                DEVPOS(PROW()+1,00);DEVOUT('60A')
                                                DEVPOS(PROW(),PCOL());DEVOUT(SUBSTR(DTOC(mcons_r3[r3,8]),7,4)+SUBSTR(DTOC(mcons_r3[r3,8]),4,2)+SUBSTR(DTOC(mcons_r3[r3,8]),1,2))
                                                DEVPOS(PROW(),PCOL());DEVOUT(mcons_r3[r3,1])
                                                IF SUBSTR(mcons_r3[r3,6],3,1) = 'T'
                                                        DEVPOS(PROW(),PCOL());DEVOUT(SUBSTR(mcons_r3[r3,6],4,4))
                                                ELSEIF SUBSTR(mcons_r3[r3,6],1,1) = 'F'
                                                        DEVPOS(PROW(),PCOL());DEVOUT(SUBSTR(mcons_r3[r3,6],1,1)+SPACE(3))
                                                ELSEIF SUBSTR(mcons_r3[r3,6],1,1) = 'I'
                                                        DEVPOS(PROW(),PCOL());DEVOUT(SUBSTR(mcons_r3[r3,6],1,1)+SPACE(3))
                                                ELSEIF SUBSTR(mcons_r3[r3,6],1,1) = 'N'
                                                        DEVPOS(PROW(),PCOL());DEVOUT(SUBSTR(mcons_r3[r3,6],1,1)+SPACE(3))
                                                ELSEIF SUBSTR(mcons_r3[r3,6],1,1) = 'C'
                                                        DEVPOS(PROW(),PCOL());DEVOUT('CANC')
                                                ELSEIF SUBSTR(mcons_r3[r3,6],1,1) = 'D'
                                                        DEVPOS(PROW(),PCOL());DEVOUT('DESC')
                                                ENDIF
                                                DEVPOS(PROW(),PCOL());DEVOUT(SUBSTR(mcons_r3[r3,7],2,12))
                                                DEVPOS(PROW(),PCOL());DEVOUT(SPACE(79))
                                        NEXT
                                EndIf
                        NEXT
                ENDIF
        ENDIF

        ****** TIPO 75
        y := 0
        FOR y = 1 TO LEN(m_produto)
                mcont_75 ++
                mcont_ger ++
                SETPOS(11,+29);DISPOUT(TRANSFORM(mcont_75,'999,999,999'))
                DEVPOS(PROW()+1,00);DEVOUT('75')
                DEVPOS(PROW(),02);DEVOUT(SUBSTR(DTOC(mdata1),7)+SUBSTR(DTOC(mdata1),4,2)+SUBSTR(DTOC(mdata1),1,2))
                DEVPOS(PROW(),10);DEVOUT(SUBSTR(DTOC(mdata2),7)+SUBSTR(DTOC(mdata2),4,2)+SUBSTR(DTOC(mdata2),1,2))
                DEVPOS(PROW(),18);DEVOUT(STRZERO(VAL(m_produto[y]),14))
                m_codprod := {}
                cComm := "SELECT * FROM sacmerc WHERE "
                ccomm := ccomm +" cod_merc = "+sr_cdbvalue(m_produto[y])
                sr_getconnection():exec(ccomm,,.t.,@m_codprod)
                IF LEN(m_codprod) > 0
                        IF EMPTY(m_codprod[1,70])
                                DEVPOS(PROW(),32);DEVOUT('11111111')
                        ELSE
                                DEVPOS(PROW(),32);DEVOUT(m_codprod[1,70])
                        ENDIF
                        DEVPOS(PROW(),40);DEVOUT(m_codprod[1,9])
                        DEVPOS(PROW(),93);DEVOUT(m_codprod[1,14])
                        DEVPOS(PROW(),99);DEVOUT(SUBSTR(STRZERO(m_prodaux[1,3],6,2),1,3)+SUBSTR(STRZERO(m_prodaux[1,3],6,2),5))
                        DEVPOS(PROW(),104);DEVOUT(SUBSTR(STRZERO(m_prodaux[1,4],5,2),1,2)+SUBSTR(STRZERO(m_prodaux[1,4],5,2),4))
                ELSE
                        m_codprod := {}
                        cComm := "SELECT * FROM sacmovnt WHERE "
                        ccomm := ccomm +" codigo "+sr_cdbvalue(m_produto[y])
                        sr_getconnection():exec(ccomm,,.t.,@m_codprod)
                        IF LEN(m_codprod) > 0
                                DEVPOS(PROW(),32);DEVOUT('00000000')
                                DEVPOS(PROW(),40);DEVOUT(m_codprod[y,12])
                                DEVPOS(PROW(),93);DEVOUT(m_codprod[y,16])
                                DEVPOS(PROW(),99);DEVOUT(SUBSTR(STRZERO(m_codprod[y,54],6,2),1,2)+SUBSTR(STRZERO(m_codprod[y,54],6,2),5))
                                DEVPOS(PROW(),104);DEVOUT(SUBSTR(STRZERO(m_codprod[y,38],5,2),1,2)+SUBSTR(STRZERO(m_codprod[y,38],5,2),4))
                        ENDIF
                ENDIF
                DEVPOS(PROW(),108);DEVOUT(STRZERO(0,5))
                DEVPOS(PROW(),113);DEVOUT(STRZERO(0,13))
        NEXT
        IF mcont_50 > 0
                mcont_ger ++
                mcont_90 ++
        ENDIF
        IF mcont_51 > 0
                mcont_ger ++
                mcont_90 ++
        ENDIF
        IF mcont_53 > 0
                mcont_ger ++
                mcont_90 ++
        ENDIF
        IF mcont_54 > 0
                mcont_ger ++
                mcont_90 ++
        ENDIF
        IF mcont_60 > 0
                mcont_ger ++
                mcont_90 ++
        ENDIF
        IF mcont_75 > 0
                mcont_ger ++
                mcont_90 ++
        ENDIF
        IF mcont_90 > 0
                mcont_90 ++
        ENDIF
        IF mcont_50 > 0
                DEVPOS(PROW()+1,00);DEVOUT('90')
                DEVPOS(PROW(),02);DEVOUT(SUBSTR(mcgc_firm,1,2)+SUBSTR(mcgc_firm,4,3)+SUBSTR(mcgc_firm,8,3)+SUBSTR(mcgc_firm,12,4)+SUBSTR(mcgc_firm,17,2))
                DEVPOS(PROW(),16);DEVOUT(LEFT(minsc_firm,14))
                DEVPOS(PROW(),30);DEVOUT('50')
                DEVPOS(PROW(),32);DEVOUT(STRZERO(mcont_50,8))
                DEVPOS(PROW(),125);DEVOUT(STRZERO(mcont_90,1))
        ENDIF
        IF mcont_51 > 0
                DEVPOS(PROW()+1,00);DEVOUT('90')
                DEVPOS(PROW(),02);DEVOUT(SUBSTR(mcgc_firm,1,2)+SUBSTR(mcgc_firm,4,3)+SUBSTR(mcgc_firm,8,3)+SUBSTR(mcgc_firm,12,4)+SUBSTR(mcgc_firm,17,2))
                DEVPOS(PROW(),16);DEVOUT(LEFT(minsc_firm,14))
                DEVPOS(PROW(),30);DEVOUT('51')
                DEVPOS(PROW(),32);DEVOUT(STRZERO(mcont_51,8))
                DEVPOS(PROW(),125);DEVOUT(STRZERO(mcont_90,1))
        ENDIF
        IF mcont_53 > 0
                DEVPOS(PROW()+1,00);DEVOUT('90')
                DEVPOS(PROW(),02);DEVOUT(SUBSTR(mcgc_firm,1,2)+SUBSTR(mcgc_firm,4,3)+SUBSTR(mcgc_firm,8,3)+SUBSTR(mcgc_firm,12,4)+SUBSTR(mcgc_firm,17,2))
                DEVPOS(PROW(),16);DEVOUT(LEFT(minsc_firm,14))
                DEVPOS(PROW(),30);DEVOUT('53')
                DEVPOS(PROW(),32);DEVOUT(STRZERO(mcont_53,8))
                DEVPOS(PROW(),125);DEVOUT(STRZERO(mcont_90,1))
        ENDIF

        IF mcont_54 > 0
                DEVPOS(PROW()+1,00);DEVOUT('90')
                DEVPOS(PROW(),02);DEVOUT(SUBSTR(mcgc_firm,1,2)+SUBSTR(mcgc_firm,4,3)+SUBSTR(mcgc_firm,8,3)+SUBSTR(mcgc_firm,12,4)+SUBSTR(mcgc_firm,17,2))
                DEVPOS(PROW(),16);DEVOUT(LEFT(minsc_firm,14))
                DEVPOS(PROW(),30);DEVOUT('54')
                DEVPOS(PROW(),32);DEVOUT(STRZERO(mcont_54,8))
                DEVPOS(PROW(),125);DEVOUT(STRZERO(mcont_90,1))
        ENDIF
        IF mcont_60 > 0
                DEVPOS(PROW()+1,00);DEVOUT('90')
                DEVPOS(PROW(),02);DEVOUT(SUBSTR(mcgc_firm,1,2)+SUBSTR(mcgc_firm,4,3)+SUBSTR(mcgc_firm,8,3)+SUBSTR(mcgc_firm,12,4)+SUBSTR(mcgc_firm,17,2))
                DEVPOS(PROW(),16);DEVOUT(LEFT(minsc_firm,14))
                DEVPOS(PROW(),30);DEVOUT('60')
                DEVPOS(PROW(),32);DEVOUT(STRZERO(mcont_60,8))
                DEVPOS(PROW(),125);DEVOUT(STRZERO(mcont_90,1))
        ENDIF
        IF mcont_75 > 0
                DEVPOS(PROW()+1,00);DEVOUT('90')
                DEVPOS(PROW(),02);DEVOUT(SUBSTR(mcgc_firm,1,2)+SUBSTR(mcgc_firm,4,3)+SUBSTR(mcgc_firm,8,3)+SUBSTR(mcgc_firm,12,4)+SUBSTR(mcgc_firm,17,2))
                DEVPOS(PROW(),16);DEVOUT(LEFT(minsc_firm,14))
                DEVPOS(PROW(),30);DEVOUT('75')
                DEVPOS(PROW(),32);DEVOUT(STRZERO(mcont_75,8))
                DEVPOS(PROW(),125);DEVOUT(STRZERO(mcont_90,1))
        ENDIF
        DEVPOS(PROW()+1,00);DEVOUT('90')
        DEVPOS(PROW(),02);DEVOUT(SUBSTR(mcgc_firm,1,2)+SUBSTR(mcgc_firm,4,3)+SUBSTR(mcgc_firm,8,3)+SUBSTR(mcgc_firm,12,4)+SUBSTR(mcgc_firm,17,2))
        DEVPOS(PROW(),16);DEVOUT(LEFT(minsc_firm,14))
        DEVPOS(PROW(),30);DEVOUT('99')
        DEVPOS(PROW(),32);DEVOUT(STRZERO(mcont_50+mcont_51+mcont_53+mcont_54+mcont_75+2+mcont_90,8))
        DEVPOS(PROW(),125);DEVOUT(STRZERO(mcont_90,1))
        DEVPOS(PROW()+1,0);DEVOUT('')
        SET DEVI TO SCREEN;SET PRINT OFF;SET PRINT TO
        FCLOSE(marq)
        GERA_EAD(marq)
        IF 'S' = op_simnao('S','Deseja Editar o arquivo:')
                MYRUN('NOTEPAD '+ALLTRIM(marq))
        ENDIF
ENDDO
RETURN NIL
******************************* F I M *****************************************
