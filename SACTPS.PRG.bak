FUNCTION rel_verif
******************
LOCAL opcao
MEMVAR mpoint,mpagina
GO mpoint
CLEAR GETS
opcao := op_simnao('N','Deseja Imprimir Relatorio p/Expedicao [S/n]:')
IF opcao = 'N'
        RETURN NIL
ENDIF
IF m_set[1,11] = 'I'
        IF m_set[1,9] = 'S'
                mpagina := 86
        ELSE
                mpagina := 88
        ENDIF
ELSE
        IF m_set[1,9] = 'S'
                mpagina := 26
        ELSE
                mpagina := 28
        ENDIF
ENDIF
SET DEVICE TO PRINT
SET PRINT TO (m_indiv[1,7])

IF mtipo_imp = 'M'
        imprt(mtipo_imp,'P8')
ENDIF
imprt(mtipo_imp,'N')
imprt(mtipo_imp,'E')
DEVPOS(PROW(),00);DEVOUT(memp_resa)
imprt(mtipo_imp,'C')
DEVPOS(PROW()+1,00);DEVOUT(RTRIM(m_set[1,132])+'-'+RTRIM(m_set[1,133])+'-'+RTRIM(m_set[1,134])+'-'+RTRIM(m_set[1,19])+' - Fone: '+m_set[1,136])
imprt(mtipo_imp,'N')
@ PROW()+1,00 SAY mtraco
imprt(mtipo_imp,'E',1)
@ PROW(),10 SAY IF(ali='orcam',ALLTRIM(m_set[1,24]),ALLTRIM(m_set[1,23]))+' '+STRZERO(mnum_ped,6)
imprt(mtipo_imp,'N')
@ PROW()+1,00 SAY 'Emissao:'
@ PROW(),PCOL()+1 SAY mdata
@ PROW(),PCOL()+2 SAY 'Hora:'
@ PROW(),PCOL()+1 SAY mhora
@ PROW(),PCOL()+2 SAY 'Cod.:'
@ PROW(),PCOL()+1 SAY (ali)->pcod_vend
@ PROW(),PCOL()+2 SAY (ali)->pvendedor
@ PROW(),00 SAY PADL(mvia,80)
IF mcod_cli > 0
        imprt(mtipo_imp,'C',1)
        @ PROW(),00 SAY 'Cliente:'
        @ PROW(),PCOL()+1 SAY mcod_cli
        @ PROW(),PCOL()+1 SAY mnome_cli
        IF mcgc <> SPACE(14)
                @ PROW(),PCOL()+2 SAY 'CNPJ:'
                DEVPOS(PROW(),PCOL()+1);DEVOUTPICT(mcgc,'@@R 99.999.999/9999-99')
                DEVPOS(PROW(),PCOL()+1);DEVOUT(' - Insc.: '+minsc)
        ELSEIF mcpf <> SPACE(11)
                @ PROW(),PCOL()+2 SAY 'CPF:'
                DEVPOS(PROW(),PCOL()+1);DEVOUTPICT(mcpf,'@@R 999.999.999-99')
        ENDIF
        @ PROW()+1,00 SAY 'End.: '+mend+' - '+mbairro+' - '+mcidade+'- '+muf+'- Fone:'+cli->tel1
        imprt(mtipo_imp,'N')
ENDIF
imprt(mtipo_imp,'N')
@ PROW()+1,00 SAY mtraco
WHILE STRZERO(mnum_ped,6) = (ali)->pnum_ped .AND. ! EOF()
        ver_cod(VAL((ali)->pcod_merc),,,,,'*')
        imprt(mtipo_imp,'N')
        @ PROW()+1,00 SAY merc->cod_barr
        @ PROW(),06 SAY (ali)->pmerc
        @ PROW(),PCOL()+2 SAY TRANSFORM((ali)->pquantd,'999,999.99')
        SKIP
        IF PROW() >= mpagina .AND. STRZERO(mnum_ped,6) == (ali)->pnum_ped .AND. ! EOF()
                imprt(mtipo_imp,'E')
                DEVPOS(PROW(),00);DEVOUT(memp_resa)
                imprt(mtipo_imp,'C')
                DEVPOS(PROW()+1,00);DEVOUT(RTRIM(m_set[1,132])+'-'+RTRIM(m_set[1,133])+'-'+RTRIM(m_set[1,134])+'-'+RTRIM(m_set[1,19])+' - Fone: '+m_set[1,136])
                imprt(mtipo_imp,'N')
                @ PROW()+1,00 SAY mtraco
                @ PROW(),10 SAY '  '
                imprt(mtipo_imp,'E')
                @ PROW(),10 SAY IF(ali='orcam',ALLTRIM(m_set[1,24]),ALLTRIM(m_set[1,23]))+' '+STRZERO(mnum_ped,6)
                imprt(mtipo_imp,'N')
                IF mcod_cli > 0
                        @ PROW()+1,00 SAY 'Cliente:'
                        @ PROW(),PCOL()+1 SAY mcod_cli
                        @ PROW(),PCOL()+1 SAY mnome_cli
                        @ PROW()+1,00 SAY 'Emissao:'
                ELSE
                        @ PROW()+1,00 SAY 'Emissao:'
                ENDIF
                @ PROW(),10 SAY mdata
                @ PROW(),20 SAY 'Hora:'
                @ PROW(),26 SAY mhora
                @ PROW(),37 SAY 'Cod.:'
                @ PROW(),43 SAY (ali)->pcod_vend
                @ PROW(),47 SAY (ali)->pvendedor
                @ PROW(),00 SAY PADL('continuacao',80)
                imprt(mtipo_imp,'N')
                @ PROW()+1,00 SAY mtraco
        ENDIF
ENDDO
EJECT
SET DEVICE TO SCREEN;SET PRINT TO;SET PRINT OFF
RETURN NIL
***************************************** F I M **************************
* VER PEDIDO
*************
FUNCTION ver_pedido()
*********************

LOCAL i:=0,tela,point:=0,m_ped:={},li:=05,ci:=00,la:=22,ca:=79

tela:=SAVESCREEN(00,00,24,79)

FOR i = 1 TO LEN(m_matriz)
        AADD(m_ped,m_codigo[i]+' '+m_matriz[i,5]+' '+TRANSFORM(m_matriz[i,1],'99999.99')+' '+TRANSFORM(m_matriz[i,1]*m_matriz[i,2],'99,999.99')+' '+TRANSFORM(m_matriz[i,15],'999.99'))
NEXT
botao(li,ci,la,ca)
setcor(3)
DEVPOS(li+1,ci+01);DEVOUT(' Cod.')
DEVPOS(li+1,COL()+1);DEVOUT('Descricao                               ')
DEVPOS(li+1,COL()+1);DEVOUT(' Quantd.')
DEVPOS(li+1,COL()+1);DEVOUT('Vlr Total')
DEVPOS(li+1,COL()+1);DEVOUT('Comissao')
@ li+2,ci+1 TO li+2,ca-1
point := ACHOICE(li+3,ci+1,la-3,ca-1,m_ped,,,)
RESTSCREEN(00,00,24,79,tela)
ASIZE(m_ped,0)
RETURN NIL
**************************** F I M *************************************
*******************************
* IMPRESSAO EM BOLETO IMP.TERMICA
*****************************
FUNCTION bole_term()
*****************
LOCAL mobs_caixa,opcao,mop,mtot_volume:=0,mtot_itens:=0,mtot_ipi:=0
mtraco := REPLI('=',40)
i := 0
IF ! EMPTY(m_indiv[1,8]) .OR. ! EMPTY(m_indiv[1,13])
        mquantd ++
ENDIF
****************
IF ali = 'ped_s'
        SELE(ali);ORDSETFOCUS(15)
ELSE
        SELE(ali);ORDSETFOCUS(7)
ENDIF
GO TOP
****************
SEEK STRZERO(mnum_ped,6)
mpoint := RECNO()
****************

mtipo_fin := (ali)->pcond_veze

mpoint := RECNO()
/*
IF EMPTY(mquantd)
        mtot_itens := mt_pedido := mtot_desc := mtot_quant := mdesconto := 0
        WHILE STRZERO(mnum_ped,6) = (ali)->pnum_ped .AND. ! EOF()
                IF m_set[1,36] = 'S'
                        IF (ali)->ppromocao > 0
                                mdesconto := mperc := 0
                        ELSEIF (ali)->ppre_venda > (ali)->pvlr_fat      //.AND. (ali)->ppre_dig <= (ali)->ppre_venda
                                mdesconto =  ((ali)->pquantd * (ali)->pvlr_fat) - ((ali)->pquantd * (ali)->ppre_venda)
                                mperc := iat(((((ali)->pquantd * (ali)->ppre_venda) - ((ali)->pquantd * (ali)->pvlr_fat)) / ((ali)->pquantd * (ali)->ppre_venda)),3) * 100
                        ELSE
                                mperc := (ali)->pdesc
                        ENDIF
                ELSE
                        mdesconto := 0
                ENDIF
                mcust_real = (ali)->pquantd * (ali)->pvlr_fat
                mtot_desc := mtot_desc + mdesconto
                mt_pedido := mt_pedido + ((ali)->pquantd*(ali)->pvlr_fat - mdesconto)
                mtot_quant = mtot_quant + (ali)->pquantd
                mtot_itens ++
                SKIP
        ENDDO
        mcust_real = mt_pedido + mtot_desc
        RETURN NIL
ENDIF
*/
IF m_set[1,86] = 'T' .AND. ali <> 'orcam' .AND. SUBSTR(mvia,1,6) <> '2a.via'         //.AND. ! EMPTY(mquantd)
        DEVPOS(PROW(),00);DEVOUT(CHR(15))
        @ PROW()+1,00 SAY ' '
        @ PROW(),00 SAY 'Emissao:'
        @ PROW(),10 SAY (ali)->pdat_ped
        @ PROW(),21 SAY (ali)->phora
        @ PROW(),30 SAY 'Cod.:'
        @ PROW(),35 SAY (ali)->pcod_vend
        IF m_set[1,81] = 'S'
                @ PROW(),39 SAY (ali)->pvendedor
        ENDIF
        @ PROW()+1,00 SAY mtraco
        DEVPOS(PROW()+1,00);DEVOUT(' ')
        @ PROW(),00 SAY STRZERO(mnum_ped,6)
        DEVPOS(PROW(),00);DEVOUT(CHR(18))
        DEVPOS(PROW()+1,00);DEVOUT('Valor R$: '+TRANSFORM(mt_pedido,'999,999.99'))
        DEVPOS(PROW(),00);DEVOUT(CHR(15))
        @ PROW()+4,00 SAY '--------------------------- Corte aqui --------------------'
        imprt(mtipo_imp,'N',2)
ENDIF
FOR i = 1 TO mquantd
        GO mpoint
        IF i = mquantd .AND. (! EMPTY(m_indiv[1,8]) .OR. ! EMPTY(m_indiv[1,13]))
                SET DEVICE TO SCREEN;SET PRINT TO;SET PRINT OFF
                opcao := op_simnao('S','Imprimir na 2¦ porta de impressao [S/n]:')
                IF opcao = 'N'
                        EXIT
                ENDIF
                SET DEVICE TO PRINT
                SET PRINT TO (IF(! EMPTY(m_indiv[1,8]),m_indiv[1,8],m_indiv[1,13]))
        ENDIF
        mtot_itens := mt_pedido := mtot_desc := mtot_quant := mdesconto := 0
        DEVPOS(PROW(),00);DEVOUT(CHR(15))
        IF m_set[1,22] = 'S'
                IF mmult_emp = 'N'
                        DEVPOS(PROW()+1,00);DEVOUT(PADC(ALLTRIM(memp_resa),40))
                        DEVPOS(PROW()+1,00);DEVOUT(PADC(RTRIM(mend_firm),40))
                        DEVPOS(PROW()+1,00);DEVOUT(PADC(RTRIM(mcid_firm),40))
                        DEVPOS(PROW()+1,00);DEVOUT(PADC(RTRIM('Fone: '+mfone_firm),40))
                        @ PROW()+1,00 SAY mtraco
                ELSE
                        ver_emp((ali)->pempresa)
                        DEVPOS(PROW()+1,00);DEVOUT(PADC(ALLTRIM(IF(emp->nome_cab = 'F',emp->fantasia,emp->razao)),40))
                        IF SUBSTR(emp->apre3,1,2) = '* '
                                DEVPOS(PROW()+1,00);DEVOUT(PADC(ALLTRIM(LEFT(emp->apre3,35)),40))
                        ENDIF
                        DEVPOS(PROW()+1,00);DEVOUT(PADC(RTRIM(emp->endereco),40))
                        DEVPOS(PROW()+1,00);DEVOUT(PADC(RTRIM(emp->cidade)+'-'+RTRIM(emp->uf),40))
                        DEVPOS(PROW()+1,00);DEVOUT(PADC(RTRIM('Fone: '+emp->fone),40))
                        @ PROW()+1,00 SAY mtraco
                ENDIF
        ENDIF
        @ PROW()+1,00 SAY IF(ali='orcam',ALLTRIM(m_set[1,24]),ALLTRIM(m_set[1,23]))
        @ PROW(),PCOL()+1 SAY STRZERO(mnum_ped,6)
        @ PROW(),PCOL()+2 SAY mvia+'  T:'+ALLTRIM((ali)->ptermina)
        IF SUBSTR(mvia,1,6) = '2a.via'
                IF (ali)->ppag = '*'
                        @ PROW()+1,00 SAY 'Situacao: PAGO'
                ELSEIF (ali)->ppag = 'C'
                        @ PROW()+1,00 SAY 'Situacao: CANCELADO - MOTIVO: '+(ali)->pmotivo
                ELSE
                        @ PROW()+1,00 SAY 'Situacao: ABERTO'
                ENDIF
                @ PROW()+1,00 SAY mtraco
                @ PROW()+1,00 SAY '2a.via:'
                @ PROW(),PCOL()+1 SAY mdata_sis
                @ PROW(),PCOL()+1 SAY 'Hora:'
                @ PROW(),PCOL()+1 SAY SUBSTR(TIME(),1,5)
                @ PROW(),PCOL()+2 SAY 'Op.:'
                @ PROW(),PCOL()+1 SAY cod_operado
                @ PROW()+1,00 SAY mtraco
        ENDIF
        IF ver_serie() <> '141237'
                @ PROW()+1,00 SAY PADC('*** SEM VALOR FISCAL ***',40)
        ENDIF
        IF mcod_cli > 0
                ver_cli(mcod_cli,,,'*')
                @ PROW()+1,00 SAY 'Cliente:'
                @ PROW(),PCOL()+1 SAY cli->cod_cli
                @ PROW(),PCOL()+1 SAY LEFT(cli->razao,25)
                IF m_set[1,40] = 'S'
                        @ PROW()+1,00 SAY 'Fantasia:'
                        @ PROW(),PCOL()+1 SAY LEFT(cli->nome,30)
                ENDIF
                IF m_set[1,39] = 'S'
                        @ PROW()+1,00 SAY 'End.:'+LEFT(cli->endereco,33)
                        @ PROW()+1,00 SAY 'Bairro: '+RTRIM(cli->bairro)
                        @ PROW()+1,00 SAY 'Cidade: '+RTRIM(cli->cidade)+'-'+cli->uf
                        @ PROW()+1,00 SAY 'Fone: '+cli->tel1
                        IF mcgc <> SPACE(14)
                                @ PROW()+1,00 SAY 'CNPJ:'
                                DEVPOS(PROW(),PCOL()+1);DEVOUTPICT(cli->cgc,'@@R 99.999.999/9999-99')
                                DEVPOS(PROW()+1,00);DEVOUT('Insc.: '+cli->insc)
                        ELSEIF mcpf <> SPACE(11)
                                @ PROW()+1,00 SAY 'CPF:'
                                DEVPOS(PROW(),PCOL()+1);DEVOUTPICT(cli->cpf,'@@R 999.999.999-99')
                        ENDIF
                ENDIF
                IF ! EMPTY((ali)->pplaca) .OR. ! EMPTY((ali)->pcarro)
                        @ PROW()+1,00 SAY 'Placa do Veiculo: '+(ali)->pplaca+' Marca: '+(ali)->pcarro
                        @ PROW()+1,00 SAY 'Modelo..........: '+(ali)->pmodelo+'   KM: '+(ali)->pkm
                ENDIF
                @ PROW()+1,00 SAY mtraco
                @ PROW()+1,00 SAY 'Emissao:'
        ELSE
                @ PROW()+1,00 SAY 'Emissao:'
        ENDIF
        @ PROW(),08 SAY (ali)->pdat_ped
        @ PROW(),PCOL()+1 SAY SUBSTR((ali)->phora,1,5)
        @ PROW(),PCOL()+1 SAY 'Ope:'
        @ PROW(),PCOL() SAY (ali)->pcod_oper
        @ PROW(),PCOL()+1 SAY 'Cod.:'
        @ PROW(),PCOL() SAY (ali)->pcod_vend
        IF m_set[1,81] = 'S'
                @ PROW(),PCOL()+1 SAY LEFT((ali)->pvendedor,14)
        ENDIF
        @ PROW()+1,00 SAY mtraco

        @ PROW()+1,00 SAY 'Cod.'
        @ PROW(),15 SAY 'Descricao'
        @ PROW()+1,00 SAY 'UN'
        @ PROW(),PCOL()+2 SAY '   Quantd.'
        @ PROW(),PCOL()+2 SAY ' Vlr. Venda'
        @ PROW(),PCOL()+2 SAY ' Vlr. Total'
        @ PROW()+1,00 SAY mtraco
        IF ! EMPTY((ali)->plocal)
                @ PROW()+1,00 SAY 'localizacao: '+(ali)->plocal
        ENDIF
        mdesconto := 0
        WHILE STRZERO(mnum_ped,6) = (ali)->pnum_ped .AND. ! EOF()
                @ PROW()+1,00 SAY (ali)->pcod_merc
                IF ! EMPTY((ali)->penvelope) .AND. m_set[1,37] = 'N'
                        @ PROW(),06 SAY LEFT((ali)->pmerc,21)
                        @ PROW(),PCOL() SAY ' * '+(ali)->penvelope
                ELSE
                        @ PROW(),06 SAY LEFT((ali)->pmerc,34)
                ENDIF
                mdesconto := 0
                @ PROW()+1,00 SAY (ali)->punidade
                @ PROW(),PCOL()+2 SAY (ali)->pquantd PICT unidade((ali)->punidade,'*')
                @ PROW(),PCOL()+2 SAY (ali)->pvlr_fat PICT ALLTRIM(m_set[1,98])
                mcust_real = (ali)->pquantd * (ali)->pvlr_fat
                @ PROW(),PCOL()+2 SAY iat(mcust_real,2) PICT ALLTRIM(m_set[1,98])
                mtot_desc := mtot_desc + mdesconto
                mt_pedido := mt_pedido + ((ali)->pquantd*(ali)->pvlr_fat - mdesconto)
                mtot_itens ++
                IF ! EMPTY((ali)->pgramatura)
                        DEVPOS(PROW()+1,00);DEVOUT('Volume(s): '+TRANSFORM((ali)->pquantd * (ali)->pgramatura,'99,999.99'))
                        mtot_quant := mtot_quant + ((ali)->pquantd * (ali)->pgramatura)
                ELSE
                        mtot_quant := mtot_quant + (ali)->pquantd
                ENDIF
                IF ! EMPTY((ali)->chassis)
                        @ PROW()+1,00 SAY (ali)->chassis
                ENDIF
                IF ! EMPTY((ali)->pobs_prod)
                        DEVPOS(PROW()+1,00);DEVOUT((ali)->pobs_prod)
                ENDIF
                SKIP
                IF STRZERO(mnum_ped,6) = (ali)->pnum_ped .AND. ! EOF()
                        IF ! EMPTY((ali)->plocal)
                                @ PROW()+1,00 SAY 'localizacao: '+(ali)->plocal
                                @ PROW(),PCOL()+1 SAY REPLI('-',44)
                        ENDIF
                ENDIF
        ENDDO
        IF (SUBSTR(m_set[1,9],1,1) = 'S'.OR. SUBSTR(m_set[1,9],2,1) = 'S') .AND. ! EMPTY(mobs1)
                @ PROW()+1,00 SAY mtraco
                @ PROW()+1,00 SAY 'OBS.: '+mobs1+' '+mobs2
                @ PROW()+1,00 SAY '      '+mobs3+' '+mobs4
        ENDIF
        mobs_caixa := mobs1+' '+mobs2
        @ PROW()+1,00 SAY mtraco
        IF m_set[1,110] = 'S'
                @ PROW()+1,00 SAY 'Documentos Vencidos R$:'+TRANSFORM(mlim_venc,'9,999,999.99')
                @ PROW()+1,00 SAY 'Documentos A vencer R$:'+TRANSFORM(mlim_avenc,'9,999,999.99')
                @ PROW()+1,00 SAY 'Total...............R$:'+TRANSFORM(mtot_limite,'9,999,999.99')
                @ PROW()+1,00 SAY mtraco
        ENDIF
        mcust_real = mt_pedido + mtot_desc
        @ PROW()+1,00 SAY 'Total de Itens:'+TRANSFORM(mtot_itens,'999999')
        @ PROW()+1,00 SAY 'Volume Total..:'+TRANSFORM(mtot_quant,'999999')
        @ PROW()+1,00 SAY 'Sub-total.....:'+TRANSFORM(mt_pedido,'99,999,999.99')
        @ PROW()+1,00 SAY 'Desconto......:'+TRANSFORM(mtot_desc,'99,999,999.99')
        @ PROW()+1,00 SAY 'TOTAL DA NOTA.:'+TRANSFORM(iat(mcust_real,2),'99,999,999.99')
        @ PROW()+1,00 SAY mtraco
        IF mtp_venda = 'AV'
                @ PROW()+1,00 SAY 'Pagamento AVISTA'
                IF mcheque = '*'
                        DEVPOS(PROW()+1,00);DEVOUT('Modo de Pagamento: CHEQUE')
                ELSEIF mdinheiro = '*'
                        DEVPOS(PROW()+1,00);DEVOUT('Modo de Pagamento: DINHEIRO')
                ENDIF
        ELSEIF mdup = '*'
                IF VAL(SUBSTR(mcond_veze,2,2)) >= 2
                        @ PROW()+1,00 SAY 'Pag.APRAZO DUPLICATA: '+SUBSTR(mcondicao,1,1)+'+'+SUBSTR(mcondicao,2,2)+' p/'+STRZERO(m_dia[1],3)+'+'+STRZERO(m_dia[2],3)+' Dias'
                        IF VAL(SUBSTR(mcond_veze,1,1)) = 1
                                DEVPOS(PROW()+1,00);DEVOUT('Valor da Entrada R$:'+TRANSFORM(mvlr_ent,'99,999.99'))
                        ENDIF
                        DEVPOS(PROW()+1,00);DEVOUT('Venc.1o.:'+DTOC(mdata+m_dia[1]))
                        DEVPOS(PROW(),PCOL()+1);DEVOUT('Venc.2o.:'+DTOC(mdata+m_dia[2]))
                        IF VAL(SUBSTR(mcond_veze,2,2)) >= 3
                                DEVPOS(PROW(),PCOL()+1);DEVOUT('Venc.3o.:'+DTOC(mdata+m_dia[3]))
                        ENDIF
                        IF VAL(SUBSTR(mcond_veze,2,2)) >= 4
                                DEVPOS(PROW()+1,00);DEVOUT('Venc.4o.:'+DTOC(mdata+m_dia[4]))
                        ENDIF
                        IF VAL(SUBSTR(mcond_veze,2,2)) >= 5
                                DEVPOS(PROW(),PCOL()+1);DEVOUT('Venc.5o.:'+DTOC(mdata+m_dia[5]))
                        ENDIF
                        IF VAL(SUBSTR(mcond_veze,2,2)) >= 6
                                DEVPOS(PROW(),PCOL()+1);DEVOUT('Venc.6o.:'+DTOC(mdata+m_dia[6]))
                        ENDIF
                        IF VAL(SUBSTR(mcond_veze,2,2)) >= 7
                                DEVPOS(PROW()+1,00);DEVOUT('Venc.7o.:'+DTOC(mdata+m_dia[7]))
                        ENDIF
                        IF VAL(SUBSTR(mcond_veze,2,2)) >= 8
                                DEVPOS(PROW(),PCOL()+1);DEVOUT('Venc.8o.:'+DTOC(mdata+m_dia[8]))
                        ENDIF
                        IF VAL(SUBSTR(mcond_veze,2,2)) >= 9
                                DEVPOS(PROW(),PCOL()+1);DEVOUT('Venc.9o.:'+DTOC(mdata+m_dia[9]))
                        ENDIF
                        IF VAL(SUBSTR(mcond_veze,2,2)) >= 10
                                DEVPOS(PROW()+1,00);DEVOUT('Venc.10o:'+DTOC(mdata+m_dia[10]))
                        ENDIF
                        IF VAL(SUBSTR(mcond_veze,2,2)) >= 11
                                DEVPOS(PROW(),PCOL()+1);DEVOUT('Venc.11o:'+DTOC(mdata+m_dia[11]))
                        ENDIF
                        IF VAL(SUBSTR(mcond_veze,2,2)) >= 12
                                DEVPOS(PROW(),PCOL()+1);DEVOUT('Venc.12o:'+DTOC(mdata+m_dia[12]))
                        ENDIF
                ELSE
                        DEVPOS(PROW()+1,00);DEVOUT('Modo de Pagamento: DUPLICATA DE No.')
                        DEVPOS(PROW(),PCOL()+1);DEVOUT(STRZERO(mnum_ped,6))
                        @ PROW()+1,00 SAY 'Cond.Pag.:'+SUBSTR(mcondicao,1,1)+' + '+SUBSTR(mcondicao,2,2)+' Prazo:'+mprazo+' Dias'
                        IF VAL(SUBSTR(mcond_veze,1,1)) = 1
                                DEVPOS(PROW()+1,00);DEVOUT('Valor da Entrada R$:'+TRANSFORM(mvlr_ent,'99,999.99'))
                        ENDIF
                        @ PROW()+1,00 SAY 'Vencimento: '
                        @ PROW(),PCOL()+1 SAY mdata+VAL(mprazo)
                ENDIF
        ELSEIF mcheque = '*'
                DEVPOS(PROW()+1,00);DEVOUT('Modo de Pagamento: CHEQUE')
                @ PROW()+1,00 SAY 'Pag. APRAZO  -  Cond. pagamento: '+SUBSTR(mcondicao,1,1)+'+'+SUBSTR(mcondicao,2,2)+' Prazo: '+mprazo+' Dias'
                @ PROW()+1,00 SAY 'Vencimento: '
                @ PROW(),PCOL()+1 SAY mdata+VAL(mprazo)
        ELSEIF mcartao = '*'
                DEVPOS(PROW(),PCOL()+2);DEVOUT('Modo de Pagamento: CARTAO')
                @ PROW()+1,00 SAY 'Pagamento APRAZO'
        ELSEIF mfin = '*'
                        @ PROW()+1,00 SAY 'Pag. APRAZO'
                        DEVPOS(PROW(),PCOL()+2);DEVOUT('Modo: FINANCIAMENTO - '+STRZERO(mcod_fin,3)+'-'+fin->desc_fin)
                        DEVPOS(PROW()+1,00);DEVOUT('Condicao: '+TRANSFORM(mtipo_fin,'@R 9+99'))
                        IF mvalor_ent > 0
                                DEVPOS(PROW()+1,00);DEVOUT('- Entrada R$:')
                                DEVPOS(PROW(),PCOL()+1);DEVOUTPICT(mvalor_ent,'99,999.99')
                        ENDIF
                        i := 0
                        FOR i = 1 TO 12  //VAL(SUBSTR(mtipo_fin,2))
                                mdt_aux := mdata + (30*i)
                                IF i <= VAL(SUBSTR(mtipo_fin,2))
                                        DEVPOS(PROW()+1,00);DEVOUT('Venc.'+STRZERO(i,2)+':'+DTOC(mdt_aux))
                                        DEVPOS(PROW(),PCOL()+1);DEVOUT('- R$:'+TRANSFORM(mvalor_pres,'999,999.99'))
                                ENDIF
                        NEXT
        ENDIF
        @ PROW()+1,00 SAY mtraco
        @ PROW()+1,00 SAY PADC(RTRIM(LEFT(m_set[1,25],40)),40)
        @ PROW()+1,00 SAY PADC(RTRIM(LEFT(m_set[1,26],40)),40)
        @ PROW()+1,00 SAY PADC(RTRIM(LEFT(m_set[1,27],40)),40)
        @ PROW()+1,00 SAY PADC(RTRIM(LEFT(m_set[1,28],40)),40)
        @ PROW()+1,00 SAY mtraco
        IF m_set[1,22] = 'S'
                @ PROW()+1,00 SAY PADL('HTI Sistemas - (81)'+mfone_HTI,40)
        ENDIF
        IF mquantd > 1
                DEVPOS(PROW()+3,00);DEVOUT(CHR(18))
        ENDIF
        SETPRC(00,00)
NEXT
IF m_set[1,45] = 'S' .AND. m_set[1,47] = 'V' .AND. mdup = '*' .AND. ! EMPTY(mquantd) .AND. SUBSTR(mvia,1,6) <> '2a.via'
        f=0
        m_vlr[1] := m_vlr[2] := m_vlr[3] := m_vlr[4] := m_vlr[5] := m_vlr[6] := ;
        m_vlr[7] := m_vlr[8] := m_vlr[9] := m_vlr[10] := m_vlr[11] := ;
        m_vlr[12] := 0
        mdif := 0
        IF VAL(SUBSTR(mcond_veze,2,2)) >= 2
                m_vlr[1] := (mcust_real-mvlr_ent)/VAL(SUBSTR(mcond_veze,2,2))
                m_vlr[2] := (mcust_real-mvlr_ent)/VAL(SUBSTR(mcond_veze,2,2))
                IF VAL(SUBSTR(mcond_veze,2,2)) >= 3
                        m_vlr[3] := m_vlr[1]
                ENDIF
                IF VAL(SUBSTR(mcond_veze,2,2)) >= 4
                        m_vlr[4] := m_vlr[1]
                ENDIF
                IF VAL(SUBSTR(mcond_veze,2,2)) >= 5
                        m_vlr[5] := m_vlr[1]
                ENDIF
                IF VAL(SUBSTR(mcond_veze,2,2)) >= 6
                        m_vlr[6] := m_vlr[1]
                ENDIF
                IF VAL(SUBSTR(mcond_veze,2,2)) >= 7
                        m_vlr[7] := m_vlr[1]
                ENDIF
                IF VAL(SUBSTR(mcond_veze,2,2)) >= 8
                        m_vlr[8] := m_vlr[1]
                ENDIF
                IF VAL(SUBSTR(mcond_veze,2,2)) >= 9
                        m_vlr[9] := m_vlr[1]
                ENDIF
                IF VAL(SUBSTR(mcond_veze,2,2)) >= 10
                        m_vlr[10] := m_vlr[1]
                ENDIF
                IF VAL(SUBSTR(mcond_veze,2,2)) >= 11
                        m_vlr[11] := m_vlr[1]
                ENDIF
                IF VAL(SUBSTR(mcond_veze,2,2)) >= 12
                        m_vlr[12] := m_vlr[1]
                ENDIF
        ELSE
                m_vlr[1] := (mcust_real-mvlr_ent)
        ENDIF
        FOR f = 1 TO m_indiv[1,22]
                mdif := (mcust_real-mvlr_ent)- (iat(m_vlr[1],2)+iat(m_vlr[2],2)+;
                        iat(m_vlr[3],2)+iat(m_vlr[4],2)+iat(m_vlr[5],2)+iat(m_vlr[6],2)+;
                        iat(m_vlr[7],2)+iat(m_vlr[8],2)+iat(m_vlr[9],2)+iat(m_vlr[10],2)+;
                        iat(m_vlr[11],2)+iat(m_vlr[12],2))
                m_vlr[1] := m_vlr[1] + mdif
                i := 0
                FOR i = 1 TO VAL(SUBSTR(mcond_veze,2,2))
                        IF i = 1
                                mcust_real := m_vlr[1]
                                mdocumento := STRZERO(mnum_ped,6)
                        ELSEIF i = 2
                                mcust_real := m_vlr[2]
                                mprazo := STRZERO(m_dia[2],2)
                                mdocumento := STRZERO(mnum_ped,6)+'A'
                        ELSEIF i = 3
                                mcust_real := m_vlr[3]
                                mprazo := STRZERO(m_dia[3],2)
                                mdocumento := STRZERO(mnum_ped,6)+'B'
                        ELSEIF i = 4
                                mcust_real := m_vlr[4]
                                mprazo := STRZERO(m_dia[4],2)
                                mdocumento := STRZERO(mnum_ped,6)+'C'
                        ELSEIF i = 5
                                mcust_real := m_vlr[5]
                                mprazo := STRZERO(m_dia[5],2)
                                mdocumento := STRZERO(mnum_ped,6)+'D'
                        ELSEIF i = 6
                                mcust_real := m_vlr[6]
                                mprazo := STRZERO(m_dia[6],2)
                                mdocumento := STRZERO(mnum_ped,6)+'E'
                        ELSEIF i = 7
                                mcust_real := m_vlr[7]
                                mprazo := STRZERO(m_dia[7],2)
                                mdocumento := STRZERO(mnum_ped,6)+'F'
                        ELSEIF i = 8
                                mcust_real := m_vlr[8]
                                mprazo := STRZERO(m_dia[8],2)
                                mdocumento := STRZERO(mnum_ped,6)+'G'
                        ELSEIF i = 9
                                mcust_real := m_vlr[9]
                                mprazo := STRZERO(m_dia[9],2)
                                mdocumento := STRZERO(mnum_ped,6)+'H'
                        ELSEIF i = 10
                                mcust_real := m_vlr[10]
                                mprazo := STRZERO(m_dia[10],2)
                                mdocumento := STRZERO(mnum_ped,6)+'I'
                        ELSEIF i = 11
                                mcust_real := m_vlr[11]
                                mprazo := STRZERO(m_dia[11],2)
                                mdocumento := STRZERO(mnum_ped,6)+'J'
                        ELSEIF i = 12
                                mcust_real := m_vlr[12]
                                mprazo := STRZERO(m_dia[12],2)
                                mdocumento := STRZERO(mnum_ped,6)+'L'
                        ENDIF
                        @ PROW()+2,00 SAY '---------------------- Corte aqui --------------------'
                        @ PROW()+2,00 SAY ' '
                        IF m_set[1,22] = 'S'
                                IF mmult_emp = 'N'
                                        DEVPOS(PROW(),00);DEVOUT(memp_resa)
                                        DEVPOS(PROW()+1,00);DEVOUT(CHR(15))
                                        DEVPOS(PROW(),00);DEVOUT(mend_firm)
                                        DEVPOS(PROW()+1,00);DEVOUT(mcid_firm)
                                        DEVPOS(PROW()+1,00);DEVOUT('Fone: '+mfone_firm)
                                        DEVPOS(PROW()+1,00);DEVOUT('Inscr. '+minsc_firm+'   CNPJ: '+mcgc_firm)
                                ELSE
                                        DEVPOS(PROW(),00);DEVOUT(PADC(ALLTRIM(IF(emp->nome_cab = 'F',emp->fantasia,emp->razao)),54))
                                        DEVPOS(PROW()+1,00);DEVOUT(CHR(15))
                                        DEVPOS(PROW(),00);DEVOUT(emp->endereco)
                                        DEVPOS(PROW()+1,00);DEVOUT(emp->cidade)
                                        DEVPOS(PROW()+1,00);DEVOUT('Fone: '+emp->fone)
                                        DEVPOS(PROW()+1,00);DEVOUT('Inscr. '+emp->insc+'   CNPJ: '+emp->cnpj)
                                ENDIF
                                @ PROW()+1,00 SAY mtraco
                                @ PROW()+1,00 SAY ' '
                        ENDIF
                        IF mcod_cli > 0
                                @ PROW(),00 SAY 'Cliente:'
                                @ PROW(),PCOL()+1 SAY cli->cod_cli
                                @ PROW(),PCOL()+1 SAY LEFT(cli->razao,30)
                                @ PROW()+1,00 SAY 'End.:'+LEFT(cli->endereco,33)
                                @ PROW()+1,00 SAY 'Bairro: '+RTRIM(cli->bairro)
                                @ PROW()+1,00 SAY 'Cidade: '+RTRIM(cli->cidade)+'-'+cli->uf+'- Fone: '+cli->tel1
                                @ PROW()+1,00 SAY 'Fone: '+cli->tel1
                                IF mcgc <> SPACE(14)
                                        @ PROW()+1,00 SAY 'CNPJ:'
                                        DEVPOS(PROW(),PCOL()+1);DEVOUTPICT(cli->cgc,'@@R 99.999.999/9999-99')
                                        DEVPOS(PROW(),PCOL()+1);DEVOUT(' - Insc.: '+cli->insc)
                                ELSEIF mcpf <> SPACE(11)
                                        @ PROW()+1,00 SAY 'CPF:'
                                        DEVPOS(PROW(),PCOL()+1);DEVOUTPICT(cli->cpf,'@@R 999.999.999-99')
                                ENDIF
                                @ PROW()+1,00 SAY mtraco
                        ENDIF
                        @ PROW()+1,00 SAY CHR(18)
                        @ PROW(),00 SAY 'DUPLICATA No.:'
                        @ PROW(),15 SAY mdocumento
                        @ PROW()+1,00 SAY CHR(15)
                        @ PROW(),00 SAY 'Emissao:'
                        @ PROW(),PCOL()+1 SAY mdata
                        @ PROW(),PCOL()+2 SAY 'Venc.:'
                        @ PROW(),PCOL()+1 SAY mdata + VAL(mprazo)
                        @ PROW(),PCOL()+2 SAY 'Cod.:'
                        @ PROW(),PCOL()+1 SAY mcod_vend
                        @ PROW()+1,00 SAY mtraco
                        @ PROW()+1,00 SAY 'Fatura No.:               '
                        @ PROW(),30 SAY 'No.Duplicata:'
                        @ PROW()+1,00 SAY mtraco
                        DEVPOS(PROW()+1,00);DEVOUT(PADC('Valor R$: ('+LTRIM(TRANSFORM(iat(mcust_real,2),'99,999,999.99'))+')',54))
                        mextenso:= '('+RTRIM(EXT(iat(mcust_real,2),10))+')'
                        mlinha := MLCOUNT(mextenso,54)
                        FOR lin = 1 TO mlinha
                                mlin := MEMOLINE(mextenso,54,lin,,10)
                                DEVPOS(PROW()+1,00);DEVOUT(PADR(RTRIM(mlin),54))
                        NEXT
                        @ PROW()+1,00 SAY mtraco
                        mextenso:= 'Reconheco(cemos) a exatidao desta DUPLICATA DE VENDA MERCANTIL, na importancia acima que pagarei(emos) a '+m_set[1,129]+', ou a sua ordem na praca e vencimento indicados.'
                        mlinha := 0
                        mlinha := MLCOUNT(mextenso,40)
                        lin := 0
                        FOR lin = 1 TO mlinha
                                mlin := MEMOLINE(mextenso,40,lin,,10)
                                DEVPOS(PROW()+1,00);DEVOUT(RTRIM(mlin))
                        NEXT
                        @ PROW()+1,00 SAY mtraco
                        DEVPOS(PROW()+3,00);DEVOUT(PADC('---------------------------------------------',40))
                        DEVPOS(PROW()+1,00);DEVOUT(PADC('Assinatura do Emitente',40))
                        DEVPOS(PROW()+2,00);DEVOUT(PADC('Em         /        /        ',40))
                        DEVPOS(PROW()+1,00);DEVOUT(PADC('Data do Aceite',40))
                        DEVPOS(PROW()+3,00);DEVOUT(PADC('---------------------------------------------',40))
                        DEVPOS(PROW()+1,00);DEVOUT(PADC('Assinatura do Sacado',40))
                        DEVPOS(PROW()+3,00);DEVOUT(PADC('---------------------------------------------',40))
                        DEVPOS(PROW()+1,00);DEVOUT(PADC('Assinatura do Avalista',40))
                        @ PROW()+1,00 SAY mtraco
                        IF ! EMPTY(m_set[1,52])
                                @ PROW()+1,00 SAY PADC(RTRIM(m_set[1,52]),40)
                                @ PROW()+1,00 SAY PADC(RTRIM(m_set[1,53]),40)
                                @ PROW()+1,00 SAY mtraco
                        ENDIF
                NEXT
        NEXT
ENDIF
IF m_set[1,86] = 'S' .AND. ali <> 'orcam' .AND. SUBSTR(mvia,1,6) <> '2a.via'     //.AND. ! EMPTY(mquantd)
        GO mpoint
        DEVPOS(PROW(),00);DEVOUT(CHR(15))
        @ PROW()+2,00 SAY '-------------- Corte aqui -------------'
        @ PROW()+1,00 SAY ' '
        @ PROW()+1,00 SAY mtraco
        @ PROW()+1,00 SAY 'C A I X A'
        @ PROW(),00 SAY PADL(mvia,40)
        @ PROW()+1,00 SAY ' '
        IF mcod_cli > 0
                @ PROW(),00 SAY 'Cliente:'
                @ PROW(),PCOL()+1 SAY cli->cod_cli
                @ PROW(),PCOL()+1 SAY LEFT(cli->razao,30)
                IF ! EMPTY((ali)->pplaca) .OR. ! EMPTY((ali)->pcarro)
                        @ PROW()+1,00 SAY 'Placa do Veiculo: '+(ali)->pplaca+'  Tipo Veiculo: '+(ali)->pcarro
                ENDIF
                @ PROW()+1,00 SAY mtraco
                @ PROW()+1,00 SAY 'Emissao:'
        ELSE
                @ PROW(),00 SAY 'Emissao:'
        ENDIF
        @ PROW(),PCOL()+1 SAY (ali)->pdat_ped
        @ PROW(),PCOL()+2 SAY (ali)->phora
        @ PROW(),PCOL()+2 SAY 'Cod.:'
        @ PROW(),PCOL()+1 SAY (ali)->pcod_vend
        @ PROW()+1,00 SAY mtraco
        @ PROW()+1,00 SAY IF(ali='orcam',ALLTRIM(m_set[1,24]),ALLTRIM(m_set[1,23]))+' '+STRZERO(mnum_ped,6)
        DEVPOS(PROW()+1,00);DEVOUT('Valor R$: ('+LTRIM(TRANSFORM(mt_pedido + mtot_desc,'99,999,999.99'))+')')
*        IF ver_serie() = '141253'
*                DEVPOS(PROW()+1,00);DEVOUT('OBS.:'+mobs_caixa)
*        ENDIF
        IF mtp_venda = 'AV'
                @ PROW()+1,00 SAY 'Pagamento AVISTA'
                IF mcheque = '*'
                        DEVPOS(PROW(),PCOL()+1);DEVOUT(' em CHEQUE')
                ELSEIF mdinheiro = '*'
                        DEVPOS(PROW(),PCOL()+1);DEVOUT(' em DINHEIRO')
                ENDIF
        ELSE
                @ PROW()+1,00 SAY 'Pag. APRAZO - '+SUBSTR(mcondicao,1,1)+' + '+SUBSTR(mcondicao,2,2)+' p/'+mprazo+' Dias'
                @ PROW()+1,00 SAY 'Data do Vencimento: '
                @ PROW(),20 SAY mdata+VAL(mprazo)
                IF mdup = '*'
                        DEVPOS(PROW()+1,00);DEVOUT('Modo de Pag.: DUPLICATA ')
                        DEVPOS(PROW(),PCOL()+1);DEVOUT(STRZERO(mnum_ped,6))
                ELSEIF mcheque = '*'
                        DEVPOS(PROW()+1,00);DEVOUT('Modo de Pagamento: CHEQUE')
                ELSEIF mcartao = '*'
                        DEVPOS(PROW()+1,00);DEVOUT('Modo de Pagamento: CARTAO')
                ENDIF
        ENDIF
        @ PROW()+1,00 SAY mtraco
ENDIF
IF m_set[1,87] = 'S' .AND. m_set[1,88] = 'P' .AND. ali <> 'orcam' .AND. SUBSTR(mvia,1,6) <> '2a.via'    //.AND. ! EMPTY(mquantd)
        IF mporta_imp <> m_indiv[1,19]
                SET DEVICE TO SCREEN;SET PRINT TO;SET PRINT OFF
                SET DEVICE TO PRINT
                SET PRINT TO (m_indiv[1,19])
        ENDIF
        @ PROW()+2,00 SAY '---------------------- Corte aqui --------------------'
        @ PROW()+1,00 SAY ' '
        DEVPOS(PROW(),00);DEVOUT(CHR(15))
        @ PROW()+1,00 SAY mtraco
        DEVPOS(PROW(),00);DEVOUT(CHR(18))
        @ PROW()+1,00 SAY 'E M B A L A G E M'
        DEVPOS(PROW(),00);DEVOUT(CHR(15))
        @ PROW(),00 SAY PADL(mvia,40)
        @ PROW()+1,00 SAY ' '
        IF mcod_cli > 0
                @ PROW(),00 SAY 'Cliente:'
                @ PROW(),PCOL()+1 SAY cli->cod_cli
                @ PROW(),PCOL()+1 SAY LEFT(cli->razao,30)
                IF ! EMPTY((ali)->pplaca) .OR. ! EMPTY((ali)->pcarro)
                        @ PROW()+1,00 SAY 'Placa do Veiculo: '+(ali)->pplaca+'  Tipo Veiculo: '+(ali)->pcarro
                ENDIF
                @ PROW()+1,00 SAY mtraco
                @ PROW()+1,00 SAY 'Emissao:'
        ELSE
                @ PROW(),00 SAY 'Emissao:'
        ENDIF
        @ PROW(),10 SAY (ali)->pdat_ped
        @ PROW(),21 SAY (ali)->phora
        @ PROW(),30 SAY 'Cod.:'
        @ PROW(),35 SAY (ali)->pcod_vend
        IF m_set[1,81] = 'S'
                @ PROW(),39 SAY LEFT((ali)->pvendedor,15)
        ENDIF
        DEVPOS(PROW()+1,00);DEVOUT(CHR(15))
        @ PROW(),00 SAY mtraco
        DEVPOS(PROW(),00);DEVOUT(CHR(18))
        @ PROW()+1,00 SAY IF(ali='orcam',ALLTRIM(m_set[1,24]),ALLTRIM(m_set[1,23]))+' '+STRZERO(mnum_ped,6)
        DEVPOS(PROW()+1,00);DEVOUT('Valor R$: ('+LTRIM(TRANSFORM(mt_pedido + mtot_desc,'99,999,999.99'))+')')
*        IF ver_serie() = '141253'
*                DEVPOS(PROW(),00);DEVOUT(CHR(15))
*                DEVPOS(PROW()+1,00);DEVOUT('OBS.:'+mobs_caixa)
*        ENDIF
        DEVPOS(PROW(),00);DEVOUT(CHR(18))
        IF mtp_venda = 'AV'
                @ PROW()+1,00 SAY 'Pagamento AVISTA'
                IF mcheque = '*'
                        DEVPOS(PROW(),PCOL()+1);DEVOUT(' em CHEQUE')
                ELSEIF mdinheiro = '*'
                        DEVPOS(PROW(),PCOL()+1);DEVOUT(' em DINHEIRO')
                ENDIF
        ELSE
                @ PROW()+1,00 SAY 'Pag. APRAZO - '+SUBSTR(mcondicao,1,1)+' + '+SUBSTR(mcondicao,2,2)+' p/'+mprazo+' Dias'
                @ PROW()+1,00 SAY 'Data do Vencimento: '
                @ PROW(),20 SAY mdata+VAL(mprazo)
                IF mdup = '*'
                        DEVPOS(PROW()+1,00);DEVOUT('Modo de Pag.: DUPLICATA ')
                        DEVPOS(PROW(),PCOL()+1);DEVOUT(STRZERO(mnum_ped,6))
                ELSEIF mcheque = '*'
                        DEVPOS(PROW()+1,00);DEVOUT('Modo de Pagamento: CHEQUE')
                ELSEIF mcartao = '*'
                        DEVPOS(PROW()+1,00);DEVOUT('Modo de Pagamento: CARTAO')
                ENDIF
        ENDIF
        DEVPOS(PROW(),00);DEVOUT(CHR(15))
        @ PROW()+1,00 SAY mtraco
ENDIF
IF mop = 'S' .OR.  (m_set[1,45] = 'S' .AND. m_set[1,47] = 'V' .AND. mdup = '*')
        DEVPOS(PROW()+m_indiv[1,16],00);DEVOUT(CHR(18))
ENDIF
SETPRC(00,00)
SET DEVICE TO SCREEN;SET PRINT TO;SET PRINT OFF
RETURN NIL
***************************** F I M ***********************************
* IMPRIMIR TICKET EMBALAGEM
FUNCTION imp_emba(mn_pedido,mcx)
********************************
LOCAL mtraco:=REPLI('-',54),;
      mpeso_brut,mpeso_liq,mtot_desc,mt_pedido,mtot_quant,mtot_itens,;
      mtot_prazo,mperc,mdesconto,mtot_ipi,mobs1,mobs2,mobs3,mobs4,mcod_fab,;
      c_cli:={},c_merc:={},cont:=0

MEMVAR mcliente,mcgc,mcpf,mimp_tipo

mpeso_brut := mpeso_liq := mtot_desc := mt_pedido := mtot_quant := mtot_itens:=;
mtot_prazo := mperc := mdesconto := mtot_ipi := 0
mimp_tipo:=1
IF ! AbriArq('sacped_s','ped_s');RETURN NIL;ENDIF
IF ! AbriArq('saccli','cli');RETURN NIL;ENDIF

mcons_ped := {}
sr_getconnection():exec("SELECT * FROM sacped_s WHERE sr_deleted = ' ' AND pnum_ped = "+sr_cdbvalue(STRZERO(mn_pedido,6)),,.t.,@mcons_ped)
sr_getconnection():exec('COMMIT',,.f.)
IF LEN(mcons_ped) = 0
        atencao('PEDIDO nao foi encontrado !!!!')
ENDIF

IF ver_serie() = '141425'   //.OR. ver_serie() = '141477'
        mtraco:=REPLI('-',80)
        IF ! imp_arq('TK'+STRZERO(mn_pedido,6)+'.REL','K')
                RETURN .F.
        ENDIF
        ver_cli(VAL(mcons_ped[1,23]),,,'*')
        mpag := mcons_ped[1,49]
        imprt(mtipo_imp,'N+')
        imprt(mtipo_imp,'W1')
        DEVPOS(PROW(),00);DEVOUT(memp_resa)
        imprt(mtipo_imp,'N-')
        imprt(mtipo_imp,'W0')
        imprt(mtipo_imp,'C')
        DEVPOS(PROW()+1,00);DEVOUT(RTRIM(m_set[1,132])+'-'+RTRIM(m_set[1,133])+'-'+RTRIM(m_set[1,134])+'-'+RTRIM(m_set[1,19])+' - Fone: '+m_set[1,136])
        imprt(mtipo_imp,'N')
        @ PROW()+1,00 SAY mtraco
        @ PROW()+1,00 SAY ''
        imprt(mtipo_imp,'E')
        @ PROW(),10 SAY ALLTRIM(m_set[1,23])+' '+STRZERO(mn_pedido,6)
        imprt(mtipo_imp,'N')
        imprt(mtipo_imp,'C')
        @ PROW()+1,00 SAY 'Emissao:'
        @ PROW(),PCOL()+1 SAY mcons_ped[1,4]
        @ PROW(),PCOL()+2 SAY 'Hora:'
        @ PROW(),PCOL()+1 SAY mcons_ped[1,47]
        @ PROW(),PCOL()+2 SAY 'Ope:'
        @ PROW(),PCOL() SAY mcons_ped[1,34]
        @ PROW(),PCOL()+2 SAY 'Cod.:'
        @ PROW(),PCOL()+1 SAY mcons_ped[1,32]
        @ PROW(),PCOL()+4 SAY 'T:'+ALLTRIM(mcons_ped[1,3])
        imprt(mtipo_imp,'N')
        @ PROW()+1,00 SAY mcod_cli
        @ PROW(),PCOL()+1 SAY cli->razao
        imprt(mtipo_imp,'C')
        IF ! EMPTY(cli->cgc)
               @ PROW(),77 SAY 'CNPJ:'
                DEVPOS(PROW(),PCOL()+1);DEVOUTPICT(cli->cgc,'@@R 99.999.999/9999-99')
                DEVPOS(PROW(),PCOL()+1);DEVOUT('-IE: '+cli->insc)
        ELSEIF ! EMPTY(cli->cpf)
                @ PROW(),77 SAY 'CPF:'
                DEVPOS(PROW(),PCOL()+1);DEVOUTPICT(cli->cpf,'@@R 999.999.999-99')
        ENDIF
        @ PROW()+1,00 SAY 'End.: '+cli->endereco+', '+RTRIM(cli->numero)+IF(! EMPTY(RTRIM(cli->complemento)),' - Compl.:'+RTRIM(cli->complemento),'')+' - '+cli->bairro+' - '+cli->cidade+'- '+cli->uf+'- Fone:'+cli->tel1+' - CEP.:'+cli->cep
        imprt(mtipo_imp,'N')
        @ PROW()+1,00 SAY mtraco
        @ PROW()+1,00 SAY 'Cod.'
        @ PROW(),07 SAY 'Descricao                               '
        @ PROW(),PCOL()+2 SAY ' Loc'
        @ PROW(),PCOL()+1 SAY 'UN '
        @ PROW(),PCOL()+2 SAY '  Quantd.'
        @ PROW()+1,00 SAY mtraco
        i := 0
        FOR i = 1 TO LEN(mcons_ped)
                ver_cod(VAL(mcons_ped[i,6]),,,,,'*')
                @ PROW()+1,00 SAY mcons_ped[i,6]+'-'+mcons_ped[i,7]+'      '+mcons_ped[i,8]
                @ PROW(),PCOL()+2 SAY TRANSFORM(mcons_ped[i,14],'99,999.99')
                IF ! EMPTY(mcons_ped[1,10]) .OR. ! EMPTY(mcons_ped[i,58])
                        imprt(mtipo_imp,'W1')
                        imprt(mtipo_imp,'N+')
                        DEVPOS(PROW()+1,00);DEVOUT(IF(! EMPTY(mcons_ped[i,10]),ALLTRIM(mcons_ped[i,10]),'')+IF(! EMPTY(mcons_ped[i,58]),' - '+ALLTRIM(mcons_ped[i,58]),''))
                        imprt(mtipo_imp,'W0')
                        imprt(mtipo_imp,'N-')
                ENDIF
        NEXT
        @ PROW()+1,00 SAY mtraco
        EJECT
        SETPRC(00,00)
        SET DEVI TO SCREEN;SET PRINT TO;SET PRINT OFF
        conf_impressao('TK'+STRZERO(mn_pedido,6)+'.REL')
ELSEIF m_set[1,90] = 'B'
        IF ! imp_arq('TK'+STRZERO(mn_pedido,6)+'.REL','K')
                RETURN .F.
        ENDIF
        mcons_caixa := {}
        sr_getconnection():exec("SELECT * FROM saccaixa WHERE nota = "+sr_cdbvalue('PD'+STRZERO(mn_pedido,6)),,.t.,@mcons_caixa)
        sr_getconnection():exec('COMMIT',,.f.)

        ver_cli(VAL(mcons_ped[1,23]),,,'*')
        mpag := mcons_ped[1,49]
        DEVPOS(PROW(),00);DEVOUT(CHR(15))
        @ PROW()+1,00 SAY mtraco
        DEVPOS(PROW(),00);DEVOUT(CHR(18))
        @ PROW()+1,00 SAY 'E M B A L A G E M'
        DEVPOS(PROW(),00);DEVOUT(CHR(15))
        @ PROW()+1,00 SAY ' '
        @ PROW(),00 SAY 'Cliente:'
        @ PROW(),09 SAY cli->cod_cli
        @ PROW(),15 SAY cli->razao
        IF ! EMPTY(mcons_ped[1,26]) .OR. ! EMPTY(mcons_ped[1,27])
                @ PROW()+1,00 SAY 'Placa do Veiculo: '+mcons_ped[1,26]+'  Tipo Veiculo: '+mcons_ped[1,27]
        ENDIF
        @ PROW()+1,00 SAY mtraco
        @ PROW()+1,00 SAY 'Emissao:'
        @ PROW(),10 SAY mcons_ped[1,4]
        @ PROW(),21 SAY mcons_ped[1,47]
        @ PROW(),30 SAY 'Cod.:'
        @ PROW(),35 SAY mcons_ped[1,32]
        @ PROW(),PCOL()+1 SAY 'Trm:'+ALLTRIM(mcons_ped[1,3])
        IF LEN(mcons_caixa) > 0
                @ PROW()+1,00 SAY 'Caixa: '+mcons_caixa[1,17]+'  -  Recebimento: '+DTOC(mcons_caixa[1,3])+' - '+mcons_caixa[1,21]
        ENDIF
        //@ PROW()+1,00 SAY 'Data Pagamento:'
        //@ PROW(),PCOL()+1 SAY mdata_sis
        //@ PROW(),PCOL()+1 SAY 'Hora:'
        //@ PROW(),PCOL()+1 SAY TIME()
        DEVPOS(PROW()+1,00);DEVOUT(CHR(15))
        @ PROW(),00 SAY mtraco
        DEVPOS(PROW(),00);DEVOUT(CHR(18))
        @ PROW()+1,00 SAY ALLTRIM(m_set[1,23])+' '+STRZERO(mn_pedido,6)
        mt_pedido := {}
        sr_getconnection():exec("SELECT SUM(pquantd*pvlr_fat) FROM sacped_s WHERE sr_deleted = ' ' AND pnum_ped = "+sr_cdbvalue(STRZERO(mn_pedido,6)),,.t.,@mt_pedido)
        sr_getconnection():exec('COMMIT',,.f.)
        DEVPOS(PROW()+1,00);DEVOUT('Valor R$: ('+LTRIM(TRANSFORM(mt_pedido[1,1],'99,999,999.99'))+')')
        DEVPOS(PROW(),00);DEVOUT(CHR(18))
        DEVPOS(PROW()+1,00);DEVOUT('FORMA DE PAGAMENTO')
        IF mcx <> NIL
                i := 0
                FOR i = 1 TO LEN(m_alt)
                        DEVPOS(PROW()+1,00);DEVOUT(SUBSTR(m_alt[i],1,13))
                NEXT
        ELSE
                DEVPOS(PROW(),00);DEVOUT(CHR(15))
                IF mtp_venda = 'AV'
                        @ PROW()+1,00 SAY 'Pagamento AVISTA'
                        IF mcheque = '*'
                                DEVPOS(PROW()+1,00);DEVOUT('Modo de Pagamento: CHEQUE')
                        ELSEIF mdinheiro = '*'
                                DEVPOS(PROW()+1,00);DEVOUT('Modo de Pagamento: DINHEIRO')
                        ENDIF
                ELSEIF mdup = '*'
                        IF VAL(SUBSTR(mcond_veze,2,2)) >= 2
                                @ PROW()+1,00 SAY 'Pag.APRAZO DUPLICATA: '+SUBSTR(mcondicao,1,1)+'+'+SUBSTR(mcondicao,2,2)+' p/'+STRZERO(m_dia[1],3)+'+'+STRZERO(m_dia[2],3)+' Dias'
                                IF VAL(SUBSTR(mcond_veze,1,1)) = 1
                                        DEVPOS(PROW()+1,00);DEVOUT('Valor da Entrada R$:'+TRANSFORM(mvlr_ent,'99,999.99'))
                                ENDIF
                                DEVPOS(PROW()+1,00);DEVOUT('Venc.1o.:'+DTOC(mdata+m_dia[1]))
                                DEVPOS(PROW(),PCOL()+1);DEVOUT('Venc.2o.:'+DTOC(mdata+m_dia[2]))
                                IF VAL(SUBSTR(mcond_veze,2,2)) >= 3
                                        DEVPOS(PROW(),PCOL()+1);DEVOUT('Venc.3o.:'+DTOC(mdata+m_dia[3]))
                                ENDIF
                                IF VAL(SUBSTR(mcond_veze,2,2)) >= 4
                                        DEVPOS(PROW()+1,00);DEVOUT('Venc.4o.:'+DTOC(mdata+m_dia[4]))
                                ENDIF
                                IF VAL(SUBSTR(mcond_veze,2,2)) >= 5
                                        DEVPOS(PROW(),PCOL()+1);DEVOUT('Venc.5o.:'+DTOC(mdata+m_dia[5]))
                                ENDIF
                                IF VAL(SUBSTR(mcond_veze,2,2)) >= 6
                                        DEVPOS(PROW(),PCOL()+1);DEVOUT('Venc.6o.:'+DTOC(mdata+m_dia[6]))
                                ENDIF
                                IF VAL(SUBSTR(mcond_veze,2,2)) >= 7
                                        DEVPOS(PROW()+1,00);DEVOUT('Venc.7o.:'+DTOC(mdata+m_dia[7]))
                                ENDIF
                                IF VAL(SUBSTR(mcond_veze,2,2)) >= 8
                                        DEVPOS(PROW(),PCOL()+1);DEVOUT('Venc.8o.:'+DTOC(mdata+m_dia[8]))
                                ENDIF
                                IF VAL(SUBSTR(mcond_veze,2,2)) >= 9
                                        DEVPOS(PROW(),PCOL()+1);DEVOUT('Venc.9o.:'+DTOC(mdata+m_dia[9]))
                                ENDIF
                                IF VAL(SUBSTR(mcond_veze,2,2)) >= 10
                                        DEVPOS(PROW()+1,00);DEVOUT('Venc.10o:'+DTOC(mdata+m_dia[10]))
                                ENDIF
                                IF VAL(SUBSTR(mcond_veze,2,2)) >= 11
                                        DEVPOS(PROW(),PCOL()+1);DEVOUT('Venc.11o:'+DTOC(mdata+m_dia[11]))
                                ENDIF
                                IF VAL(SUBSTR(mcond_veze,2,2)) >= 12
                                        DEVPOS(PROW(),PCOL()+1);DEVOUT('Venc.12o:'+DTOC(mdata+m_dia[12]))
                                ENDIF
                        ELSE
                                DEVPOS(PROW()+1,00);DEVOUT('Modo de Pagamento: DUPLICATA DE No.')
                                DEVPOS(PROW(),PCOL()+1);DEVOUT(STRZERO(mnum_ped,6))
                                @ PROW()+1,00 SAY 'Cond.Pag.:'+SUBSTR(mcondicao,1,1)+' + '+SUBSTR(mcondicao,2,2)+' Prazo:'+mprazo+' Dias'
                                IF VAL(SUBSTR(mcond_veze,1,1)) = 1
                                        DEVPOS(PROW()+1,00);DEVOUT('Valor da Entrada R$:'+TRANSFORM(mvlr_ent,'99,999.99'))
                                ENDIF
                                @ PROW()+1,00 SAY 'Vencimento: '
                                @ PROW(),PCOL()+1 SAY mdata+VAL(mprazo)
                        ENDIF
                ELSEIF mcheque = '*'
                        DEVPOS(PROW()+1,00);DEVOUT('Modo de Pagamento: CHEQUE')
                        @ PROW()+1,00 SAY 'Pag. APRAZO  -  Cond. pagamento: '+SUBSTR(mcondicao,1,1)+'+'+SUBSTR(mcondicao,2,2)+' Prazo: '+mprazo+' Dias'
                        @ PROW()+1,00 SAY 'Vencimento: '
                        @ PROW(),PCOL()+1 SAY mdata+VAL(mprazo)
                ELSEIF mcartao = '*'
                        DEVPOS(PROW(),PCOL()+2);DEVOUT('Modo de Pagamento: CARTAO')
                        @ PROW()+1,00 SAY 'Pagamento APRAZO'
                ELSEIF mfin = '*'
                                @ PROW()+1,00 SAY 'Pag. APRAZO'
                                DEVPOS(PROW(),PCOL()+2);DEVOUT('Modo: FINANCIAMENTO - '+STRZERO(mcod_fin,3)+'-'+fin->desc_fin)
                                DEVPOS(PROW()+1,00);DEVOUT('Condicao: '+TRANSFORM(mtipo_fin,'@R 9+99'))
                                IF mvalor_ent > 0
                                        DEVPOS(PROW()+1,00);DEVOUT('- Entrada R$:')
                                        DEVPOS(PROW(),PCOL()+1);DEVOUTPICT(mvalor_ent,'99,999.99')
                                ENDIF
                                i := 0
                                FOR i = 1 TO 12  //VAL(SUBSTR(mtipo_fin,2))
                                        mdt_aux := mdata + (30*i)
                                        IF i <= VAL(SUBSTR(mtipo_fin,2))
                                                DEVPOS(PROW()+1,00);DEVOUT('Venc.'+STRZERO(i,2)+':'+DTOC(mdt_aux))
                                                DEVPOS(PROW(),PCOL()+1);DEVOUT('- R$:'+TRANSFORM(mvalor_pres,'999,999.99'))
                                        ENDIF
                                NEXT
                ENDIF
        ENDIF
        DEVPOS(PROW(),00);DEVOUT(CHR(15))
        @ PROW()+1,00 SAY mtraco
        DEVPOS(PROW()+2,00);DEVOUT(CHR(18))
        @ PROW(),00 SAY '---------------------- Corte aqui --------------------'
        DEVPOS(PROW()+m_indiv[1,16],00);DEVOUT(CHR(18))
        SETPRC(00,00)
        SET DEVICE TO SCREEN;SET PRINT TO;SET PRINT OFF
        conf_impressao('TK'+STRZERO(mn_pedido,6)+'.REL')
ELSE
        IF ! imp_arq('TK'+STRZERO(mn_pedido,6)+'.REL','K')
               RETURN .F.
        ENDIF
        //SET DEVICE TO PRINT
        //SET PRINT TO (m_indiv[1,19])
        mtraco := REPLI('-',80)
        imppedido:={}
        cComm  := "SELECT * FROM sacped_s WHERE sr_deleted = ' ' AND pnum_ped = "+sr_cdbvalue(STRZERO(mnum_ped,6))
        ccomm := ccomm +" ORDER BY pcod_fab,pmerc"
        sr_getconnection():exec(ccomm,,.t.,@imppedido)
        sr_getconnection():exec('COMMIT',,.f.)

        c_cli := {}
        sr_getconnection():exec("SELECT * FROM saccli WHERE cod_cli = "+sr_cdbvalue(imppedido[1,23]),,.t.,@c_cli)
        sr_getconnection():exec('COMMIT',,.f.)

        mtot_prazo := mt_pedido := mtot_desc := mtot_quant := mperc := ;
        mdesconto := mtot_ipi := 0
        IF mtipo_imp = 'M'
                imprt(mtipo_imp,'P8')
        ENDIF
        imprt(mtipo_imp,'N')
        IF m_set[1,22] = 'S'
                imprt(mtipo_imp,'E')
                DEVPOS(PROW(),00);DEVOUT(memp_resa)
                imprt(mtipo_imp,'C')
                DEVPOS(PROW()+1,00);DEVOUT(RTRIM(m_set[1,132])+'-'+RTRIM(m_set[1,133])+'-'+RTRIM(m_set[1,134])+'-'+RTRIM(m_set[1,19])+' - Fone: '+m_set[1,136])
                imprt(mtipo_imp,'N')
                @ PROW()+1,00 SAY mtraco
        ENDIF
        imprt(mtipo_imp,'E',1)
        @ PROW(),10 SAY ALLTRIM(m_set[1,23])+' '+STRZERO(mn_pedido,6)
        imprt(mtipo_imp,'C')
        @ PROW()+1,00 SAY 'Emissao:'
        @ PROW(),PCOL()+1 SAY imppedido[1,4]
        @ PROW(),PCOL()+2 SAY 'Hora:'
        @ PROW(),PCOL()+1 SAY imppedido[1,47]
        @ PROW(),PCOL()+2 SAY 'Ope:'
        @ PROW(),PCOL() SAY imppedido[1,34]
        @ PROW(),PCOL()+2 SAY 'Cod.:'
        @ PROW(),PCOL()+1 SAY imppedido[1,32]
        IF mimp_tipo <> 2
                imprt(mtipo_imp,'C')
        ENDIF
        @ PROW(),00 SAY PADL('T:'+ALLTRIM(imppedido[1,3]),132)
        imprt(mtipo_imp,'N')
        @ PROW()+1,00 SAY mcod_cli
        @ PROW(),PCOL()+1 SAY c_cli[1,3]
        imprt(mtipo_imp,'C')
        IF ! EMPTY(c_cli[1,32])
               @ PROW(),77 SAY 'CNPJ:'
                DEVPOS(PROW(),PCOL()+1);DEVOUTPICT(c_cli[1,32],'@@R 99.999.999/9999-99')
                DEVPOS(PROW(),PCOL()+1);DEVOUT('-IE: '+c_cli[1,33])
        ELSEIF ! EMPTY(c_cli[1,34])
                @ PROW(),77 SAY 'CPF:'
                DEVPOS(PROW(),PCOL()+1);DEVOUTPICT(c_cli[1,34],'@@R 999.999.999-99')
        ENDIF
        @ PROW()+1,00 SAY 'End.: '+c_cli[1,21]+' - '+c_cli[1,22]+' - '+c_cli[1,24]+'- '+c_cli[1,25]+'- Fone:'+c_cli[1,29]+' - CEP.:'+c_cli[1,26]
        imprt(mtipo_imp,'N')
        @ PROW()+1,00 SAY mtraco
        @ PROW()+1,00 SAY 'Cod.'
        @ PROW(),07 SAY 'Descricao                               '
        @ PROW(),PCOL()+2 SAY ' Loc'
        @ PROW(),PCOL()+1 SAY 'UN '
        @ PROW(),PCOL()+2 SAY ' Quantidade'
        @ PROW()+1,00 SAY mtraco
        IF m_set[1,9] = 'S'
                mpagina := 25
        ELSE
                mpagina := 27
        ENDIF
        mdesconto := cont_emb := 0
        FOR cont_emb = 1 TO LEN(imppedido)
                imprt(mtipo_imp,'N')
                //ver_cod(VAL(mcons_ped[1,6]),,,,0,'*')
                @ PROW()+1,00 SAY imppedido[cont_emb,6]
                @ PROW(),PCOL()+2 SAY imppedido[cont_emb,7]
                @ PROW(),PCOL()+2 SAY imppedido[cont_emb,92]
                @ PROW(),PCOL()+1 SAY imppedido[cont_emb,8]
                @ PROW(),PCOL()+2 SAY imppedido[cont_emb,14] PICT unidade(imppedido[cont_emb,14],'*')
                mpeso_brut := mpeso_brut + (imppedido[cont_emb,11] * imppedido[cont_emb,14])
                mpeso_liq := mpeso_liq + (imppedido[cont_emb,12] * imppedido[cont_emb,14])
                mtot_desc := mtot_desc + mdesconto
                mt_pedido := mt_pedido + (imppedido[cont_emb,14]*imppedido[cont_emb,18] - mdesconto)
                mtot_quant = mtot_quant + imppedido[cont_emb,14]
                mtot_itens ++
                IF PROW() >= mpagina 
                        imprt(mtipo_imp,'N')
                        @ PROW()+1,00 SAY mtraco
                        imprt(mtipo_imp,'N')
                        EJECT
                        IF m_set[1,22] = 'S'
                                imprt(mtipo_imp,'E')
                                DEVPOS(PROW(),00);DEVOUT(memp_resa)
                                imprt(mtipo_imp,'C')
                                DEVPOS(PROW()+1,00);DEVOUT(RTRIM(m_set[1,132])+'-'+RTRIM(m_set[1,133])+'-'+RTRIM(m_set[1,134])+'-'+RTRIM(m_set[1,19])+' - Fone: '+m_set[1,136])
                                imprt(mtipo_imp,'N')
                                @ PROW()+1,00 SAY mtraco
                        ENDIF
                        @ PROW()+1,10 SAY '  '
                        imprt(mtipo_imp,'E')
                        @ PROW(),10 SAY ALLTRIM(m_set[1,23])+' '+STRZERO(mn_pedido,6)
                        imprt(mtipo_imp,'N')
                        @ PROW()+1,00 SAY 'Cliente:'
                        @ PROW(),PCOL()+1 SAY mcod_cli
                        @ PROW(),PCOL()+1 SAY c_cli[1,3]
                        @ PROW()+1,00 SAY 'Emissao:'
                        @ PROW(),10 SAY mdata
                        @ PROW(),20 SAY 'Hora:'
                        @ PROW(),26 SAY mhora
                        @ PROW(),37 SAY 'Cod.:'
                        @ PROW(),43 SAY imppedido[1,32]
                        @ PROW(),00 SAY PADL('continuacao',80)
                        imprt(mtipo_imp,'N')
                        @ PROW()+1,00 SAY mtraco
                        @ PROW()+1,00 SAY 'Cod.'
                        @ PROW(),07 SAY 'Descricao                               '
                        @ PROW(),PCOL()+2 SAY ' Loc'
                        @ PROW(),PCOL()+1 SAY 'UN '
                        @ PROW(),PCOL()+2 SAY ' Quantidade'
                        @ PROW()+1,00 SAY mtraco
                ENDIF
        NEXT
        imprt(mtipo_imp,'N')
        @ PROW()+(mpagina-PROW()),00 SAY 'OBSERVACAO:'
        @ PROW()+1,00 SAY ALLTRIM(imppedido[1,86])+' '+imppedido[1,87]
        @ PROW()+1,00 SAY ALLTRIM(imppedido[1,88])+' '+imppedido[1,89]
        @ PROW()+1,00 SAY mtraco
        imprt(mtipo_imp,'C')
        @ PROW()+1,00 SAY 'Volumes:'
        @ PROW(),PCOL()+1 SAY STRZERO(mtot_quant,6)
        @ PROW(),PCOL()+2 SAY 'Qtd.Itens:'
        @ PROW(),PCOL()+1 SAY STRZERO(mtot_itens,6)
        @ PROW(),PCOL()+2 SAY 'Peso Liquuido:'
        @ PROW(),PCOL()+1 SAY mpeso_liq PICT '999,999.9999'
        @ PROW(),PCOL()+2 SAY 'Peso Bruto:'
        @ PROW(),PCOL()+1 SAY mpeso_brut PICT '999,999.9999'
        imprt(mtipo_imp,'N')
        @ PROW()+1,00 SAY mtraco
        EJECT
        imprt(mtipo_imp,'P6')
        SETPRC(00,00)
        SET DEVICE TO SCREEN;SET PRINT TO;SET PRINT OFF
        conf_impressao('TK'+STRZERO(mn_pedido,6)+'.REL')
ENDIF
RETURN .T.
******************************* F I M ******************************8
* FUNCAO PARA IMPRESSAO DO RECIBO DA O.S.
******************************************
FUNCTION rec_os(cli_bol,razao_bol,num,numos,mmod,seri,valor)

LOCAL lin1,lin2,lin3,rrecibo:=' ',linha,linhas,lin

MEMVAR traco,mtipo_imp

lin1 := '          Recebi de '
lin2 := ' a importancia de R$ '
lin3 := ' referente ao PEDIDO No.: '+STRZERO(num,6)+' - O.S. No.: '+STRZERO(numos,6)+' - MODELO: '+ALLTRIM(mmod)+' - SERIAL: '+ALLTRIM(seri)
traco := REPLI('-',80)
IF ! imp_arq('REC_OS.REL','T')
        RETURN NIL
ENDIF
IF mtipo_imp = 'D' .AND. FILE('CLIHTI.BMP')
        DEVPOS(PROW(),00);DEVOUT('"HTItop.bmp"')
        DEVPOS(PROW()+6,00);DEVOUT(traco)
ELSE
        imprt(mtipo_imp,'N+')
        imprt(mtipo_imp,'W1')
        DEVPOS(PROW(),00);DEVOUT(memp_resa)
        imprt(mtipo_imp,'N-')
        imprt(mtipo_imp,'W0')
        imprt(mtipo_imp,'C')
        DEVPOS(PROW()+1,00);DEVOUT(RTRIM(m_set[1,132])+'-'+RTRIM(m_set[1,133])+'-'+RTRIM(m_set[1,134])+'-'+RTRIM(m_set[1,19])+' - Fone: '+m_set[1,136])
        DEVPOS(PROW()+1,00);DEVOUT(traco)
ENDIF
imprt(mtipo_imp,'E',2)
DEVPOS(PROW(),18);DEVOUT('RECIBO')
DEVPOS(PROW()+2,45);DEVOUT('R$ ')
DEVPOS(PROW(),49);DEVOUT('('+LTRIM(TRANSFORM(valor,'@E 9,999,999.99'))+')')
DEVPOS(PROW()+1,01);DEVOUT(' ')

rrecibo := lin1+RTRIM(cli_bol+'-'+razao_bol)+lin2+LTRIM(TRANSFORM(valor,'@E 9,999,999.99'))+' ('+extenso(valor,.T.,'real','reais')+')'+lin3+', que damos plena quitacao da mesma'
linhas := MLCOUNT(rrecibo,70)
FOR linha = 1 TO  linhas
        LIN := MEMOLINE(rrecibo,70,linha,,10)
        DEVPOS(PROW()+1,05);DEVOUT(PADR(RTRIM(LIN),70))
NEXT

DEVPOS(PROW()+2,00);DEVOUT(PADC(RTRIM(m_set[1,134])+', '+DTOC(mdata_sis),80))
DEVPOS(PROW()+3,00);DEVOUT(PADC(REPLI('-',LEN(memp_resa)+2),80))
DEVPOS(PROW()+1,00);DEVOUT(PADC(memp_resa,80))
DEVPOS(PROW()+2,00);DEVOUT(traco)
DEVPOS(PROW()+1,66);DEVOUT(TIME()+' Hrs.')
DEVPOS(PROW()+4,00);DEVOUT(' ')
EJECT
SETPRC(00,00)
SET DEVI TO SCREEN;SET PRINT TO;SET PRINT OFF
conf_impressao('REC_OS.REL')
RETURN .T.


